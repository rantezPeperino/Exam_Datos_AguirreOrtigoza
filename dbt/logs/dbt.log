[0m20:39:39.394858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7886611613f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788660104250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7886601041f0>]}


============================== 20:39:39.397044 | cd26910b-930f-43e5-a7dd-84c5ddd49d11 ==============================
[0m20:39:39.397044 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:39:39.397507 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/home/rantez/.dbt', 'introspect': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'no_print': 'None', 'write_json': 'True', 'debug': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'log_path': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'version_check': 'True', 'log_format': 'default', 'empty': 'False', 'invocation_command': 'dbt run --vars {"ds": "20251206"}', 'warn_error': 'None', 'fail_fast': 'False', 'printer_width': '80', 'log_cache_events': 'False'}
[0m20:39:39.400058 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'medallion_duckdb'
[0m20:39:39.400755 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.05783993, "process_in_blocks": "200", "process_kernel_time": 0.049066, "process_mem_max_rss": "95268", "process_out_blocks": "8", "process_user_time": 0.990346}
[0m20:39:39.401169 [debug] [MainThread]: Command `dbt run` failed at 20:39:39.401089 after 0.06 seconds
[0m20:39:39.401738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7886611613f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7886601054b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788660107160>]}
[0m20:39:39.402247 [debug] [MainThread]: Flushing usage events
[0m20:39:40.576494 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:23:42.447140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722b25465390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722b24410280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722b24410190>]}


============================== 22:23:42.449294 | 7eb1c855-e4b6-4dcd-95d3-8d8e2d6597e0 ==============================
[0m22:23:42.449294 [info ] [MainThread]: Running with dbt=1.10.15
[0m22:23:42.449712 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'profiles_dir': '../profiles', 'use_colors': 'True', 'partial_parse': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'invocation_command': 'dbt run --profiles-dir ../profiles --vars {"ds": "20251201"}', 'empty': 'False', 'fail_fast': 'False', 'write_json': 'True', 'warn_error': 'None', 'static_parser': 'True', 'indirect_selection': 'eager', 'log_path': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/logs', 'use_experimental_parser': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'log_format': 'default'}
[0m22:23:42.452979 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DUCKDB_PATH'
[0m22:23:42.453610 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.05196728, "process_in_blocks": "0", "process_kernel_time": 0.046002, "process_mem_max_rss": "95212", "process_out_blocks": "16", "process_user_time": 0.955049}
[0m22:23:42.453991 [debug] [MainThread]: Command `dbt run` failed at 22:23:42.453911 after 0.05 seconds
[0m22:23:42.454276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722b25465390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722b244134f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722b244139a0>]}
[0m22:23:42.454565 [debug] [MainThread]: Flushing usage events
[0m22:23:43.511090 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:26:45.007458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3e6aa65420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3e69a082b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3e69a08250>]}


============================== 23:26:45.016481 | 5e8b3647-ef7a-4b7e-af7e-a33873179297 ==============================
[0m23:26:45.016481 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:26:45.017552 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'debug': 'False', 'use_experimental_parser': 'False', 'write_json': 'True', 'printer_width': '80', 'introspect': 'True', 'static_parser': 'True', 'profiles_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/../profiles', 'log_format': 'default', 'use_colors': 'True', 'warn_error': 'None', 'quiet': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'no_print': 'None', 'invocation_command': 'dbt run --profiles-dir /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/../profiles --vars {"ds": "20251201"}', 'fail_fast': 'False', 'log_path': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/logs', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False'}
[0m23:26:45.321533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e8b3647-ef7a-4b7e-af7e-a33873179297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3e657ba6b0>]}
[0m23:26:45.387902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e8b3647-ef7a-4b7e-af7e-a33873179297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3e657324a0>]}
[0m23:26:45.389995 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m23:26:45.465899 [debug] [MainThread]: checksum: 930605a5b191b04e33a9cdc4385d0fd5d6ead171c661db7ccd31c1a981711ed6, vars: {'ds': '20251201'}, profile: , target: , version: 1.10.15
[0m23:26:45.468037 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:26:45.468656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5e8b3647-ef7a-4b7e-af7e-a33873179297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3e61eaada0>]}
[0m23:26:46.926114 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m23:26:46.926616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5e8b3647-ef7a-4b7e-af7e-a33873179297', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3e60148a30>]}
[0m23:26:47.020221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e8b3647-ef7a-4b7e-af7e-a33873179297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3e5b7e0640>]}
[0m23:26:47.203428 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m23:26:47.205442 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m23:26:47.217393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e8b3647-ef7a-4b7e-af7e-a33873179297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3e5b600eb0>]}
[0m23:26:47.217941 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m23:26:47.218325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e8b3647-ef7a-4b7e-af7e-a33873179297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3e5b7e7520>]}
[0m23:26:47.220276 [info ] [MainThread]: 
[0m23:26:47.220649 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:26:47.220933 [info ] [MainThread]: 
[0m23:26:47.221439 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:26:47.226226 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m23:26:47.258432 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m23:26:47.258871 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m23:26:47.259165 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:26:47.895589 [debug] [ThreadPool]: SQL status: OK in 0.636 seconds
[0m23:26:47.898661 [debug] [ThreadPool]: On list_medallion: Close
[0m23:26:47.899527 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m23:26:47.900395 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m23:26:47.906688 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m23:26:47.907068 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m23:26:47.907335 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:26:47.908531 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:26:47.909753 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m23:26:47.910107 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m23:26:47.910678 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:26:47.910937 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m23:26:47.911176 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m23:26:47.911640 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:26:47.912947 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m23:26:47.913290 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m23:26:47.913616 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m23:26:47.914250 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:26:47.914728 [debug] [ThreadPool]: On create_medallion_main: Close
[0m23:26:47.916961 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m23:26:47.923834 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m23:26:47.924210 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m23:26:47.924471 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:26:47.925213 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:26:47.925512 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m23:26:47.925764 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m23:26:47.937413 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m23:26:47.940769 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m23:26:47.941421 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m23:26:47.941712 [debug] [ThreadPool]: On list_medallion_main: Close
[0m23:26:47.942272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e8b3647-ef7a-4b7e-af7e-a33873179297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3e60a81e10>]}
[0m23:26:47.942801 [debug] [MainThread]: Using duckdb connection "master"
[0m23:26:47.943139 [debug] [MainThread]: On master: BEGIN
[0m23:26:47.943412 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:26:47.944216 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:26:47.944828 [debug] [MainThread]: On master: COMMIT
[0m23:26:47.945186 [debug] [MainThread]: Using duckdb connection "master"
[0m23:26:47.945464 [debug] [MainThread]: On master: COMMIT
[0m23:26:47.946022 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:26:47.946386 [debug] [MainThread]: On master: Close
[0m23:26:47.950842 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m23:26:47.952533 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m23:26:47.953506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m23:26:47.954106 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m23:26:47.968837 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m23:26:47.970746 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m23:26:48.001207 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m23:26:48.002065 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m23:26:48.002734 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m23:26:48.003094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:26:48.003962 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:26:48.004315 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m23:26:48.004609 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/data/clean/transactions_20251207_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m23:26:48.005135 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/data/clean/transactions_20251207_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m23:26:48.005456 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:26:48.005855 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m23:26:48.007137 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m23:26:48.007443 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m23:26:48.008174 [debug] [Thread-1 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m23:26:48.009511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e8b3647-ef7a-4b7e-af7e-a33873179297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3e60a81e10>]}
[0m23:26:48.010097 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model main.stg_transactions ..................... [[31mERROR[0m in 0.06s]
[0m23:26:48.010754 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m23:26:48.011358 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^.
[0m23:26:48.015027 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m23:26:48.015760 [info ] [Thread-3 (]: 2 of 2 SKIP relation main.fct_customer_transactions ............................ [[33mSKIP[0m]
[0m23:26:48.016498 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m23:26:48.019106 [debug] [MainThread]: Using duckdb connection "master"
[0m23:26:48.019958 [debug] [MainThread]: On master: BEGIN
[0m23:26:48.020544 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:26:48.022610 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m23:26:48.023271 [debug] [MainThread]: On master: COMMIT
[0m23:26:48.023789 [debug] [MainThread]: Using duckdb connection "master"
[0m23:26:48.024235 [debug] [MainThread]: On master: COMMIT
[0m23:26:48.025072 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:26:48.025437 [debug] [MainThread]: On master: Close
[0m23:26:48.025858 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:26:48.026125 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m23:26:48.026399 [info ] [MainThread]: 
[0m23:26:48.026668 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m23:26:48.027210 [debug] [MainThread]: Command end result
[0m23:26:48.056534 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m23:26:48.058243 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m23:26:48.065189 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m23:26:48.066311 [info ] [MainThread]: 
[0m23:26:48.067003 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:26:48.067498 [info ] [MainThread]: 
[0m23:26:48.068113 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m23:26:48.068553 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m23:26:48.068908 [info ] [MainThread]: 
[0m23:26:48.069310 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m23:26:48.069589 [info ] [MainThread]: 
[0m23:26:48.069975 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m23:26:48.070646 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m23:26:48.071503 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.1708736, "process_in_blocks": "88", "process_kernel_time": 0.197498, "process_mem_max_rss": "195216", "process_out_blocks": "45024", "process_user_time": 4.564417}
[0m23:26:48.071900 [debug] [MainThread]: Command `dbt run` failed at 23:26:48.071822 after 3.17 seconds
[0m23:26:48.072247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3e6aa65420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3e6bcf8d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3e69a09c90>]}
[0m23:26:48.072565 [debug] [MainThread]: Flushing usage events
[0m23:26:49.174180 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:37:40.740637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c6a5a71450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c6a4a382b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c6a4a38250>]}


============================== 23:37:40.743689 | fdf47833-8075-4ca7-91be-a82d39a8059a ==============================
[0m23:37:40.743689 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:37:40.744150 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/../profiles', 'warn_error': 'None', 'log_cache_events': 'False', 'empty': 'False', 'fail_fast': 'False', 'printer_width': '80', 'use_colors': 'True', 'introspect': 'True', 'write_json': 'True', 'partial_parse': 'True', 'version_check': 'True', 'invocation_command': 'dbt run --profiles-dir /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/../profiles --vars {"ds": "20251201"}', 'indirect_selection': 'eager', 'no_print': 'None', 'log_path': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/logs', 'target_path': 'None', 'quiet': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'cache_selected_only': 'False'}
[0m23:37:41.020705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fdf47833-8075-4ca7-91be-a82d39a8059a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c69ce9e7a0>]}
[0m23:37:41.078254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fdf47833-8075-4ca7-91be-a82d39a8059a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c6a4a39f60>]}
[0m23:37:41.079913 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m23:37:41.180289 [debug] [MainThread]: checksum: 930605a5b191b04e33a9cdc4385d0fd5d6ead171c661db7ccd31c1a981711ed6, vars: {'ds': '20251201'}, profile: , target: , version: 1.10.15
[0m23:37:41.279512 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m23:37:41.280753 [debug] [MainThread]: Partial parsing: updated file: medallion_dbt://models/staging/stg_transactions.sql
[0m23:37:41.281190 [debug] [MainThread]: Partial parsing: updated file: medallion_dbt://models/marts/fct_customer_transactions.sql
[0m23:37:41.713811 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m23:37:41.714792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fdf47833-8075-4ca7-91be-a82d39a8059a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c69c1d50f0>]}
[0m23:37:41.807575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fdf47833-8075-4ca7-91be-a82d39a8059a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c69c089f30>]}
[0m23:37:41.888947 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m23:37:41.890602 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m23:37:41.904581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fdf47833-8075-4ca7-91be-a82d39a8059a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c69c08b130>]}
[0m23:37:41.905558 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m23:37:41.906026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdf47833-8075-4ca7-91be-a82d39a8059a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c69ca6e050>]}
[0m23:37:41.907986 [info ] [MainThread]: 
[0m23:37:41.908446 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:37:41.908737 [info ] [MainThread]: 
[0m23:37:41.909420 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:37:41.914055 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m23:37:41.942170 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m23:37:41.942661 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m23:37:41.943007 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:37:41.956141 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m23:37:41.957450 [debug] [ThreadPool]: On list_medallion: Close
[0m23:37:41.958157 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m23:37:41.958684 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m23:37:41.965427 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m23:37:41.966040 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m23:37:41.966401 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:37:41.968184 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:37:41.969329 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m23:37:41.969849 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m23:37:41.970835 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:37:41.971172 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m23:37:41.971436 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m23:37:41.972027 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:37:41.972881 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m23:37:41.973193 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m23:37:41.973442 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m23:37:41.973851 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:37:41.974128 [debug] [ThreadPool]: On create_medallion_main: Close
[0m23:37:41.975192 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m23:37:41.980562 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m23:37:41.981329 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m23:37:41.982056 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:37:41.983266 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:37:41.983569 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m23:37:41.983834 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m23:37:41.994377 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m23:37:41.995614 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m23:37:41.996152 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m23:37:41.996474 [debug] [ThreadPool]: On list_medallion_main: Close
[0m23:37:41.997080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdf47833-8075-4ca7-91be-a82d39a8059a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c6a67f9480>]}
[0m23:37:41.997715 [debug] [MainThread]: Using duckdb connection "master"
[0m23:37:41.998238 [debug] [MainThread]: On master: BEGIN
[0m23:37:41.998814 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:37:42.000526 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m23:37:42.001224 [debug] [MainThread]: On master: COMMIT
[0m23:37:42.001610 [debug] [MainThread]: Using duckdb connection "master"
[0m23:37:42.002024 [debug] [MainThread]: On master: COMMIT
[0m23:37:42.002698 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:37:42.003070 [debug] [MainThread]: On master: Close
[0m23:37:42.007718 [debug] [Thread-1 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m23:37:42.009030 [debug] [Thread-2 (]: Began running node model.medallion_dbt.stg_transactions
[0m23:37:42.009797 [info ] [Thread-1 (]: 1 of 2 START sql table model main.fct_customer_transactions .................... [RUN]
[0m23:37:42.010884 [info ] [Thread-2 (]: 2 of 2 START sql table model main.stg_transactions ............................. [RUN]
[0m23:37:42.011401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.fct_customer_transactions)
[0m23:37:42.011901 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.medallion_dbt.stg_transactions'
[0m23:37:42.012315 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.fct_customer_transactions
[0m23:37:42.012684 [debug] [Thread-2 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m23:37:42.021875 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.fct_customer_transactions"
[0m23:37:42.026031 [debug] [Thread-2 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m23:37:42.026865 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.fct_customer_transactions
[0m23:37:42.032532 [debug] [Thread-2 (]: Began executing node model.medallion_dbt.stg_transactions
[0m23:37:42.105310 [debug] [Thread-2 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m23:37:42.107413 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.fct_customer_transactions"
[0m23:37:42.108389 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m23:37:42.109000 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m23:37:42.109441 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m23:37:42.110037 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: BEGIN
[0m23:37:42.110641 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:37:42.111030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:37:42.112067 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m23:37:42.112419 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m23:37:42.112746 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:37:42.113151 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
    
    

    create  table
      "medallion"."main"."stg_transactions__dbt_tmp"
  
    as (
      -- models/silver/stg_transactions.sql







WITH source_clean AS (
    SELECT *
    FROM read_parquet(
        clean_dir || '/transactions_' || ds_nodash || '_clean.parquet'
    )
),

typed AS (
    SELECT
        CAST(transaction_id AS VARCHAR) AS transaction_id,
        CAST(customer_id AS VARCHAR)    AS customer_id,
        CAST(amount AS DOUBLE)          AS amount,

        /* Normalizar status a valores aceptados */
        LOWER(TRIM(status)) AS status,

        /* Timestamp */
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM source_clean
),

final AS (
    SELECT
        transaction_id,
        customer_id,
        amount,
        status,
        transaction_ts,
        /* Columna derivada obligatoria seg√∫n schema.yml */
        CAST(DATE(transaction_ts) AS DATE) AS transaction_date
    FROM typed
    /* Cumplir BEGIN de accepted_values */
    WHERE status IN ('completed', 'pending', 'failed')
)

SELECT *
FROM final;
    );
  
  
[0m23:37:42.113559 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m23:37:42.114430 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
    
    

    create  table
      "medallion"."main"."stg_transactions__dbt_tmp"
  
    as (
      -- models/silver/stg_transactions.sql







WITH source_clean AS (
    SELECT *
    FROM read_parquet(
        clean_dir || '/transactions_' || ds_nodash || '_clean.parquet'
    )
),

typed AS (
    SELECT
        CAST(transaction_id AS VARCHAR) AS transaction_id,
        CAST(customer_id AS VARCHAR)    AS customer_id,
        CAST(amount AS DOUBLE)          AS amount,

        /* Normalizar status a valores aceptados */
        LOWER(TRIM(status)) AS status,

        /* Timestamp */
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM source_clean
),

final AS (
    SELECT
        transaction_id,
        customer_id,
        amount,
        status,
        transaction_ts,
        /* Columna derivada obligatoria seg√∫n schema.yml */
        CAST(DATE(transaction_ts) AS DATE) AS transaction_date
    FROM typed
    /* Cumplir BEGIN de accepted_values */
    WHERE status IN ('completed', 'pending', 'failed')
)

SELECT *
FROM final;
    );
  
  
[0m23:37:42.115983 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m23:37:42.115189 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      -- models/silver/stg_transactions.sql
-- Modelo staging de transacciones. Toma el parquet limpio generado en Silver
-- y normaliza columnas seg√∫n lo definido en schema.yml.






WITH source_clean AS (
    SELECT *
    FROM read_parquet(
        clean_dir || '/transactions_' || ds_nodash || '_clean.parquet'
    )
),

typed AS (
    SELECT
        /* Clave primaria obligatoria */
        CAST(transaction_id AS VARCHAR) AS transaction_id,

        /* Relaci√≥n con clientes */
        CAST(customer_id AS VARCHAR) AS customer_id,

        /* Montos: el schema.yml exige non_negative */
        CAST(amount AS DOUBLE) AS amount,

        /* Normalizaci√≥n del estado */
        LOWER(TRIM(status)) AS status,

        /* Timestamp obligatorio */
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM source_clean
),

validated AS (
    SELECT
        *,
        /* Campo derivado obligatorio seg√∫n schema.yml */
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed', 'pending', 'failed')
)

SELECT *
FROM validated;
    );
  
  
[0m23:37:42.116739 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m23:37:42.117624 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      -- models/silver/stg_transactions.sql
-- Modelo staging de transacciones. Toma el parquet limpio generado en Silver
-- y normaliza columnas seg√∫n lo definido en schema.yml.






WITH source_clean AS (
    SELECT *
    FROM read_parquet(
        clean_dir || '/transactions_' || ds_nodash || '_clean.parquet'
    )
),

typed AS (
    SELECT
        /* Clave primaria obligatoria */
        CAST(transaction_id AS VARCHAR) AS transaction_id,

        /* Relaci√≥n con clientes */
        CAST(customer_id AS VARCHAR) AS customer_id,

        /* Montos: el schema.yml exige non_negative */
        CAST(amount AS DOUBLE) AS amount,

        /* Normalizaci√≥n del estado */
        LOWER(TRIM(status)) AS status,

        /* Timestamp obligatorio */
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM source_clean
),

validated AS (
    SELECT
        *,
        /* Campo derivado obligatorio seg√∫n schema.yml */
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed', 'pending', 'failed')
)

SELECT *
FROM validated;
    );
  
  
[0m23:37:42.118192 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:37:42.118753 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: ROLLBACK
[0m23:37:42.121123 [debug] [Thread-2 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m23:37:42.121838 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.fct_customer_transactions'
[0m23:37:42.122296 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: Close
[0m23:37:42.122644 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: Close
[0m23:37:42.123800 [debug] [Thread-2 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 55: FROM final;
                    ^
[0m23:37:42.124346 [debug] [Thread-1 (]: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 56: FROM validated;
                     ^
[0m23:37:42.126587 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdf47833-8075-4ca7-91be-a82d39a8059a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c6a5d49180>]}
[0m23:37:42.127308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdf47833-8075-4ca7-91be-a82d39a8059a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c696bae020>]}
[0m23:37:42.128499 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model main.stg_transactions .................... [[31mERROR[0m in 0.11s]
[0m23:37:42.129589 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model main.fct_customer_transactions ........... [[31mERROR[0m in 0.11s]
[0m23:37:42.130689 [debug] [Thread-2 (]: Finished running node model.medallion_dbt.stg_transactions
[0m23:37:42.131354 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m23:37:42.131899 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 55: FROM final;
                    ^.
[0m23:37:42.133077 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.fct_customer_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 56: FROM validated;
                     ^.
[0m23:37:42.135023 [debug] [MainThread]: Using duckdb connection "master"
[0m23:37:42.135885 [debug] [MainThread]: On master: BEGIN
[0m23:37:42.136563 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:37:42.138961 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m23:37:42.139387 [debug] [MainThread]: On master: COMMIT
[0m23:37:42.139735 [debug] [MainThread]: Using duckdb connection "master"
[0m23:37:42.140002 [debug] [MainThread]: On master: COMMIT
[0m23:37:42.140540 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:37:42.140822 [debug] [MainThread]: On master: Close
[0m23:37:42.141253 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:37:42.141500 [debug] [MainThread]: Connection 'model.medallion_dbt.fct_customer_transactions' was properly closed.
[0m23:37:42.141722 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m23:37:42.142033 [info ] [MainThread]: 
[0m23:37:42.142364 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m23:37:42.143146 [debug] [MainThread]: Command end result
[0m23:37:42.172692 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m23:37:42.175140 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m23:37:42.181343 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m23:37:42.182535 [info ] [MainThread]: 
[0m23:37:42.183020 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m23:37:42.183409 [info ] [MainThread]: 
[0m23:37:42.183792 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m23:37:42.184118 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 55: FROM final;
                    ^
[0m23:37:42.184385 [info ] [MainThread]: 
[0m23:37:42.184700 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m23:37:42.184967 [info ] [MainThread]: 
[0m23:37:42.185279 [error] [MainThread]: [31mFailure in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)[0m
[0m23:37:42.185592 [error] [MainThread]:   Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 56: FROM validated;
                     ^
[0m23:37:42.185821 [info ] [MainThread]: 
[0m23:37:42.186116 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/fct_customer_transactions.sql
[0m23:37:42.186564 [info ] [MainThread]: 
[0m23:37:42.186901 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=2
[0m23:37:42.187463 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m23:37:42.188321 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4995114, "process_in_blocks": "0", "process_kernel_time": 0.138853, "process_mem_max_rss": "158304", "process_out_blocks": "3248", "process_user_time": 2.591263}
[0m23:37:42.188742 [debug] [MainThread]: Command `dbt run` failed at 23:37:42.188663 after 1.50 seconds
[0m23:37:42.189119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c6a5a71450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c6a596f2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c696cc2d10>]}
[0m23:37:42.189495 [debug] [MainThread]: Flushing usage events
[0m23:37:43.135330 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:38:53.485548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4a17369300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4a163042b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4a16304250>]}


============================== 23:38:53.489320 | 959950bc-f100-4264-b084-dcfa981028e6 ==============================
[0m23:38:53.489320 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:38:53.489786 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'target_path': 'None', 'quiet': 'False', 'invocation_command': 'dbt run --profiles-dir /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/../profiles --vars {"ds": "20251201"}', 'debug': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/../profiles', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/logs', 'partial_parse': 'True', 'use_colors': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'empty': 'False', 'no_print': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False'}
[0m23:38:53.700489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '959950bc-f100-4264-b084-dcfa981028e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4a18d00580>]}
[0m23:38:53.764336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '959950bc-f100-4264-b084-dcfa981028e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4a162b1030>]}
[0m23:38:53.769410 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m23:38:53.841274 [debug] [MainThread]: checksum: 930605a5b191b04e33a9cdc4385d0fd5d6ead171c661db7ccd31c1a981711ed6, vars: {'ds': '20251201'}, profile: , target: , version: 1.10.15
[0m23:38:53.948875 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m23:38:53.953395 [debug] [MainThread]: Partial parsing: updated file: medallion_dbt://models/staging/stg_transactions.sql
[0m23:38:53.954697 [debug] [MainThread]: Partial parsing: updated file: medallion_dbt://models/marts/fct_customer_transactions.sql
[0m23:38:54.455620 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m23:38:54.456536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '959950bc-f100-4264-b084-dcfa981028e6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4a0e1d51e0>]}
[0m23:38:54.538073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '959950bc-f100-4264-b084-dcfa981028e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4a0d195de0>]}
[0m23:38:54.612815 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m23:38:54.614755 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m23:38:54.625622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '959950bc-f100-4264-b084-dcfa981028e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4a0d197fa0>]}
[0m23:38:54.626177 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m23:38:54.626510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '959950bc-f100-4264-b084-dcfa981028e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4a0e37af50>]}
[0m23:38:54.627824 [info ] [MainThread]: 
[0m23:38:54.628138 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:38:54.628388 [info ] [MainThread]: 
[0m23:38:54.628790 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:38:54.636215 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m23:38:54.666912 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m23:38:54.667380 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m23:38:54.667695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:38:54.677729 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m23:38:54.679295 [debug] [ThreadPool]: On list_medallion: Close
[0m23:38:54.681297 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m23:38:54.682652 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m23:38:54.689274 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m23:38:54.689668 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m23:38:54.689943 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:38:54.691030 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:38:54.692036 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m23:38:54.692311 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m23:38:54.692772 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:38:54.693039 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m23:38:54.693291 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m23:38:54.693704 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:38:54.694326 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m23:38:54.694592 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m23:38:54.694838 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m23:38:54.695413 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:38:54.695870 [debug] [ThreadPool]: On create_medallion_main: Close
[0m23:38:54.698254 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m23:38:54.704566 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m23:38:54.705009 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m23:38:54.705293 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:38:54.706046 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:38:54.706332 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m23:38:54.706575 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m23:38:54.716995 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m23:38:54.718737 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m23:38:54.719313 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m23:38:54.719653 [debug] [ThreadPool]: On list_medallion_main: Close
[0m23:38:54.720401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '959950bc-f100-4264-b084-dcfa981028e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4a0e5985b0>]}
[0m23:38:54.721187 [debug] [MainThread]: Using duckdb connection "master"
[0m23:38:54.721715 [debug] [MainThread]: On master: BEGIN
[0m23:38:54.722081 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:38:54.722861 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:38:54.723135 [debug] [MainThread]: On master: COMMIT
[0m23:38:54.723384 [debug] [MainThread]: Using duckdb connection "master"
[0m23:38:54.723620 [debug] [MainThread]: On master: COMMIT
[0m23:38:54.724083 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:38:54.724359 [debug] [MainThread]: On master: Close
[0m23:38:54.726300 [debug] [Thread-1 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m23:38:54.726707 [debug] [Thread-2 (]: Began running node model.medallion_dbt.stg_transactions
[0m23:38:54.727201 [info ] [Thread-1 (]: 1 of 2 START sql table model main.fct_customer_transactions .................... [RUN]
[0m23:38:54.727829 [info ] [Thread-2 (]: 2 of 2 START sql table model main.stg_transactions ............................. [RUN]
[0m23:38:54.728297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.fct_customer_transactions)
[0m23:38:54.728934 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.medallion_dbt.stg_transactions'
[0m23:38:54.730009 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.fct_customer_transactions
[0m23:38:54.730822 [debug] [Thread-2 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m23:38:54.739885 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.fct_customer_transactions"
[0m23:38:54.743346 [debug] [Thread-2 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m23:38:54.743944 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.fct_customer_transactions
[0m23:38:54.744265 [debug] [Thread-2 (]: Began executing node model.medallion_dbt.stg_transactions
[0m23:38:54.783791 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.fct_customer_transactions"
[0m23:38:54.784798 [debug] [Thread-2 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m23:38:54.786208 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m23:38:54.786538 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m23:38:54.786921 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m23:38:54.787266 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:38:54.787627 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: BEGIN
[0m23:38:54.788259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:38:54.788770 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m23:38:54.789104 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m23:38:54.789418 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:38:54.789787 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
    
    

    create  table
      "medallion"."main"."stg_transactions__dbt_tmp"
  
    as (
      -- models/silver/stg_transactions.sql







WITH source_clean AS (
    SELECT *
    FROM read_parquet(
        clean_dir || '/transactions_' || ds_nodash || '_clean.parquet'
    )
),

typed AS (
    SELECT
        CAST(transaction_id AS VARCHAR) AS transaction_id,
        CAST(customer_id AS VARCHAR)    AS customer_id,
        CAST(amount AS DOUBLE)          AS amount,

        /* Normalizar status a valores aceptados */
        LOWER(TRIM(status)) AS status,

        /* Timestamp */
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM source_clean
),

final AS (
    SELECT
        transaction_id,
        customer_id,
        amount,
        status,
        transaction_ts,
        /* Columna derivada obligatoria seg√∫n schema.yml */
        CAST(DATE(transaction_ts) AS DATE) AS transaction_date
    FROM typed
    /* Cumplir BEGIN de accepted_values */
    WHERE status IN ('completed', 'pending', 'failed')
)

SELECT *
FROM final
    );
  
  
[0m23:38:54.790121 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m23:38:54.790697 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      -- models/silver/stg_transactions.sql
-- Modelo staging de transacciones. Toma el parquet limpio generado en Silver
-- y normaliza columnas seg√∫n lo definido en schema.yml.






WITH source_clean AS (
    SELECT *
    FROM read_parquet(
        clean_dir || '/transactions_' || ds_nodash || '_clean.parquet'
    )
),

typed AS (
    SELECT
        /* Clave primaria obligatoria */
        CAST(transaction_id AS VARCHAR) AS transaction_id,

        /* Relaci√≥n con clientes */
        CAST(customer_id AS VARCHAR) AS customer_id,

        /* Montos: el schema.yml exige non_negative */
        CAST(amount AS DOUBLE) AS amount,

        /* Normalizaci√≥n del estado */
        LOWER(TRIM(status)) AS status,

        /* Timestamp obligatorio */
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM source_clean
),

validated AS (
    SELECT
        *,
        /* Campo derivado obligatorio seg√∫n schema.yml */
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed', 'pending', 'failed')
)

SELECT *
FROM validated
    );
  
  
[0m23:38:54.791140 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
    
    

    create  table
      "medallion"."main"."stg_transactions__dbt_tmp"
  
    as (
      -- models/silver/stg_transactions.sql







WITH source_clean AS (
    SELECT *
    FROM read_parquet(
        clean_dir || '/transactions_' || ds_nodash || '_clean.parquet'
    )
),

typed AS (
    SELECT
        CAST(transaction_id AS VARCHAR) AS transaction_id,
        CAST(customer_id AS VARCHAR)    AS customer_id,
        CAST(amount AS DOUBLE)          AS amount,

        /* Normalizar status a valores aceptados */
        LOWER(TRIM(status)) AS status,

        /* Timestamp */
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM source_clean
),

final AS (
    SELECT
        transaction_id,
        customer_id,
        amount,
        status,
        transaction_ts,
        /* Columna derivada obligatoria seg√∫n schema.yml */
        CAST(DATE(transaction_ts) AS DATE) AS transaction_date
    FROM typed
    /* Cumplir BEGIN de accepted_values */
    WHERE status IN ('completed', 'pending', 'failed')
)

SELECT *
FROM final
    );
  
  
[0m23:38:54.791700 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m23:38:54.792091 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      -- models/silver/stg_transactions.sql
-- Modelo staging de transacciones. Toma el parquet limpio generado en Silver
-- y normaliza columnas seg√∫n lo definido en schema.yml.






WITH source_clean AS (
    SELECT *
    FROM read_parquet(
        clean_dir || '/transactions_' || ds_nodash || '_clean.parquet'
    )
),

typed AS (
    SELECT
        /* Clave primaria obligatoria */
        CAST(transaction_id AS VARCHAR) AS transaction_id,

        /* Relaci√≥n con clientes */
        CAST(customer_id AS VARCHAR) AS customer_id,

        /* Montos: el schema.yml exige non_negative */
        CAST(amount AS DOUBLE) AS amount,

        /* Normalizaci√≥n del estado */
        LOWER(TRIM(status)) AS status,

        /* Timestamp obligatorio */
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM source_clean
),

validated AS (
    SELECT
        *,
        /* Campo derivado obligatorio seg√∫n schema.yml */
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed', 'pending', 'failed')
)

SELECT *
FROM validated
    );
  
  
[0m23:38:54.792580 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m23:38:54.792976 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:38:54.793521 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: ROLLBACK
[0m23:38:54.796305 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.fct_customer_transactions'
[0m23:38:54.797840 [debug] [Thread-2 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m23:38:54.800111 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: Close
[0m23:38:54.801123 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: Close
[0m23:38:54.802447 [debug] [Thread-2 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  IO Error: No files found that match the pattern "clean_dir/transactions_ds_nodash_clean.parquet"
  
  LINE 21:     FROM read_parquet(
                    ^
[0m23:38:54.802996 [debug] [Thread-1 (]: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  IO Error: No files found that match the pattern "clean_dir/transactions_ds_nodash_clean.parquet"
  
  LINE 22:     FROM read_parquet(
                    ^
[0m23:38:54.804615 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '959950bc-f100-4264-b084-dcfa981028e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4a1759ef50>]}
[0m23:38:54.805015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '959950bc-f100-4264-b084-dcfa981028e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4a0c5b3280>]}
[0m23:38:54.805698 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model main.stg_transactions .................... [[31mERROR[0m in 0.07s]
[0m23:38:54.806316 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model main.fct_customer_transactions ........... [[31mERROR[0m in 0.08s]
[0m23:38:54.806846 [debug] [Thread-2 (]: Finished running node model.medallion_dbt.stg_transactions
[0m23:38:54.807307 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m23:38:54.807889 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  IO Error: No files found that match the pattern "clean_dir/transactions_ds_nodash_clean.parquet"
  
  LINE 21:     FROM read_parquet(
                    ^.
[0m23:38:54.808849 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.fct_customer_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  IO Error: No files found that match the pattern "clean_dir/transactions_ds_nodash_clean.parquet"
  
  LINE 22:     FROM read_parquet(
                    ^.
[0m23:38:54.809739 [debug] [MainThread]: Using duckdb connection "master"
[0m23:38:54.810054 [debug] [MainThread]: On master: BEGIN
[0m23:38:54.810308 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:38:54.810968 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:38:54.811257 [debug] [MainThread]: On master: COMMIT
[0m23:38:54.811577 [debug] [MainThread]: Using duckdb connection "master"
[0m23:38:54.811909 [debug] [MainThread]: On master: COMMIT
[0m23:38:54.812556 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:38:54.812876 [debug] [MainThread]: On master: Close
[0m23:38:54.813364 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:38:54.813636 [debug] [MainThread]: Connection 'model.medallion_dbt.fct_customer_transactions' was properly closed.
[0m23:38:54.813878 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m23:38:54.814196 [info ] [MainThread]: 
[0m23:38:54.814476 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m23:38:54.815165 [debug] [MainThread]: Command end result
[0m23:38:54.835038 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m23:38:54.836585 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m23:38:54.841399 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m23:38:54.841712 [info ] [MainThread]: 
[0m23:38:54.842034 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m23:38:54.842311 [info ] [MainThread]: 
[0m23:38:54.842613 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m23:38:54.842906 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  IO Error: No files found that match the pattern "clean_dir/transactions_ds_nodash_clean.parquet"
  
  LINE 21:     FROM read_parquet(
                    ^
[0m23:38:54.843149 [info ] [MainThread]: 
[0m23:38:54.843421 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m23:38:54.843657 [info ] [MainThread]: 
[0m23:38:54.843956 [error] [MainThread]: [31mFailure in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)[0m
[0m23:38:54.844277 [error] [MainThread]:   Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  IO Error: No files found that match the pattern "clean_dir/transactions_ds_nodash_clean.parquet"
  
  LINE 22:     FROM read_parquet(
                    ^
[0m23:38:54.844509 [info ] [MainThread]: 
[0m23:38:54.844804 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/fct_customer_transactions.sql
[0m23:38:54.845091 [info ] [MainThread]: 
[0m23:38:54.845370 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=2
[0m23:38:54.845798 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m23:38:54.847839 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4207026, "process_in_blocks": "0", "process_kernel_time": 0.135027, "process_mem_max_rss": "158644", "process_out_blocks": "3248", "process_user_time": 2.55552}
[0m23:38:54.849146 [debug] [MainThread]: Command `dbt run` failed at 23:38:54.848888 after 1.42 seconds
[0m23:38:54.849953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4a17369300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4a18d00580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4a173deb90>]}
[0m23:38:54.850553 [debug] [MainThread]: Flushing usage events
[0m23:38:56.009227 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:40:14.905159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff041a95390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff040a60280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff040a60220>]}


============================== 23:40:14.907594 | 107ca440-0ea7-4e35-b1e2-4e2afcdf36fd ==============================
[0m23:40:14.907594 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:40:14.908027 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'printer_width': '80', 'introspect': 'True', 'version_check': 'True', 'write_json': 'True', 'debug': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'warn_error': 'None', 'profiles_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/../profiles', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/logs', 'invocation_command': 'dbt run --profiles-dir /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/../profiles --vars {"ds": "20251201"}', 'target_path': 'None', 'no_print': 'None', 'log_format': 'default', 'cache_selected_only': 'False'}
[0m23:40:15.140645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '107ca440-0ea7-4e35-b1e2-4e2afcdf36fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff041946e30>]}
[0m23:40:15.206212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '107ca440-0ea7-4e35-b1e2-4e2afcdf36fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff03c748f70>]}
[0m23:40:15.207667 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m23:40:15.278551 [debug] [MainThread]: checksum: 930605a5b191b04e33a9cdc4385d0fd5d6ead171c661db7ccd31c1a981711ed6, vars: {'ds': '20251201'}, profile: , target: , version: 1.10.15
[0m23:40:15.384743 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:40:15.386051 [debug] [MainThread]: Partial parsing: updated file: medallion_dbt://models/staging/stg_transactions.sql
[0m23:40:15.856580 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m23:40:15.857108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '107ca440-0ea7-4e35-b1e2-4e2afcdf36fd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0381ea950>]}
[0m23:40:15.916523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '107ca440-0ea7-4e35-b1e2-4e2afcdf36fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0380401f0>]}
[0m23:40:15.996055 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m23:40:16.000719 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m23:40:16.019137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '107ca440-0ea7-4e35-b1e2-4e2afcdf36fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff038040520>]}
[0m23:40:16.021383 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m23:40:16.022563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '107ca440-0ea7-4e35-b1e2-4e2afcdf36fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff038069090>]}
[0m23:40:16.025107 [info ] [MainThread]: 
[0m23:40:16.025914 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:40:16.026574 [info ] [MainThread]: 
[0m23:40:16.027652 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:40:16.037452 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m23:40:16.066093 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m23:40:16.068698 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m23:40:16.070225 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:40:16.094315 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m23:40:16.097552 [debug] [ThreadPool]: On list_medallion: Close
[0m23:40:16.101282 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m23:40:16.102359 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m23:40:16.112361 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m23:40:16.113311 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m23:40:16.114006 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:40:16.116581 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m23:40:16.117893 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m23:40:16.118240 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m23:40:16.118810 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:40:16.119124 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m23:40:16.119372 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m23:40:16.120781 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:40:16.121953 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m23:40:16.122360 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m23:40:16.122636 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m23:40:16.123622 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:40:16.124026 [debug] [ThreadPool]: On create_medallion_main: Close
[0m23:40:16.125122 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m23:40:16.132345 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m23:40:16.133146 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m23:40:16.133537 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:40:16.135743 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:40:16.136522 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m23:40:16.137205 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m23:40:16.149159 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m23:40:16.151154 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m23:40:16.151734 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m23:40:16.152145 [debug] [ThreadPool]: On list_medallion_main: Close
[0m23:40:16.152945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '107ca440-0ea7-4e35-b1e2-4e2afcdf36fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff03819cfd0>]}
[0m23:40:16.154218 [debug] [MainThread]: Using duckdb connection "master"
[0m23:40:16.154758 [debug] [MainThread]: On master: BEGIN
[0m23:40:16.155080 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:40:16.156255 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:40:16.156585 [debug] [MainThread]: On master: COMMIT
[0m23:40:16.156882 [debug] [MainThread]: Using duckdb connection "master"
[0m23:40:16.157173 [debug] [MainThread]: On master: COMMIT
[0m23:40:16.157988 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:40:16.158253 [debug] [MainThread]: On master: Close
[0m23:40:16.160376 [debug] [Thread-1 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m23:40:16.160780 [debug] [Thread-2 (]: Began running node model.medallion_dbt.stg_transactions
[0m23:40:16.161330 [info ] [Thread-1 (]: 1 of 2 START sql table model main.fct_customer_transactions .................... [RUN]
[0m23:40:16.161906 [info ] [Thread-2 (]: 2 of 2 START sql table model main.stg_transactions ............................. [RUN]
[0m23:40:16.162342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.fct_customer_transactions)
[0m23:40:16.162831 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.medallion_dbt.stg_transactions'
[0m23:40:16.163469 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.fct_customer_transactions
[0m23:40:16.164142 [debug] [Thread-2 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m23:40:16.175866 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.fct_customer_transactions"
[0m23:40:16.179957 [debug] [Thread-2 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m23:40:16.181031 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.fct_customer_transactions
[0m23:40:16.181624 [debug] [Thread-2 (]: Began executing node model.medallion_dbt.stg_transactions
[0m23:40:16.222259 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.fct_customer_transactions"
[0m23:40:16.223038 [debug] [Thread-2 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m23:40:16.223837 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m23:40:16.224236 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m23:40:16.224590 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: BEGIN
[0m23:40:16.224945 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m23:40:16.225312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:16.225718 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:40:16.226889 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:40:16.227327 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m23:40:16.227746 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m23:40:16.228227 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      -- models/silver/stg_transactions.sql
-- Modelo staging de transacciones. Toma el parquet limpio generado en Silver
-- y normaliza columnas seg√∫n lo definido en schema.yml.






WITH source_clean AS (
    SELECT *
    FROM read_parquet(
        clean_dir || '/transactions_' || ds_nodash || '_clean.parquet'
    )
),

typed AS (
    SELECT
        /* Clave primaria obligatoria */
        CAST(transaction_id AS VARCHAR) AS transaction_id,

        /* Relaci√≥n con clientes */
        CAST(customer_id AS VARCHAR) AS customer_id,

        /* Montos: el schema.yml exige non_negative */
        CAST(amount AS DOUBLE) AS amount,

        /* Normalizaci√≥n del estado */
        LOWER(TRIM(status)) AS status,

        /* Timestamp obligatorio */
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM source_clean
),

validated AS (
    SELECT
        *,
        /* Campo derivado obligatorio seg√∫n schema.yml */
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed', 'pending', 'failed')
)

SELECT *
FROM validated
    );
  
  
[0m23:40:16.228672 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m23:40:16.229496 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
    
    

    create  table
      "medallion"."main"."stg_transactions__dbt_tmp"
  
    as (
      




WITH src AS (

    SELECT *
    FROM read_parquet(
        '/data/clean/transactions_20251201_clean.parquet'
    )

),

typed AS (

    SELECT
        CAST(transaction_id AS VARCHAR) AS transaction_id,
        CAST(customer_id AS VARCHAR) AS customer_id,
        CAST(amount AS DOUBLE) AS amount,
        LOWER(TRIM(status)) AS status,
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM src

),

final AS (

    SELECT
        transaction_id,
        customer_id,
        amount,
        status,
        transaction_ts,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed','pending','failed')

)

SELECT *
FROM final
    );
  
  
[0m23:40:16.230304 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      -- models/silver/stg_transactions.sql
-- Modelo staging de transacciones. Toma el parquet limpio generado en Silver
-- y normaliza columnas seg√∫n lo definido en schema.yml.






WITH source_clean AS (
    SELECT *
    FROM read_parquet(
        clean_dir || '/transactions_' || ds_nodash || '_clean.parquet'
    )
),

typed AS (
    SELECT
        /* Clave primaria obligatoria */
        CAST(transaction_id AS VARCHAR) AS transaction_id,

        /* Relaci√≥n con clientes */
        CAST(customer_id AS VARCHAR) AS customer_id,

        /* Montos: el schema.yml exige non_negative */
        CAST(amount AS DOUBLE) AS amount,

        /* Normalizaci√≥n del estado */
        LOWER(TRIM(status)) AS status,

        /* Timestamp obligatorio */
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM source_clean
),

validated AS (
    SELECT
        *,
        /* Campo derivado obligatorio seg√∫n schema.yml */
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed', 'pending', 'failed')
)

SELECT *
FROM validated
    );
  
  
[0m23:40:16.231028 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
    
    

    create  table
      "medallion"."main"."stg_transactions__dbt_tmp"
  
    as (
      




WITH src AS (

    SELECT *
    FROM read_parquet(
        '/data/clean/transactions_20251201_clean.parquet'
    )

),

typed AS (

    SELECT
        CAST(transaction_id AS VARCHAR) AS transaction_id,
        CAST(customer_id AS VARCHAR) AS customer_id,
        CAST(amount AS DOUBLE) AS amount,
        LOWER(TRIM(status)) AS status,
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM src

),

final AS (

    SELECT
        transaction_id,
        customer_id,
        amount,
        status,
        transaction_ts,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed','pending','failed')

)

SELECT *
FROM final
    );
  
  
[0m23:40:16.231672 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:40:16.232209 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m23:40:16.233177 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: ROLLBACK
[0m23:40:16.234052 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m23:40:16.236763 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.fct_customer_transactions'
[0m23:40:16.237959 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: Close
[0m23:40:16.238676 [debug] [Thread-2 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m23:40:16.239433 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: Close
[0m23:40:16.240411 [debug] [Thread-1 (]: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  IO Error: No files found that match the pattern "clean_dir/transactions_ds_nodash_clean.parquet"
  
  LINE 22:     FROM read_parquet(
                    ^
[0m23:40:16.244898 [debug] [Thread-2 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  IO Error: No files found that match the pattern "/data/clean/transactions_20251201_clean.parquet"
  
  LINE 19:     FROM read_parquet(
                    ^
[0m23:40:16.246164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '107ca440-0ea7-4e35-b1e2-4e2afcdf36fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff032cde440>]}
[0m23:40:16.246719 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '107ca440-0ea7-4e35-b1e2-4e2afcdf36fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff032bea0e0>]}
[0m23:40:16.248964 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model main.stg_transactions .................... [[31mERROR[0m in 0.08s]
[0m23:40:16.249848 [debug] [Thread-2 (]: Finished running node model.medallion_dbt.stg_transactions
[0m23:40:16.250569 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model main.fct_customer_transactions ........... [[31mERROR[0m in 0.08s]
[0m23:40:16.251309 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  IO Error: No files found that match the pattern "/data/clean/transactions_20251201_clean.parquet"
  
  LINE 19:     FROM read_parquet(
                    ^.
[0m23:40:16.251923 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m23:40:16.252978 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.fct_customer_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  IO Error: No files found that match the pattern "clean_dir/transactions_ds_nodash_clean.parquet"
  
  LINE 22:     FROM read_parquet(
                    ^.
[0m23:40:16.255280 [debug] [MainThread]: Using duckdb connection "master"
[0m23:40:16.256068 [debug] [MainThread]: On master: BEGIN
[0m23:40:16.256533 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:40:16.257787 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:40:16.258136 [debug] [MainThread]: On master: COMMIT
[0m23:40:16.258426 [debug] [MainThread]: Using duckdb connection "master"
[0m23:40:16.258682 [debug] [MainThread]: On master: COMMIT
[0m23:40:16.259281 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:40:16.259680 [debug] [MainThread]: On master: Close
[0m23:40:16.260390 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:40:16.260649 [debug] [MainThread]: Connection 'model.medallion_dbt.fct_customer_transactions' was properly closed.
[0m23:40:16.260888 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m23:40:16.261531 [info ] [MainThread]: 
[0m23:40:16.262015 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m23:40:16.262897 [debug] [MainThread]: Command end result
[0m23:40:16.286217 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m23:40:16.289167 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m23:40:16.297106 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m23:40:16.297560 [info ] [MainThread]: 
[0m23:40:16.298263 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m23:40:16.298913 [info ] [MainThread]: 
[0m23:40:16.299483 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m23:40:16.299831 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  IO Error: No files found that match the pattern "/data/clean/transactions_20251201_clean.parquet"
  
  LINE 19:     FROM read_parquet(
                    ^
[0m23:40:16.300099 [info ] [MainThread]: 
[0m23:40:16.300439 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m23:40:16.300718 [info ] [MainThread]: 
[0m23:40:16.301124 [error] [MainThread]: [31mFailure in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)[0m
[0m23:40:16.301425 [error] [MainThread]:   Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  IO Error: No files found that match the pattern "clean_dir/transactions_ds_nodash_clean.parquet"
  
  LINE 22:     FROM read_parquet(
                    ^
[0m23:40:16.301660 [info ] [MainThread]: 
[0m23:40:16.301933 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/fct_customer_transactions.sql
[0m23:40:16.302166 [info ] [MainThread]: 
[0m23:40:16.302467 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=2
[0m23:40:16.302906 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m23:40:16.303732 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.460158, "process_in_blocks": "0", "process_kernel_time": 0.142287, "process_mem_max_rss": "158656", "process_out_blocks": "3240", "process_user_time": 2.596237}
[0m23:40:16.304120 [debug] [MainThread]: Command `dbt run` failed at 23:40:16.304047 after 1.46 seconds
[0m23:40:16.304484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff041a95390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff041946e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff041b0f070>]}
[0m23:40:16.304851 [debug] [MainThread]: Flushing usage events
[0m23:40:17.628600 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:51:12.436649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f962a4653c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96294082b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9629408250>]}


============================== 23:51:12.441600 | aa6bd083-f72a-40ee-8e70-afd1a3f7a47e ==============================
[0m23:51:12.441600 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:51:12.442079 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'introspect': 'True', 'printer_width': '80', 'quiet': 'False', 'write_json': 'True', 'invocation_command': 'dbt run --profiles-dir /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/../profiles --vars {"ds": "20251201"}', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'log_format': 'default', 'log_path': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/logs', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'target_path': 'None', 'partial_parse': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'profiles_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/../profiles', 'static_parser': 'True', 'fail_fast': 'False', 'no_print': 'None'}
[0m23:51:12.711293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa6bd083-f72a-40ee-8e70-afd1a3f7a47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f962be09b40>]}
[0m23:51:12.841034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa6bd083-f72a-40ee-8e70-afd1a3f7a47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96294060b0>]}
[0m23:51:12.844304 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m23:51:12.944528 [debug] [MainThread]: checksum: 930605a5b191b04e33a9cdc4385d0fd5d6ead171c661db7ccd31c1a981711ed6, vars: {'ds': '20251201'}, profile: , target: , version: 1.10.15
[0m23:51:13.085761 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:51:13.095359 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:51:13.167906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa6bd083-f72a-40ee-8e70-afd1a3f7a47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96205e8130>]}
[0m23:51:13.339651 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m23:51:13.341422 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m23:51:13.353025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa6bd083-f72a-40ee-8e70-afd1a3f7a47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f962057b940>]}
[0m23:51:13.353748 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m23:51:13.354563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa6bd083-f72a-40ee-8e70-afd1a3f7a47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f962057ab60>]}
[0m23:51:13.357829 [info ] [MainThread]: 
[0m23:51:13.358305 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:51:13.358686 [info ] [MainThread]: 
[0m23:51:13.359199 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:51:13.366642 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m23:51:13.397902 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m23:51:13.398437 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m23:51:13.398758 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:13.422164 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m23:51:13.425285 [debug] [ThreadPool]: On list_medallion: Close
[0m23:51:13.426785 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m23:51:13.427479 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m23:51:13.436133 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m23:51:13.437228 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m23:51:13.437596 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:51:13.440092 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:51:13.442233 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m23:51:13.442958 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m23:51:13.444010 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:51:13.444391 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m23:51:13.444649 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m23:51:13.445525 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:51:13.446869 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m23:51:13.447187 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m23:51:13.447457 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m23:51:13.447863 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:51:13.448131 [debug] [ThreadPool]: On create_medallion_main: Close
[0m23:51:13.449223 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m23:51:13.457267 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m23:51:13.458270 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m23:51:13.458708 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:51:13.460902 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:51:13.461245 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m23:51:13.461503 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m23:51:13.473036 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m23:51:13.476980 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m23:51:13.478473 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m23:51:13.478844 [debug] [ThreadPool]: On list_medallion_main: Close
[0m23:51:13.479535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa6bd083-f72a-40ee-8e70-afd1a3f7a47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96251865f0>]}
[0m23:51:13.480088 [debug] [MainThread]: Using duckdb connection "master"
[0m23:51:13.480384 [debug] [MainThread]: On master: BEGIN
[0m23:51:13.480703 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:51:13.481508 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:51:13.481793 [debug] [MainThread]: On master: COMMIT
[0m23:51:13.482074 [debug] [MainThread]: Using duckdb connection "master"
[0m23:51:13.482342 [debug] [MainThread]: On master: COMMIT
[0m23:51:13.482775 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:51:13.483062 [debug] [MainThread]: On master: Close
[0m23:51:13.486985 [debug] [Thread-1 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m23:51:13.487642 [debug] [Thread-2 (]: Began running node model.medallion_dbt.stg_transactions
[0m23:51:13.489042 [info ] [Thread-1 (]: 1 of 2 START sql table model main.fct_customer_transactions .................... [RUN]
[0m23:51:13.490102 [info ] [Thread-2 (]: 2 of 2 START sql table model main.stg_transactions ............................. [RUN]
[0m23:51:13.490971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.fct_customer_transactions)
[0m23:51:13.491798 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.medallion_dbt.stg_transactions'
[0m23:51:13.492269 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.fct_customer_transactions
[0m23:51:13.492729 [debug] [Thread-2 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m23:51:13.501428 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.fct_customer_transactions"
[0m23:51:13.509781 [debug] [Thread-2 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m23:51:13.510613 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.fct_customer_transactions
[0m23:51:13.511029 [debug] [Thread-2 (]: Began executing node model.medallion_dbt.stg_transactions
[0m23:51:13.559499 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.fct_customer_transactions"
[0m23:51:13.560132 [debug] [Thread-2 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m23:51:13.561227 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m23:51:13.561657 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m23:51:13.562051 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m23:51:13.562681 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: BEGIN
[0m23:51:13.563184 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:51:13.563720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:13.565103 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m23:51:13.565527 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m23:51:13.565895 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:51:13.566252 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
    
    

    create  table
      "medallion"."main"."stg_transactions__dbt_tmp"
  
    as (
      




WITH src AS (

    SELECT *
    FROM read_parquet(
        '/data/clean/transactions_20251201_clean.parquet'
    )

),

typed AS (

    SELECT
        CAST(transaction_id AS VARCHAR) AS transaction_id,
        CAST(customer_id AS VARCHAR) AS customer_id,
        CAST(amount AS DOUBLE) AS amount,
        LOWER(TRIM(status)) AS status,
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM src

),

final AS (

    SELECT
        transaction_id,
        customer_id,
        amount,
        status,
        transaction_ts,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed','pending','failed')

)

SELECT *
FROM final
    );
  
  
[0m23:51:13.566579 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m23:51:13.567372 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      -- models/silver/stg_transactions.sql
-- Modelo staging de transacciones. Toma el parquet limpio generado en Silver
-- y normaliza columnas seg√∫n lo definido en schema.yml.






WITH source_clean AS (
    SELECT *
    FROM read_parquet(
        clean_dir || '/transactions_' || ds_nodash || '_clean.parquet'
    )
),

typed AS (
    SELECT
        /* Clave primaria obligatoria */
        CAST(transaction_id AS VARCHAR) AS transaction_id,

        /* Relaci√≥n con clientes */
        CAST(customer_id AS VARCHAR) AS customer_id,

        /* Montos: el schema.yml exige non_negative */
        CAST(amount AS DOUBLE) AS amount,

        /* Normalizaci√≥n del estado */
        LOWER(TRIM(status)) AS status,

        /* Timestamp obligatorio */
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM source_clean
),

validated AS (
    SELECT
        *,
        /* Campo derivado obligatorio seg√∫n schema.yml */
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed', 'pending', 'failed')
)

SELECT *
FROM validated
    );
  
  
[0m23:51:13.568063 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
    
    

    create  table
      "medallion"."main"."stg_transactions__dbt_tmp"
  
    as (
      




WITH src AS (

    SELECT *
    FROM read_parquet(
        '/data/clean/transactions_20251201_clean.parquet'
    )

),

typed AS (

    SELECT
        CAST(transaction_id AS VARCHAR) AS transaction_id,
        CAST(customer_id AS VARCHAR) AS customer_id,
        CAST(amount AS DOUBLE) AS amount,
        LOWER(TRIM(status)) AS status,
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM src

),

final AS (

    SELECT
        transaction_id,
        customer_id,
        amount,
        status,
        transaction_ts,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed','pending','failed')

)

SELECT *
FROM final
    );
  
  
[0m23:51:13.569064 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m23:51:13.569672 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m23:51:13.570118 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      -- models/silver/stg_transactions.sql
-- Modelo staging de transacciones. Toma el parquet limpio generado en Silver
-- y normaliza columnas seg√∫n lo definido en schema.yml.






WITH source_clean AS (
    SELECT *
    FROM read_parquet(
        clean_dir || '/transactions_' || ds_nodash || '_clean.parquet'
    )
),

typed AS (
    SELECT
        /* Clave primaria obligatoria */
        CAST(transaction_id AS VARCHAR) AS transaction_id,

        /* Relaci√≥n con clientes */
        CAST(customer_id AS VARCHAR) AS customer_id,

        /* Montos: el schema.yml exige non_negative */
        CAST(amount AS DOUBLE) AS amount,

        /* Normalizaci√≥n del estado */
        LOWER(TRIM(status)) AS status,

        /* Timestamp obligatorio */
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM source_clean
),

validated AS (
    SELECT
        *,
        /* Campo derivado obligatorio seg√∫n schema.yml */
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed', 'pending', 'failed')
)

SELECT *
FROM validated
    );
  
  
[0m23:51:13.570655 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:51:13.571541 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: ROLLBACK
[0m23:51:13.574377 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.fct_customer_transactions'
[0m23:51:13.574962 [debug] [Thread-2 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m23:51:13.575356 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: Close
[0m23:51:13.575681 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: Close
[0m23:51:13.576719 [debug] [Thread-1 (]: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  IO Error: No files found that match the pattern "clean_dir/transactions_ds_nodash_clean.parquet"
  
  LINE 22:     FROM read_parquet(
                    ^
[0m23:51:13.577331 [debug] [Thread-2 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  IO Error: No files found that match the pattern "/data/clean/transactions_20251201_clean.parquet"
  
  LINE 19:     FROM read_parquet(
                    ^
[0m23:51:13.578792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa6bd083-f72a-40ee-8e70-afd1a3f7a47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96293bdab0>]}
[0m23:51:13.579234 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa6bd083-f72a-40ee-8e70-afd1a3f7a47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9629df5930>]}
[0m23:51:13.579873 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model main.fct_customer_transactions ........... [[31mERROR[0m in 0.09s]
[0m23:51:13.580455 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model main.stg_transactions .................... [[31mERROR[0m in 0.09s]
[0m23:51:13.580985 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m23:51:13.581422 [debug] [Thread-2 (]: Finished running node model.medallion_dbt.stg_transactions
[0m23:51:13.581935 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.fct_customer_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  IO Error: No files found that match the pattern "clean_dir/transactions_ds_nodash_clean.parquet"
  
  LINE 22:     FROM read_parquet(
                    ^.
[0m23:51:13.582860 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  IO Error: No files found that match the pattern "/data/clean/transactions_20251201_clean.parquet"
  
  LINE 19:     FROM read_parquet(
                    ^.
[0m23:51:13.583994 [debug] [MainThread]: Using duckdb connection "master"
[0m23:51:13.584410 [debug] [MainThread]: On master: BEGIN
[0m23:51:13.584747 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:51:13.585574 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:51:13.586039 [debug] [MainThread]: On master: COMMIT
[0m23:51:13.586419 [debug] [MainThread]: Using duckdb connection "master"
[0m23:51:13.586807 [debug] [MainThread]: On master: COMMIT
[0m23:51:13.587457 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:51:13.587769 [debug] [MainThread]: On master: Close
[0m23:51:13.588190 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:51:13.588474 [debug] [MainThread]: Connection 'model.medallion_dbt.fct_customer_transactions' was properly closed.
[0m23:51:13.588708 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m23:51:13.589020 [info ] [MainThread]: 
[0m23:51:13.589294 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m23:51:13.589931 [debug] [MainThread]: Command end result
[0m23:51:13.612083 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m23:51:13.615648 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m23:51:13.624467 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m23:51:13.625346 [info ] [MainThread]: 
[0m23:51:13.625736 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m23:51:13.626057 [info ] [MainThread]: 
[0m23:51:13.626441 [error] [MainThread]: [31mFailure in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)[0m
[0m23:51:13.626768 [error] [MainThread]:   Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  IO Error: No files found that match the pattern "clean_dir/transactions_ds_nodash_clean.parquet"
  
  LINE 22:     FROM read_parquet(
                    ^
[0m23:51:13.627017 [info ] [MainThread]: 
[0m23:51:13.627355 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/fct_customer_transactions.sql
[0m23:51:13.627622 [info ] [MainThread]: 
[0m23:51:13.627928 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m23:51:13.628241 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  IO Error: No files found that match the pattern "/data/clean/transactions_20251201_clean.parquet"
  
  LINE 19:     FROM read_parquet(
                    ^
[0m23:51:13.628509 [info ] [MainThread]: 
[0m23:51:13.628798 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m23:51:13.629067 [info ] [MainThread]: 
[0m23:51:13.629353 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=2
[0m23:51:13.630097 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2521378, "process_in_blocks": "0", "process_kernel_time": 0.130237, "process_mem_max_rss": "152364", "process_out_blocks": "2216", "process_user_time": 2.472502}
[0m23:51:13.630452 [debug] [MainThread]: Command `dbt run` failed at 23:51:13.630385 after 1.25 seconds
[0m23:51:13.630748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f962a4653c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f962a328820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9629408850>]}
[0m23:51:13.631091 [debug] [MainThread]: Flushing usage events
[0m23:51:14.741484 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:57:58.567266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c79c2269390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c79c1208280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c79c1208220>]}


============================== 23:57:58.573716 | 7af4b941-bc47-4740-bb09-e5dd6111bc54 ==============================
[0m23:57:58.573716 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:57:58.575891 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'profiles_dir': '/home/rantez/.dbt', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'printer_width': '80', 'target_path': 'None', 'empty': 'False', 'no_print': 'None', 'quiet': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt run --vars {"ds": "20251207", "clean_dir": "/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean"}', 'log_path': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/logs', 'debug': 'False', 'static_parser': 'True'}
[0m23:57:58.579995 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'medallion_duckdb'
[0m23:57:58.581328 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.069196016, "process_in_blocks": "0", "process_kernel_time": 0.079934, "process_mem_max_rss": "95304", "process_out_blocks": "16", "process_user_time": 1.200009}
[0m23:57:58.582036 [debug] [MainThread]: Command `dbt run` failed at 23:57:58.581893 after 0.07 seconds
[0m23:57:58.582409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c79c2269390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c79c12094e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c79c120b0d0>]}
[0m23:57:58.582879 [debug] [MainThread]: Flushing usage events
[0m23:57:59.527521 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:59:02.422986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da350975360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da34f934280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da34f934220>]}


============================== 23:59:02.425995 | ffba0d2a-faf0-463a-8286-6dd70a32f200 ==============================
[0m23:59:02.425995 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:59:02.426525 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'profiles_dir': '/home/rantez/.dbt', 'use_colors': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --vars {"ds": "20251207", "clean_dir": "/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean"}', 'printer_width': '80', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'write_json': 'True', 'log_format': 'default', 'debug': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'empty': 'False', 'version_check': 'True', 'quiet': 'False', 'log_path': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/logs', 'warn_error': 'None', 'static_parser': 'True', 'use_experimental_parser': 'False'}
[0m23:59:02.428719 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'medallion_duckdb'
[0m23:59:02.429464 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.05605561, "process_in_blocks": "0", "process_kernel_time": 0.045977, "process_mem_max_rss": "95308", "process_out_blocks": "16", "process_user_time": 1.001502}
[0m23:59:02.429847 [debug] [MainThread]: Command `dbt run` failed at 23:59:02.429774 after 0.06 seconds
[0m23:59:02.430146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da350975360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da34f9354e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da34f9370a0>]}
[0m23:59:02.430557 [debug] [MainThread]: Flushing usage events
[0m23:59:03.730848 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:30:40.371477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ef40095420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ef3f060220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ef3f0601c0>]}


============================== 00:30:40.375248 | d8f9afcb-4fca-49a5-a635-3aa864ad93a1 ==============================
[0m00:30:40.375248 [info ] [MainThread]: Running with dbt=1.10.15
[0m00:30:40.375764 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'profiles_dir': '/home/rantez/.dbt', 'log_cache_events': 'False', 'use_colors': 'True', 'no_print': 'None', 'fail_fast': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt run --vars {"ds": "20251207", "clean_dir": "/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean"}', 'static_parser': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'quiet': 'False', 'empty': 'False', 'log_path': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/logs', 'target_path': 'None', 'debug': 'False', 'introspect': 'True', 'warn_error': 'None'}
[0m00:30:40.378139 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'medallion_duckdb'
[0m00:30:40.378980 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.057781015, "process_in_blocks": "0", "process_kernel_time": 0.097644, "process_mem_max_rss": "95300", "process_out_blocks": "8", "process_user_time": 1.496544}
[0m00:30:40.379512 [debug] [MainThread]: Command `dbt run` failed at 00:30:40.379422 after 0.06 seconds
[0m00:30:40.379928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ef40095420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ef3f061480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ef3f0631c0>]}
[0m00:30:40.380497 [debug] [MainThread]: Flushing usage events
[0m00:30:41.735788 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:31:44.682737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfc84f6d3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfc83f342b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfc83f34250>]}


============================== 00:31:44.685865 | 9dcb7a28-71bb-4aea-8115-1dc950229135 ==============================
[0m00:31:44.685865 [info ] [MainThread]: Running with dbt=1.10.15
[0m00:31:44.686657 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'quiet': 'False', 'write_json': 'True', 'log_path': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/logs', 'debug': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'static_parser': 'True', 'fail_fast': 'False', 'log_format': 'default', 'empty': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'invocation_command': 'dbt run --vars {"ds": "20251207", "clean_dir": "/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean"}', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'partial_parse': 'True', 'profiles_dir': '/home/rantez/.dbt', 'use_experimental_parser': 'False', 'version_check': 'True'}
[0m00:31:44.690567 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'medallion_duckdb'
[0m00:31:44.691470 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.0745739, "process_in_blocks": "0", "process_kernel_time": 0.07599, "process_mem_max_rss": "95356", "process_out_blocks": "16", "process_user_time": 1.29984}
[0m00:31:44.691890 [debug] [MainThread]: Command `dbt run` failed at 00:31:44.691814 after 0.08 seconds
[0m00:31:44.692202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfc84f6d3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfc83f35510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfc83f370d0>]}
[0m00:31:44.692610 [debug] [MainThread]: Flushing usage events
[0m00:31:45.941888 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:38:40.467516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7456f5e75390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7456f4e44d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7456f4e44d00>]}


============================== 00:38:40.471088 | c0a70f5b-04b7-43bf-9e5a-9b209c3ba952 ==============================
[0m00:38:40.471088 [info ] [MainThread]: Running with dbt=1.10.15
[0m00:38:40.471747 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'log_path': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/logs', 'target_path': 'None', 'write_json': 'True', 'quiet': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'static_parser': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'profiles_dir': '/home/rantez/.dbt', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'version_check': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt run --vars {"ds": "20251207", "clean_dir": "/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean"}', 'empty': 'False'}
[0m00:38:40.476415 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'medallion_duckdb'
[0m00:38:40.482060 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.078363, "process_in_blocks": "0", "process_kernel_time": 0.060944, "process_mem_max_rss": "95380", "process_out_blocks": "8", "process_user_time": 1.254851}
[0m00:38:40.483103 [debug] [MainThread]: Command `dbt run` failed at 00:38:40.482900 after 0.08 seconds
[0m00:38:40.483764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7456f5e75390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7456f4e45fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7456f4e44430>]}
[0m00:38:40.484474 [debug] [MainThread]: Flushing usage events
[0m00:38:41.381201 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:39:44.234819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708429ea1300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708428e642b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708428e64250>]}


============================== 00:39:44.238470 | ce642af7-0514-4d01-af29-95cc78818c82 ==============================
[0m00:39:44.238470 [info ] [MainThread]: Running with dbt=1.10.15
[0m00:39:44.239080 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'printer_width': '80', 'empty': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'target_path': 'None', 'invocation_command': 'dbt run --vars {"ds": "20251207", "clean_dir": "/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean"}', 'static_parser': 'True', 'partial_parse': 'True', 'version_check': 'True', 'use_colors': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'log_path': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/logs', 'profiles_dir': '/home/rantez/.dbt', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'no_print': 'None', 'write_json': 'True'}
[0m00:39:44.243299 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'medallion_duckdb'
[0m00:39:44.244228 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.056268465, "process_in_blocks": "0", "process_kernel_time": 0.078936, "process_mem_max_rss": "95204", "process_out_blocks": "8", "process_user_time": 1.234011}
[0m00:39:44.244691 [debug] [MainThread]: Command `dbt run` failed at 00:39:44.244605 after 0.06 seconds
[0m00:39:44.245129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708429ea1300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708428e65510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708428e67010>]}
[0m00:39:44.246043 [debug] [MainThread]: Flushing usage events
[0m00:39:45.074721 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:44:57.400161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf639169360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf638108280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf638108220>]}


============================== 00:44:57.402704 | 36ee6f32-f56a-49a4-8882-e1f0c0edca46 ==============================
[0m00:44:57.402704 [info ] [MainThread]: Running with dbt=1.10.15
[0m00:44:57.403894 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'cache_selected_only': 'False', 'partial_parse': 'True', 'debug': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'log_path': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/logs', 'target_path': 'None', 'invocation_command': 'dbt run --vars {"ds": "20251207", "clean_dir": "/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean"}', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'fail_fast': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'warn_error': 'None', 'quiet': 'False', 'introspect': 'True', 'use_colors': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/rantez/.dbt'}
[0m00:44:57.406602 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'medallion_duckdb'
[0m00:44:57.407330 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.05905167, "process_in_blocks": "0", "process_kernel_time": 0.067936, "process_mem_max_rss": "95308", "process_out_blocks": "16", "process_user_time": 1.118959}
[0m00:44:57.407703 [debug] [MainThread]: Command `dbt run` failed at 00:44:57.407627 after 0.06 seconds
[0m00:44:57.408009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf639169360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf6381094e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf63810b0a0>]}
[0m00:44:57.408439 [debug] [MainThread]: Flushing usage events
[0m00:44:58.320990 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:46:00.541374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e30e86713c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e30e76382b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e30e7638250>]}


============================== 00:46:00.545523 | c0c98fdd-0e1b-4e2d-ac7a-f041034e6947 ==============================
[0m00:46:00.545523 [info ] [MainThread]: Running with dbt=1.10.15
[0m00:46:00.546446 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'printer_width': '80', 'static_parser': 'True', 'partial_parse': 'True', 'profiles_dir': '/home/rantez/.dbt', 'write_json': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'no_print': 'None', 'use_experimental_parser': 'False', 'use_colors': 'True', 'target_path': 'None', 'introspect': 'True', 'invocation_command': 'dbt run --vars {"ds": "20251207", "clean_dir": "/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean"}', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'debug': 'False', 'empty': 'False', 'log_path': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/logs', 'quiet': 'False'}
[0m00:46:00.548764 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'medallion_duckdb'
[0m00:46:00.549616 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.07044238, "process_in_blocks": "0", "process_kernel_time": 0.078003, "process_mem_max_rss": "95296", "process_out_blocks": "8", "process_user_time": 1.159056}
[0m00:46:00.550011 [debug] [MainThread]: Command `dbt run` failed at 00:46:00.549927 after 0.07 seconds
[0m00:46:00.550331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e30e86713c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e30e7639510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e30e763b0d0>]}
[0m00:46:00.550747 [debug] [MainThread]: Flushing usage events
[0m00:46:06.309990 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:06:45.207317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcbd1e79360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcbd0e40280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcbd0e40220>]}


============================== 01:06:45.210460 | b23dd8f7-ad1d-4f59-b46a-a06192ab36a2 ==============================
[0m01:06:45.210460 [info ] [MainThread]: Running with dbt=1.10.15
[0m01:06:45.210926 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'quiet': 'False', 'log_path': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/logs', 'log_format': 'default', 'empty': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'partial_parse': 'True', 'target_path': 'None', 'fail_fast': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'profiles_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles', 'warn_error': 'None', 'log_cache_events': 'False', 'debug': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --profiles-dir /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles --vars {"ds": "20251207", "clean_dir": "/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean"}'}
[0m01:06:45.214383 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DUCKDB_PATH'
[0m01:06:45.215106 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.061080664, "process_in_blocks": "0", "process_kernel_time": 0.060011, "process_mem_max_rss": "95316", "process_out_blocks": "8", "process_user_time": 1.211229}
[0m01:06:45.215493 [debug] [MainThread]: Command `dbt run` failed at 01:06:45.215418 after 0.06 seconds
[0m01:06:45.215786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcbd1e79360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcbd0e41ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcbd0e41300>]}
[0m01:06:45.216126 [debug] [MainThread]: Flushing usage events
[0m01:06:46.083184 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:07:48.262078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x6ffdb9f993c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x6ffdb8f682b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x6ffdb8f68250>]}


============================== 01:07:48.264948 | 7e3bd15e-d211-4398-ab43-4e002b206f7c ==============================
[0m01:07:48.264948 [info ] [MainThread]: Running with dbt=1.10.15
[0m01:07:48.265454 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'profiles_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles', 'use_experimental_parser': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'log_path': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/logs', 'log_cache_events': 'False', 'introspect': 'True', 'write_json': 'True', 'static_parser': 'True', 'version_check': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'invocation_command': 'dbt run --profiles-dir /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles --vars {"ds": "20251207", "clean_dir": "/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean"}', 'quiet': 'False', 'log_format': 'default', 'target_path': 'None', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'partial_parse': 'True'}
[0m01:07:48.269131 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DUCKDB_PATH'
[0m01:07:48.269852 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.06145191, "process_in_blocks": "0", "process_kernel_time": 0.068008, "process_mem_max_rss": "95376", "process_out_blocks": "16", "process_user_time": 1.126143}
[0m01:07:48.270261 [debug] [MainThread]: Command `dbt run` failed at 01:07:48.270188 after 0.06 seconds
[0m01:07:48.270579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x6ffdb9f993c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x6ffdb8f69ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x6ffdb8f69330>]}
[0m01:07:48.271047 [debug] [MainThread]: Flushing usage events
[0m01:07:49.160441 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:13:14.470837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2746475390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2745444280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2745444220>]}


============================== 01:13:14.472997 | f2fdc5b5-49c3-4441-8059-72f192af42af ==============================
[0m01:13:14.472997 [info ] [MainThread]: Running with dbt=1.10.15
[0m01:13:14.473465 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'introspect': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'static_parser': 'True', 'use_colors': 'True', 'profiles_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles', 'debug': 'False', 'invocation_command': 'dbt run --profiles-dir /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles --vars {"ds": "20251207", "clean_dir": "/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean"}', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'log_path': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/logs', 'fail_fast': 'False', 'target_path': 'None', 'warn_error': 'None', 'empty': 'False', 'log_cache_events': 'False', 'log_format': 'default'}
[0m01:13:14.667732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2fdc5b5-49c3-4441-8059-72f192af42af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2745e23130>]}
[0m01:13:14.730341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2fdc5b5-49c3-4441-8059-72f192af42af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27453eedd0>]}
[0m01:13:14.731812 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m01:13:14.800185 [debug] [MainThread]: checksum: 505cc0738468dbf8af23784e25e0465f2f41e62e9895701049268b92bd4ad565, vars: {'clean_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean',
 'ds': '20251207'}, profile: , target: , version: 1.10.15
[0m01:13:14.891538 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m01:13:14.892276 [debug] [MainThread]: previous checksum: 505cc0738468dbf8af23784e25e0465f2f41e62e9895701049268b92bd4ad565, current checksum: 930605a5b191b04e33a9cdc4385d0fd5d6ead171c661db7ccd31c1a981711ed6
[0m01:13:14.893020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f2fdc5b5-49c3-4441-8059-72f192af42af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2745c4cbe0>]}
[0m01:13:15.961609 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m01:13:15.962183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f2fdc5b5-49c3-4441-8059-72f192af42af', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f273c24ead0>]}
[0m01:13:16.042923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2fdc5b5-49c3-4441-8059-72f192af42af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f273c134130>]}
[0m01:13:16.222801 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m01:13:16.226693 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m01:13:16.236716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2fdc5b5-49c3-4441-8059-72f192af42af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f273c1340d0>]}
[0m01:13:16.237216 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m01:13:16.237537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2fdc5b5-49c3-4441-8059-72f192af42af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f273c136bf0>]}
[0m01:13:16.238870 [info ] [MainThread]: 
[0m01:13:16.239185 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:13:16.239431 [info ] [MainThread]: 
[0m01:13:16.239839 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:13:16.245191 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m01:13:16.271587 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m01:13:16.272029 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m01:13:16.272319 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:13:16.284165 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m01:13:16.285433 [debug] [ThreadPool]: On list_medallion: Close
[0m01:13:16.286110 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m01:13:16.286544 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m01:13:16.293161 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m01:13:16.293694 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m01:13:16.294047 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:13:16.296141 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m01:13:16.297211 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m01:13:16.297490 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m01:13:16.297977 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:13:16.298243 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m01:13:16.298481 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m01:13:16.298924 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:13:16.299583 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m01:13:16.299859 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m01:13:16.300107 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m01:13:16.300479 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:13:16.300758 [debug] [ThreadPool]: On create_medallion_main: Close
[0m01:13:16.302010 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m01:13:16.306787 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m01:13:16.307359 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m01:13:16.307755 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:13:16.308635 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:13:16.309070 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m01:13:16.309379 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m01:13:16.319122 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m01:13:16.320312 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m01:13:16.320837 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m01:13:16.321136 [debug] [ThreadPool]: On list_medallion_main: Close
[0m01:13:16.321705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2fdc5b5-49c3-4441-8059-72f192af42af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f273c16f790>]}
[0m01:13:16.322321 [debug] [MainThread]: Using duckdb connection "master"
[0m01:13:16.322715 [debug] [MainThread]: On master: BEGIN
[0m01:13:16.323080 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:13:16.324149 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:13:16.324671 [debug] [MainThread]: On master: COMMIT
[0m01:13:16.325080 [debug] [MainThread]: Using duckdb connection "master"
[0m01:13:16.325454 [debug] [MainThread]: On master: COMMIT
[0m01:13:16.326384 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:13:16.326677 [debug] [MainThread]: On master: Close
[0m01:13:16.330166 [debug] [Thread-1 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m01:13:16.330585 [debug] [Thread-2 (]: Began running node model.medallion_dbt.stg_transactions
[0m01:13:16.331107 [info ] [Thread-1 (]: 1 of 2 START sql table model main.fct_customer_transactions .................... [RUN]
[0m01:13:16.331661 [info ] [Thread-2 (]: 2 of 2 START sql table model main.stg_transactions ............................. [RUN]
[0m01:13:16.332238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.fct_customer_transactions)
[0m01:13:16.332790 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.medallion_dbt.stg_transactions'
[0m01:13:16.333157 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.fct_customer_transactions
[0m01:13:16.333512 [debug] [Thread-2 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m01:13:16.343880 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.fct_customer_transactions"
[0m01:13:16.350557 [debug] [Thread-2 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m01:13:16.351314 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.fct_customer_transactions
[0m01:13:16.351821 [debug] [Thread-2 (]: Began executing node model.medallion_dbt.stg_transactions
[0m01:13:16.379636 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.fct_customer_transactions"
[0m01:13:16.383677 [debug] [Thread-2 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m01:13:16.384483 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m01:13:16.384895 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m01:13:16.385367 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: BEGIN
[0m01:13:16.385732 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m01:13:16.386146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:13:16.386476 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:13:16.387502 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:13:16.387813 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m01:13:16.388185 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m01:13:16.388670 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      -- models/silver/stg_transactions.sql
-- Modelo staging de transacciones. Toma el parquet limpio generado en Silver
-- y normaliza columnas seg√∫n lo definido en schema.yml.






WITH source_clean AS (
    SELECT *
    FROM read_parquet(
        clean_dir || '/transactions_' || ds_nodash || '_clean.parquet'
    )
),

typed AS (
    SELECT
        /* Clave primaria obligatoria */
        CAST(transaction_id AS VARCHAR) AS transaction_id,

        /* Relaci√≥n con clientes */
        CAST(customer_id AS VARCHAR) AS customer_id,

        /* Montos: el schema.yml exige non_negative */
        CAST(amount AS DOUBLE) AS amount,

        /* Normalizaci√≥n del estado */
        LOWER(TRIM(status)) AS status,

        /* Timestamp obligatorio */
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM source_clean
),

validated AS (
    SELECT
        *,
        /* Campo derivado obligatorio seg√∫n schema.yml */
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed', 'pending', 'failed')
)

SELECT *
FROM validated
    );
  
  
[0m01:13:16.389046 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m01:13:16.389852 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
    
    

    create  table
      "medallion"."main"."stg_transactions__dbt_tmp"
  
    as (
      




WITH src AS (

    SELECT *
    FROM read_parquet(
        '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean/transactions_20251207_clean.parquet'
    )

),

typed AS (

    SELECT
        CAST(transaction_id AS VARCHAR) AS transaction_id,
        CAST(customer_id AS VARCHAR) AS customer_id,
        CAST(amount AS DOUBLE) AS amount,
        LOWER(TRIM(status)) AS status,
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM src

),

final AS (

    SELECT
        transaction_id,
        customer_id,
        amount,
        status,
        transaction_ts,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed','pending','failed')

)

SELECT *
FROM final
    );
  
  
[0m01:13:16.390627 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      -- models/silver/stg_transactions.sql
-- Modelo staging de transacciones. Toma el parquet limpio generado en Silver
-- y normaliza columnas seg√∫n lo definido en schema.yml.






WITH source_clean AS (
    SELECT *
    FROM read_parquet(
        clean_dir || '/transactions_' || ds_nodash || '_clean.parquet'
    )
),

typed AS (
    SELECT
        /* Clave primaria obligatoria */
        CAST(transaction_id AS VARCHAR) AS transaction_id,

        /* Relaci√≥n con clientes */
        CAST(customer_id AS VARCHAR) AS customer_id,

        /* Montos: el schema.yml exige non_negative */
        CAST(amount AS DOUBLE) AS amount,

        /* Normalizaci√≥n del estado */
        LOWER(TRIM(status)) AS status,

        /* Timestamp obligatorio */
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM source_clean
),

validated AS (
    SELECT
        *,
        /* Campo derivado obligatorio seg√∫n schema.yml */
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed', 'pending', 'failed')
)

SELECT *
FROM validated
    );
  
  
[0m01:13:16.391559 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:13:16.392037 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: ROLLBACK
[0m01:13:16.392531 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
    
    

    create  table
      "medallion"."main"."stg_transactions__dbt_tmp"
  
    as (
      




WITH src AS (

    SELECT *
    FROM read_parquet(
        '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean/transactions_20251207_clean.parquet'
    )

),

typed AS (

    SELECT
        CAST(transaction_id AS VARCHAR) AS transaction_id,
        CAST(customer_id AS VARCHAR) AS customer_id,
        CAST(amount AS DOUBLE) AS amount,
        LOWER(TRIM(status)) AS status,
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM src

),

final AS (

    SELECT
        transaction_id,
        customer_id,
        amount,
        status,
        transaction_ts,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed','pending','failed')

)

SELECT *
FROM final
    );
  
  
[0m01:13:16.393289 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m01:13:16.393741 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m01:13:16.396409 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.fct_customer_transactions'
[0m01:13:16.396738 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: Close
[0m01:13:16.397312 [debug] [Thread-2 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m01:13:16.397852 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: Close
[0m01:13:16.398431 [debug] [Thread-1 (]: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  IO Error: No files found that match the pattern "clean_dir/transactions_ds_nodash_clean.parquet"
  
  LINE 22:     FROM read_parquet(
                    ^
[0m01:13:16.400511 [debug] [Thread-2 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Binder Error: Column "transaction_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m01:13:16.400863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2fdc5b5-49c3-4441-8059-72f192af42af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f274674dde0>]}
[0m01:13:16.401351 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2fdc5b5-49c3-4441-8059-72f192af42af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f273d5eae60>]}
[0m01:13:16.402116 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model main.fct_customer_transactions ........... [[31mERROR[0m in 0.07s]
[0m01:13:16.402787 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model main.stg_transactions .................... [[31mERROR[0m in 0.07s]
[0m01:13:16.403409 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m01:13:16.403922 [debug] [Thread-2 (]: Finished running node model.medallion_dbt.stg_transactions
[0m01:13:16.404649 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.fct_customer_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  IO Error: No files found that match the pattern "clean_dir/transactions_ds_nodash_clean.parquet"
  
  LINE 22:     FROM read_parquet(
                    ^.
[0m01:13:16.405558 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Binder Error: Column "transaction_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined.
[0m01:13:16.406621 [debug] [MainThread]: Using duckdb connection "master"
[0m01:13:16.406924 [debug] [MainThread]: On master: BEGIN
[0m01:13:16.407213 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:13:16.408281 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:13:16.408653 [debug] [MainThread]: On master: COMMIT
[0m01:13:16.409185 [debug] [MainThread]: Using duckdb connection "master"
[0m01:13:16.409584 [debug] [MainThread]: On master: COMMIT
[0m01:13:16.410514 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:13:16.412247 [debug] [MainThread]: On master: Close
[0m01:13:16.413770 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:13:16.414190 [debug] [MainThread]: Connection 'model.medallion_dbt.fct_customer_transactions' was properly closed.
[0m01:13:16.414495 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m01:13:16.415146 [info ] [MainThread]: 
[0m01:13:16.415523 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m01:13:16.416366 [debug] [MainThread]: Command end result
[0m01:13:16.437263 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m01:13:16.438818 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m01:13:16.445418 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m01:13:16.445831 [info ] [MainThread]: 
[0m01:13:16.446317 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m01:13:16.446649 [info ] [MainThread]: 
[0m01:13:16.447003 [error] [MainThread]: [31mFailure in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)[0m
[0m01:13:16.447342 [error] [MainThread]:   Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  IO Error: No files found that match the pattern "clean_dir/transactions_ds_nodash_clean.parquet"
  
  LINE 22:     FROM read_parquet(
                    ^
[0m01:13:16.447585 [info ] [MainThread]: 
[0m01:13:16.447874 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/fct_customer_transactions.sql
[0m01:13:16.448156 [info ] [MainThread]: 
[0m01:13:16.448464 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m01:13:16.448751 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Binder Error: Column "transaction_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m01:13:16.449013 [info ] [MainThread]: 
[0m01:13:16.449301 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m01:13:16.449557 [info ] [MainThread]: 
[0m01:13:16.449900 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=2
[0m01:13:16.450354 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m01:13:16.451116 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.0304618, "process_in_blocks": "0", "process_kernel_time": 0.123083, "process_mem_max_rss": "157872", "process_out_blocks": "3248", "process_user_time": 3.098108}
[0m01:13:16.451492 [debug] [MainThread]: Command `dbt run` failed at 01:13:16.451419 after 2.03 seconds
[0m01:13:16.451826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2746475390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27463730a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f273d534b50>]}
[0m01:13:16.452160 [debug] [MainThread]: Flushing usage events
[0m01:13:17.663072 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:14:19.685404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a61af65390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a619f0c280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a619f0c220>]}


============================== 01:14:19.687683 | d91c9ae8-bbbc-4dd3-a24f-2201e9d1eeab ==============================
[0m01:14:19.687683 [info ] [MainThread]: Running with dbt=1.10.15
[0m01:14:19.688150 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'cache_selected_only': 'False', 'log_path': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/logs', 'version_check': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles', 'introspect': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles --vars {"ds": "20251207", "clean_dir": "/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean"}', 'empty': 'False', 'no_print': 'None', 'quiet': 'False', 'debug': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'static_parser': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'warn_error': 'None', 'partial_parse': 'True'}
[0m01:14:19.890956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd91c9ae8-bbbc-4dd3-a24f-2201e9d1eeab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a61a8ef130>]}
[0m01:14:19.953376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd91c9ae8-bbbc-4dd3-a24f-2201e9d1eeab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a619eb6dd0>]}
[0m01:14:19.954892 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m01:14:20.023818 [debug] [MainThread]: checksum: 505cc0738468dbf8af23784e25e0465f2f41e62e9895701049268b92bd4ad565, vars: {'clean_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean',
 'ds': '20251207'}, profile: , target: , version: 1.10.15
[0m01:14:20.123842 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:14:20.125012 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:14:20.167168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd91c9ae8-bbbc-4dd3-a24f-2201e9d1eeab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a611fbc130>]}
[0m01:14:20.306041 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m01:14:20.307636 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m01:14:20.319624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd91c9ae8-bbbc-4dd3-a24f-2201e9d1eeab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a611fe4a30>]}
[0m01:14:20.320707 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m01:14:20.321545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd91c9ae8-bbbc-4dd3-a24f-2201e9d1eeab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a611fe4cd0>]}
[0m01:14:20.323487 [info ] [MainThread]: 
[0m01:14:20.323868 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:14:20.324165 [info ] [MainThread]: 
[0m01:14:20.324975 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:14:20.329470 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m01:14:20.364853 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m01:14:20.365355 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m01:14:20.365634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:14:20.377262 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m01:14:20.380179 [debug] [ThreadPool]: On list_medallion: Close
[0m01:14:20.381205 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m01:14:20.382035 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m01:14:20.387790 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m01:14:20.388109 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m01:14:20.388376 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:14:20.389399 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:14:20.390494 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m01:14:20.390833 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m01:14:20.392439 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:14:20.392792 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m01:14:20.393188 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m01:14:20.394266 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:14:20.395072 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m01:14:20.395371 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m01:14:20.395656 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m01:14:20.396091 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:14:20.396362 [debug] [ThreadPool]: On create_medallion_main: Close
[0m01:14:20.397397 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m01:14:20.402101 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m01:14:20.402401 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m01:14:20.402652 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:14:20.403198 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:14:20.403456 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m01:14:20.403693 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m01:14:20.414994 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m01:14:20.416481 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m01:14:20.417162 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m01:14:20.417457 [debug] [ThreadPool]: On list_medallion_main: Close
[0m01:14:20.418013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd91c9ae8-bbbc-4dd3-a24f-2201e9d1eeab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a611fb87f0>]}
[0m01:14:20.418483 [debug] [MainThread]: Using duckdb connection "master"
[0m01:14:20.418773 [debug] [MainThread]: On master: BEGIN
[0m01:14:20.419044 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:14:20.419616 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:14:20.419914 [debug] [MainThread]: On master: COMMIT
[0m01:14:20.420170 [debug] [MainThread]: Using duckdb connection "master"
[0m01:14:20.420405 [debug] [MainThread]: On master: COMMIT
[0m01:14:20.420810 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:14:20.421094 [debug] [MainThread]: On master: Close
[0m01:14:20.422818 [debug] [Thread-1 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m01:14:20.423238 [debug] [Thread-2 (]: Began running node model.medallion_dbt.stg_transactions
[0m01:14:20.423846 [info ] [Thread-1 (]: 1 of 2 START sql table model main.fct_customer_transactions .................... [RUN]
[0m01:14:20.424824 [info ] [Thread-2 (]: 2 of 2 START sql table model main.stg_transactions ............................. [RUN]
[0m01:14:20.425584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.fct_customer_transactions)
[0m01:14:20.426359 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.medallion_dbt.stg_transactions'
[0m01:14:20.427187 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.fct_customer_transactions
[0m01:14:20.427712 [debug] [Thread-2 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m01:14:20.435740 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.fct_customer_transactions"
[0m01:14:20.439432 [debug] [Thread-2 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m01:14:20.440106 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.fct_customer_transactions
[0m01:14:20.440535 [debug] [Thread-2 (]: Began executing node model.medallion_dbt.stg_transactions
[0m01:14:20.479949 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.fct_customer_transactions"
[0m01:14:20.482485 [debug] [Thread-2 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m01:14:20.483637 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m01:14:20.484086 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m01:14:20.484461 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: BEGIN
[0m01:14:20.484829 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m01:14:20.485147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:14:20.485466 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:14:20.486340 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m01:14:20.486649 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m01:14:20.486973 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:14:20.487318 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
    
    

    create  table
      "medallion"."main"."stg_transactions__dbt_tmp"
  
    as (
      




WITH src AS (

    SELECT *
    FROM read_parquet(
        '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean/transactions_20251207_clean.parquet'
    )

),

typed AS (

    SELECT
        CAST(transaction_id AS VARCHAR) AS transaction_id,
        CAST(customer_id AS VARCHAR) AS customer_id,
        CAST(amount AS DOUBLE) AS amount,
        LOWER(TRIM(status)) AS status,
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM src

),

final AS (

    SELECT
        transaction_id,
        customer_id,
        amount,
        status,
        transaction_ts,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed','pending','failed')

)

SELECT *
FROM final
    );
  
  
[0m01:14:20.487711 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m01:14:20.488220 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      -- models/silver/stg_transactions.sql
-- Modelo staging de transacciones. Toma el parquet limpio generado en Silver
-- y normaliza columnas seg√∫n lo definido en schema.yml.






WITH source_clean AS (
    SELECT *
    FROM read_parquet(
        clean_dir || '/transactions_' || ds_nodash || '_clean.parquet'
    )
),

typed AS (
    SELECT
        /* Clave primaria obligatoria */
        CAST(transaction_id AS VARCHAR) AS transaction_id,

        /* Relaci√≥n con clientes */
        CAST(customer_id AS VARCHAR) AS customer_id,

        /* Montos: el schema.yml exige non_negative */
        CAST(amount AS DOUBLE) AS amount,

        /* Normalizaci√≥n del estado */
        LOWER(TRIM(status)) AS status,

        /* Timestamp obligatorio */
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM source_clean
),

validated AS (
    SELECT
        *,
        /* Campo derivado obligatorio seg√∫n schema.yml */
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed', 'pending', 'failed')
)

SELECT *
FROM validated
    );
  
  
[0m01:14:20.488768 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
    
    

    create  table
      "medallion"."main"."stg_transactions__dbt_tmp"
  
    as (
      




WITH src AS (

    SELECT *
    FROM read_parquet(
        '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean/transactions_20251207_clean.parquet'
    )

),

typed AS (

    SELECT
        CAST(transaction_id AS VARCHAR) AS transaction_id,
        CAST(customer_id AS VARCHAR) AS customer_id,
        CAST(amount AS DOUBLE) AS amount,
        LOWER(TRIM(status)) AS status,
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM src

),

final AS (

    SELECT
        transaction_id,
        customer_id,
        amount,
        status,
        transaction_ts,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed','pending','failed')

)

SELECT *
FROM final
    );
  
  
[0m01:14:20.489201 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      -- models/silver/stg_transactions.sql
-- Modelo staging de transacciones. Toma el parquet limpio generado en Silver
-- y normaliza columnas seg√∫n lo definido en schema.yml.






WITH source_clean AS (
    SELECT *
    FROM read_parquet(
        clean_dir || '/transactions_' || ds_nodash || '_clean.parquet'
    )
),

typed AS (
    SELECT
        /* Clave primaria obligatoria */
        CAST(transaction_id AS VARCHAR) AS transaction_id,

        /* Relaci√≥n con clientes */
        CAST(customer_id AS VARCHAR) AS customer_id,

        /* Montos: el schema.yml exige non_negative */
        CAST(amount AS DOUBLE) AS amount,

        /* Normalizaci√≥n del estado */
        LOWER(TRIM(status)) AS status,

        /* Timestamp obligatorio */
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM source_clean
),

validated AS (
    SELECT
        *,
        /* Campo derivado obligatorio seg√∫n schema.yml */
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed', 'pending', 'failed')
)

SELECT *
FROM validated
    );
  
  
[0m01:14:20.489590 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m01:14:20.489905 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:14:20.490331 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m01:14:20.490847 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: ROLLBACK
[0m01:14:20.494810 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.fct_customer_transactions'
[0m01:14:20.495661 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: Close
[0m01:14:20.496353 [debug] [Thread-2 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m01:14:20.496784 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: Close
[0m01:14:20.497735 [debug] [Thread-1 (]: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  IO Error: No files found that match the pattern "clean_dir/transactions_ds_nodash_clean.parquet"
  
  LINE 22:     FROM read_parquet(
                    ^
[0m01:14:20.499257 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd91c9ae8-bbbc-4dd3-a24f-2201e9d1eeab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a61b175de0>]}
[0m01:14:20.500176 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model main.fct_customer_transactions ........... [[31mERROR[0m in 0.07s]
[0m01:14:20.500801 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m01:14:20.501348 [debug] [Thread-2 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Binder Error: Column "transaction_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m01:14:20.501934 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.fct_customer_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  IO Error: No files found that match the pattern "clean_dir/transactions_ds_nodash_clean.parquet"
  
  LINE 22:     FROM read_parquet(
                    ^.
[0m01:14:20.502431 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd91c9ae8-bbbc-4dd3-a24f-2201e9d1eeab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a61a12d690>]}
[0m01:14:20.503735 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model main.stg_transactions .................... [[31mERROR[0m in 0.08s]
[0m01:14:20.504406 [debug] [Thread-2 (]: Finished running node model.medallion_dbt.stg_transactions
[0m01:14:20.504942 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Binder Error: Column "transaction_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined.
[0m01:14:20.505932 [debug] [MainThread]: Using duckdb connection "master"
[0m01:14:20.506218 [debug] [MainThread]: On master: BEGIN
[0m01:14:20.506482 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:14:20.507212 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:14:20.507616 [debug] [MainThread]: On master: COMMIT
[0m01:14:20.508044 [debug] [MainThread]: Using duckdb connection "master"
[0m01:14:20.508481 [debug] [MainThread]: On master: COMMIT
[0m01:14:20.509250 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:14:20.509558 [debug] [MainThread]: On master: Close
[0m01:14:20.509962 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:14:20.510243 [debug] [MainThread]: Connection 'model.medallion_dbt.fct_customer_transactions' was properly closed.
[0m01:14:20.510497 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m01:14:20.510960 [info ] [MainThread]: 
[0m01:14:20.511327 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m01:14:20.512008 [debug] [MainThread]: Command end result
[0m01:14:20.531557 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m01:14:20.533845 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m01:14:20.539002 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m01:14:20.539332 [info ] [MainThread]: 
[0m01:14:20.539695 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m01:14:20.540003 [info ] [MainThread]: 
[0m01:14:20.540323 [error] [MainThread]: [31mFailure in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)[0m
[0m01:14:20.540655 [error] [MainThread]:   Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  IO Error: No files found that match the pattern "clean_dir/transactions_ds_nodash_clean.parquet"
  
  LINE 22:     FROM read_parquet(
                    ^
[0m01:14:20.540908 [info ] [MainThread]: 
[0m01:14:20.541220 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/fct_customer_transactions.sql
[0m01:14:20.541573 [info ] [MainThread]: 
[0m01:14:20.542068 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m01:14:20.542473 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Binder Error: Column "transaction_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m01:14:20.542734 [info ] [MainThread]: 
[0m01:14:20.543093 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m01:14:20.543393 [info ] [MainThread]: 
[0m01:14:20.543792 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=2
[0m01:14:20.545184 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.91312844, "process_in_blocks": "0", "process_kernel_time": 0.112008, "process_mem_max_rss": "152972", "process_out_blocks": "2224", "process_user_time": 1.949144}
[0m01:14:20.546052 [debug] [MainThread]: Command `dbt run` failed at 01:14:20.545889 after 0.91 seconds
[0m01:14:20.546536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a61af65390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a61e05fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a61c904190>]}
[0m01:14:20.547081 [debug] [MainThread]: Flushing usage events
[0m01:14:21.664364 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:27:05.597238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adcf598d420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adcf495c2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adcf495c250>]}


============================== 13:27:05.600344 | 4394444f-1b74-4d63-af7c-228540c46ed5 ==============================
[0m13:27:05.600344 [info ] [MainThread]: Running with dbt=1.10.15
[0m13:27:05.600898 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/logs', 'empty': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'debug': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'version_check': 'True', 'use_colors': 'True', 'quiet': 'False', 'profiles_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles', 'invocation_command': 'dbt run --profiles-dir /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles --vars {"ds": "20251201", "clean_dir": "/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean"}', 'warn_error': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'introspect': 'True', 'target_path': 'None', 'fail_fast': 'False'}
[0m13:27:05.834384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4394444f-1b74-4d63-af7c-228540c46ed5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adcf5888f10>]}
[0m13:27:05.885465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4394444f-1b74-4d63-af7c-228540c46ed5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adcf51ffbe0>]}
[0m13:27:05.887921 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:27:05.958677 [debug] [MainThread]: checksum: 3dc6842b86669272c6e63b6075d79e6b75ca3cfddd92981952adcb8b3d722937, vars: {'clean_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean',
 'ds': '20251201'}, profile: , target: , version: 1.10.15
[0m13:27:06.043120 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:27:06.043563 [debug] [MainThread]: previous checksum: 3dc6842b86669272c6e63b6075d79e6b75ca3cfddd92981952adcb8b3d722937, current checksum: 505cc0738468dbf8af23784e25e0465f2f41e62e9895701049268b92bd4ad565
[0m13:27:06.043865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4394444f-1b74-4d63-af7c-228540c46ed5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adcf5199de0>]}
[0m13:27:07.021187 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m13:27:07.021677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4394444f-1b74-4d63-af7c-228540c46ed5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adce77a1810>]}
[0m13:27:07.095677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4394444f-1b74-4d63-af7c-228540c46ed5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adce7640130>]}
[0m13:27:07.225671 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m13:27:07.227798 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m13:27:07.241687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4394444f-1b74-4d63-af7c-228540c46ed5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adce76428c0>]}
[0m13:27:07.242362 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m13:27:07.242699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4394444f-1b74-4d63-af7c-228540c46ed5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adce7614d00>]}
[0m13:27:07.244042 [info ] [MainThread]: 
[0m13:27:07.244388 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:27:07.244655 [info ] [MainThread]: 
[0m13:27:07.245049 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:27:07.249646 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m13:27:07.276301 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m13:27:07.276729 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m13:27:07.277025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:07.293475 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m13:27:07.294660 [debug] [ThreadPool]: On list_medallion: Close
[0m13:27:07.295365 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m13:27:07.295912 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m13:27:07.302027 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:27:07.302469 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m13:27:07.302745 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:27:07.303817 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:27:07.304863 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:27:07.305156 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m13:27:07.305604 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:27:07.305883 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:27:07.306165 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m13:27:07.306664 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:27:07.307307 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m13:27:07.307595 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:27:07.307845 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m13:27:07.308223 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:27:07.308490 [debug] [ThreadPool]: On create_medallion_main: Close
[0m13:27:07.309494 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m13:27:07.314624 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m13:27:07.314984 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m13:27:07.315298 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:27:07.315944 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:27:07.316253 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m13:27:07.316544 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m13:27:07.326768 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m13:27:07.327914 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m13:27:07.328696 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m13:27:07.328997 [debug] [ThreadPool]: On list_medallion_main: Close
[0m13:27:07.329657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4394444f-1b74-4d63-af7c-228540c46ed5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adce7708850>]}
[0m13:27:07.330155 [debug] [MainThread]: Using duckdb connection "master"
[0m13:27:07.330468 [debug] [MainThread]: On master: BEGIN
[0m13:27:07.330729 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:27:07.331318 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:27:07.331611 [debug] [MainThread]: On master: COMMIT
[0m13:27:07.331877 [debug] [MainThread]: Using duckdb connection "master"
[0m13:27:07.332163 [debug] [MainThread]: On master: COMMIT
[0m13:27:07.332775 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:27:07.333037 [debug] [MainThread]: On master: Close
[0m13:27:07.336765 [debug] [Thread-1 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m13:27:07.337365 [debug] [Thread-2 (]: Began running node model.medallion_dbt.stg_transactions
[0m13:27:07.337942 [info ] [Thread-1 (]: 1 of 2 START sql table model main.fct_customer_transactions .................... [RUN]
[0m13:27:07.338561 [info ] [Thread-2 (]: 2 of 2 START sql table model main.stg_transactions ............................. [RUN]
[0m13:27:07.339388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.fct_customer_transactions)
[0m13:27:07.339929 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.medallion_dbt.stg_transactions'
[0m13:27:07.340335 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.fct_customer_transactions
[0m13:27:07.340716 [debug] [Thread-2 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m13:27:07.347902 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.fct_customer_transactions"
[0m13:27:07.350951 [debug] [Thread-2 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m13:27:07.351640 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.fct_customer_transactions
[0m13:27:07.351995 [debug] [Thread-2 (]: Began executing node model.medallion_dbt.stg_transactions
[0m13:27:07.381937 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.fct_customer_transactions"
[0m13:27:07.385081 [debug] [Thread-2 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m13:27:07.386192 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:27:07.386617 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m13:27:07.387014 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m13:27:07.387364 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: BEGIN
[0m13:27:07.387708 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:27:07.388061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:07.389004 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:27:07.389359 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:27:07.389652 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:27:07.389973 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
    
    

    create  table
      "medallion"."main"."stg_transactions__dbt_tmp"
  
    as (
      




WITH src AS (

    SELECT *
    FROM read_parquet(
        '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean/transactions_20251201_clean.parquet'
    )

),

typed AS (

    SELECT
        CAST(transaction_id AS VARCHAR) AS transaction_id,
        CAST(customer_id AS VARCHAR) AS customer_id,
        CAST(amount AS DOUBLE) AS amount,
        LOWER(TRIM(status)) AS status,
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM src

),

final AS (

    SELECT
        transaction_id,
        customer_id,
        amount,
        status,
        transaction_ts,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed','pending','failed')

)

SELECT *
FROM final
    );
  
  
[0m13:27:07.390312 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m13:27:07.390872 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      -- models/silver/stg_transactions.sql
-- Modelo staging de transacciones. Toma el parquet limpio generado en Silver
-- y normaliza columnas seg√∫n lo definido en schema.yml.






WITH source_clean AS (
    SELECT *
    FROM read_parquet(
        clean_dir || '/transactions_' || ds_nodash || '_clean.parquet'
    )
),

typed AS (
    SELECT
        /* Clave primaria obligatoria */
        CAST(transaction_id AS VARCHAR) AS transaction_id,

        /* Relaci√≥n con clientes */
        CAST(customer_id AS VARCHAR) AS customer_id,

        /* Montos: el schema.yml exige non_negative */
        CAST(amount AS DOUBLE) AS amount,

        /* Normalizaci√≥n del estado */
        LOWER(TRIM(status)) AS status,

        /* Timestamp obligatorio */
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM source_clean
),

validated AS (
    SELECT
        *,
        /* Campo derivado obligatorio seg√∫n schema.yml */
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed', 'pending', 'failed')
)

SELECT *
FROM validated
    );
  
  
[0m13:27:07.398433 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m13:27:07.399419 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      -- models/silver/stg_transactions.sql
-- Modelo staging de transacciones. Toma el parquet limpio generado en Silver
-- y normaliza columnas seg√∫n lo definido en schema.yml.






WITH source_clean AS (
    SELECT *
    FROM read_parquet(
        clean_dir || '/transactions_' || ds_nodash || '_clean.parquet'
    )
),

typed AS (
    SELECT
        /* Clave primaria obligatoria */
        CAST(transaction_id AS VARCHAR) AS transaction_id,

        /* Relaci√≥n con clientes */
        CAST(customer_id AS VARCHAR) AS customer_id,

        /* Montos: el schema.yml exige non_negative */
        CAST(amount AS DOUBLE) AS amount,

        /* Normalizaci√≥n del estado */
        LOWER(TRIM(status)) AS status,

        /* Timestamp obligatorio */
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM source_clean
),

validated AS (
    SELECT
        *,
        /* Campo derivado obligatorio seg√∫n schema.yml */
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed', 'pending', 'failed')
)

SELECT *
FROM validated
    );
  
  
[0m13:27:07.405543 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:27:07.406009 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:27:07.406411 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */
alter table "medallion"."main"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m13:27:07.406928 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: ROLLBACK
[0m13:27:07.407950 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:27:07.418623 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m13:27:07.419181 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:27:07.419710 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m13:27:07.421714 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:27:07.426230 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:27:07.426607 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

      drop table if exists "medallion"."main"."stg_transactions__dbt_backup" cascade
    
[0m13:27:07.427390 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m13:27:07.429947 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: Close
[0m13:27:07.431813 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.fct_customer_transactions'
[0m13:27:07.432159 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: Close
[0m13:27:07.432498 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4394444f-1b74-4d63-af7c-228540c46ed5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adcf7371330>]}
[0m13:27:07.433154 [info ] [Thread-2 (]: 2 of 2 OK created sql table model main.stg_transactions ........................ [[32mOK[0m in 0.09s]
[0m13:27:07.433939 [debug] [Thread-2 (]: Finished running node model.medallion_dbt.stg_transactions
[0m13:27:07.434913 [debug] [Thread-1 (]: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  IO Error: No files found that match the pattern "clean_dir/transactions_ds_nodash_clean.parquet"
  
  LINE 22:     FROM read_parquet(
                    ^
[0m13:27:07.435639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4394444f-1b74-4d63-af7c-228540c46ed5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adceca69000>]}
[0m13:27:07.436283 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model main.fct_customer_transactions ........... [[31mERROR[0m in 0.10s]
[0m13:27:07.436784 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m13:27:07.437409 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.fct_customer_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  IO Error: No files found that match the pattern "clean_dir/transactions_ds_nodash_clean.parquet"
  
  LINE 22:     FROM read_parquet(
                    ^.
[0m13:27:07.438950 [debug] [MainThread]: Using duckdb connection "master"
[0m13:27:07.439279 [debug] [MainThread]: On master: BEGIN
[0m13:27:07.439542 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:27:07.440171 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:27:07.440445 [debug] [MainThread]: On master: COMMIT
[0m13:27:07.440698 [debug] [MainThread]: Using duckdb connection "master"
[0m13:27:07.440941 [debug] [MainThread]: On master: COMMIT
[0m13:27:07.441589 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:27:07.441981 [debug] [MainThread]: On master: Close
[0m13:27:07.442399 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:27:07.442654 [debug] [MainThread]: Connection 'model.medallion_dbt.fct_customer_transactions' was properly closed.
[0m13:27:07.442885 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m13:27:07.443310 [info ] [MainThread]: 
[0m13:27:07.443651 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m13:27:07.444324 [debug] [MainThread]: Command end result
[0m13:27:07.464494 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m13:27:07.466081 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m13:27:07.471953 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m13:27:07.472346 [info ] [MainThread]: 
[0m13:27:07.472750 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:27:07.473104 [info ] [MainThread]: 
[0m13:27:07.473444 [error] [MainThread]: [31mFailure in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)[0m
[0m13:27:07.473745 [error] [MainThread]:   Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  IO Error: No files found that match the pattern "clean_dir/transactions_ds_nodash_clean.parquet"
  
  LINE 22:     FROM read_parquet(
                    ^
[0m13:27:07.474045 [info ] [MainThread]: 
[0m13:27:07.474389 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/fct_customer_transactions.sql
[0m13:27:07.474644 [info ] [MainThread]: 
[0m13:27:07.474915 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m13:27:07.475330 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:27:07.476034 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.9297787, "process_in_blocks": "105872", "process_kernel_time": 0.116498, "process_mem_max_rss": "157756", "process_out_blocks": "3256", "process_user_time": 2.842152}
[0m13:27:07.476631 [debug] [MainThread]: Command `dbt run` failed at 13:27:07.476534 after 1.93 seconds
[0m13:27:07.477015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adcf598d420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adcf7562890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adcf5a04c40>]}
[0m13:27:07.477369 [debug] [MainThread]: Flushing usage events
[0m13:27:08.276944 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:28:10.595529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f7f3a9d3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f7f2a60280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f7f2a60220>]}


============================== 13:28:10.597748 | a0ab8fe4-c7b4-481a-80c1-d209330e45f9 ==============================
[0m13:28:10.597748 [info ] [MainThread]: Running with dbt=1.10.15
[0m13:28:10.598188 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'fail_fast': 'False', 'invocation_command': 'dbt run --profiles-dir /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles --vars {"ds": "20251201", "clean_dir": "/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean"}', 'indirect_selection': 'eager', 'profiles_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'no_print': 'None', 'use_colors': 'True', 'debug': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'target_path': 'None', 'write_json': 'True', 'printer_width': '80', 'quiet': 'False', 'partial_parse': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'log_path': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/logs'}
[0m13:28:10.778118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0ab8fe4-c7b4-481a-80c1-d209330e45f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f7f3b13190>]}
[0m13:28:10.830153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0ab8fe4-c7b4-481a-80c1-d209330e45f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f7f324a740>]}
[0m13:28:10.832029 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:28:10.897248 [debug] [MainThread]: checksum: 3dc6842b86669272c6e63b6075d79e6b75ca3cfddd92981952adcb8b3d722937, vars: {'clean_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean',
 'ds': '20251201'}, profile: , target: , version: 1.10.15
[0m13:28:10.997490 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:28:10.998832 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:28:11.038390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0ab8fe4-c7b4-481a-80c1-d209330e45f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f7ea90c130>]}
[0m13:28:11.160889 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m13:28:11.163089 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m13:28:11.173088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0ab8fe4-c7b4-481a-80c1-d209330e45f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f7ea932ce0>]}
[0m13:28:11.173586 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m13:28:11.173976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0ab8fe4-c7b4-481a-80c1-d209330e45f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f7ea932c80>]}
[0m13:28:11.175924 [info ] [MainThread]: 
[0m13:28:11.176465 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:28:11.176851 [info ] [MainThread]: 
[0m13:28:11.177653 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:28:11.183059 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m13:28:11.214785 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m13:28:11.215331 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m13:28:11.215631 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:11.226755 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m13:28:11.227966 [debug] [ThreadPool]: On list_medallion: Close
[0m13:28:11.228664 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m13:28:11.229332 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m13:28:11.236795 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:28:11.237222 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m13:28:11.237514 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:28:11.238632 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:28:11.239669 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:28:11.240038 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m13:28:11.240633 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:28:11.240966 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:28:11.241260 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m13:28:11.241738 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:28:11.242608 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m13:28:11.242915 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:28:11.243176 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m13:28:11.243595 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:28:11.243869 [debug] [ThreadPool]: On create_medallion_main: Close
[0m13:28:11.244973 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m13:28:11.249494 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m13:28:11.249881 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m13:28:11.250224 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:28:11.251256 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:28:11.251612 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m13:28:11.251910 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m13:28:11.261382 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m13:28:11.262778 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m13:28:11.263283 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m13:28:11.263573 [debug] [ThreadPool]: On list_medallion_main: Close
[0m13:28:11.264327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0ab8fe4-c7b4-481a-80c1-d209330e45f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f7f2966410>]}
[0m13:28:11.264802 [debug] [MainThread]: Using duckdb connection "master"
[0m13:28:11.265091 [debug] [MainThread]: On master: BEGIN
[0m13:28:11.265340 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:28:11.266018 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:28:11.266302 [debug] [MainThread]: On master: COMMIT
[0m13:28:11.266568 [debug] [MainThread]: Using duckdb connection "master"
[0m13:28:11.266890 [debug] [MainThread]: On master: COMMIT
[0m13:28:11.267747 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:28:11.268050 [debug] [MainThread]: On master: Close
[0m13:28:11.270409 [debug] [Thread-1 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m13:28:11.270853 [debug] [Thread-2 (]: Began running node model.medallion_dbt.stg_transactions
[0m13:28:11.271403 [info ] [Thread-1 (]: 1 of 2 START sql table model main.fct_customer_transactions .................... [RUN]
[0m13:28:11.271990 [info ] [Thread-2 (]: 2 of 2 START sql table model main.stg_transactions ............................. [RUN]
[0m13:28:11.272484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.fct_customer_transactions)
[0m13:28:11.272976 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.medallion_dbt.stg_transactions'
[0m13:28:11.273324 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.fct_customer_transactions
[0m13:28:11.273692 [debug] [Thread-2 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m13:28:11.280865 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.fct_customer_transactions"
[0m13:28:11.285146 [debug] [Thread-2 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m13:28:11.285921 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.fct_customer_transactions
[0m13:28:11.286386 [debug] [Thread-2 (]: Began executing node model.medallion_dbt.stg_transactions
[0m13:28:11.312419 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.fct_customer_transactions"
[0m13:28:11.315247 [debug] [Thread-2 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m13:28:11.315972 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m13:28:11.316408 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:28:11.316777 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: BEGIN
[0m13:28:11.317120 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m13:28:11.317462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:11.317774 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:28:11.318825 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:28:11.319179 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m13:28:11.319582 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:28:11.320096 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      -- models/silver/stg_transactions.sql
-- Modelo staging de transacciones. Toma el parquet limpio generado en Silver
-- y normaliza columnas seg√∫n lo definido en schema.yml.






WITH source_clean AS (
    SELECT *
    FROM read_parquet(
        clean_dir || '/transactions_' || ds_nodash || '_clean.parquet'
    )
),

typed AS (
    SELECT
        /* Clave primaria obligatoria */
        CAST(transaction_id AS VARCHAR) AS transaction_id,

        /* Relaci√≥n con clientes */
        CAST(customer_id AS VARCHAR) AS customer_id,

        /* Montos: el schema.yml exige non_negative */
        CAST(amount AS DOUBLE) AS amount,

        /* Normalizaci√≥n del estado */
        LOWER(TRIM(status)) AS status,

        /* Timestamp obligatorio */
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM source_clean
),

validated AS (
    SELECT
        *,
        /* Campo derivado obligatorio seg√∫n schema.yml */
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed', 'pending', 'failed')
)

SELECT *
FROM validated
    );
  
  
[0m13:28:11.320463 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:28:11.321039 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
    
    

    create  table
      "medallion"."main"."stg_transactions__dbt_tmp"
  
    as (
      




WITH src AS (

    SELECT *
    FROM read_parquet(
        '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean/transactions_20251201_clean.parquet'
    )

),

typed AS (

    SELECT
        CAST(transaction_id AS VARCHAR) AS transaction_id,
        CAST(customer_id AS VARCHAR) AS customer_id,
        CAST(amount AS DOUBLE) AS amount,
        LOWER(TRIM(status)) AS status,
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM src

),

final AS (

    SELECT
        transaction_id,
        customer_id,
        amount,
        status,
        transaction_ts,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed','pending','failed')

)

SELECT *
FROM final
    );
  
  
[0m13:28:11.321529 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      -- models/silver/stg_transactions.sql
-- Modelo staging de transacciones. Toma el parquet limpio generado en Silver
-- y normaliza columnas seg√∫n lo definido en schema.yml.






WITH source_clean AS (
    SELECT *
    FROM read_parquet(
        clean_dir || '/transactions_' || ds_nodash || '_clean.parquet'
    )
),

typed AS (
    SELECT
        /* Clave primaria obligatoria */
        CAST(transaction_id AS VARCHAR) AS transaction_id,

        /* Relaci√≥n con clientes */
        CAST(customer_id AS VARCHAR) AS customer_id,

        /* Montos: el schema.yml exige non_negative */
        CAST(amount AS DOUBLE) AS amount,

        /* Normalizaci√≥n del estado */
        LOWER(TRIM(status)) AS status,

        /* Timestamp obligatorio */
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM source_clean
),

validated AS (
    SELECT
        *,
        /* Campo derivado obligatorio seg√∫n schema.yml */
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed', 'pending', 'failed')
)

SELECT *
FROM validated
    );
  
  
[0m13:28:11.322047 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:28:11.322487 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: ROLLBACK
[0m13:28:11.323585 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:28:11.327896 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:28:11.328360 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_transactions'
  
[0m13:28:11.329184 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.fct_customer_transactions'
[0m13:28:11.329536 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: Close
[0m13:28:11.329872 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:28:11.331136 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:28:11.331801 [debug] [Thread-1 (]: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  IO Error: No files found that match the pattern "clean_dir/transactions_ds_nodash_clean.parquet"
  
  LINE 22:     FROM read_parquet(
                    ^
[0m13:28:11.332184 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_transactions'
  
[0m13:28:11.333844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0ab8fe4-c7b4-481a-80c1-d209330e45f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f7f2a12830>]}
[0m13:28:11.334734 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model main.fct_customer_transactions ........... [[31mERROR[0m in 0.06s]
[0m13:28:11.335213 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:28:11.335782 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m13:28:11.336488 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.fct_customer_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  IO Error: No files found that match the pattern "clean_dir/transactions_ds_nodash_clean.parquet"
  
  LINE 22:     FROM read_parquet(
                    ^.
[0m13:28:11.342758 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:28:11.343193 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */
alter table "medallion"."main"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m13:28:11.343966 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m13:28:11.346330 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:28:11.346659 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */
alter table "medallion"."main"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m13:28:11.347229 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m13:28:11.359231 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m13:28:11.359695 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:28:11.360034 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m13:28:11.361513 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:28:11.365883 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:28:11.366284 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

      drop table if exists "medallion"."main"."stg_transactions__dbt_backup" cascade
    
[0m13:28:11.367865 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:28:11.369970 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: Close
[0m13:28:11.370537 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0ab8fe4-c7b4-481a-80c1-d209330e45f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f7f54b9300>]}
[0m13:28:11.371098 [info ] [Thread-2 (]: 2 of 2 OK created sql table model main.stg_transactions ........................ [[32mOK[0m in 0.10s]
[0m13:28:11.371565 [debug] [Thread-2 (]: Finished running node model.medallion_dbt.stg_transactions
[0m13:28:11.372550 [debug] [MainThread]: Using duckdb connection "master"
[0m13:28:11.372874 [debug] [MainThread]: On master: BEGIN
[0m13:28:11.373138 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:28:11.373730 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:28:11.373996 [debug] [MainThread]: On master: COMMIT
[0m13:28:11.374298 [debug] [MainThread]: Using duckdb connection "master"
[0m13:28:11.374538 [debug] [MainThread]: On master: COMMIT
[0m13:28:11.375041 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:28:11.375321 [debug] [MainThread]: On master: Close
[0m13:28:11.375656 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:28:11.375898 [debug] [MainThread]: Connection 'model.medallion_dbt.fct_customer_transactions' was properly closed.
[0m13:28:11.376135 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m13:28:11.376483 [info ] [MainThread]: 
[0m13:28:11.376775 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m13:28:11.377472 [debug] [MainThread]: Command end result
[0m13:28:11.396142 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m13:28:11.397734 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m13:28:11.403725 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m13:28:11.404116 [info ] [MainThread]: 
[0m13:28:11.404453 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:28:11.404747 [info ] [MainThread]: 
[0m13:28:11.405058 [error] [MainThread]: [31mFailure in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)[0m
[0m13:28:11.405369 [error] [MainThread]:   Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  IO Error: No files found that match the pattern "clean_dir/transactions_ds_nodash_clean.parquet"
  
  LINE 22:     FROM read_parquet(
                    ^
[0m13:28:11.405608 [info ] [MainThread]: 
[0m13:28:11.405891 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/fct_customer_transactions.sql
[0m13:28:11.406180 [info ] [MainThread]: 
[0m13:28:11.406451 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m13:28:11.407174 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.859467, "process_in_blocks": "712", "process_kernel_time": 0.091052, "process_mem_max_rss": "154028", "process_out_blocks": "2240", "process_user_time": 1.861067}
[0m13:28:11.407681 [debug] [MainThread]: Command `dbt run` failed at 13:28:11.407600 after 0.86 seconds
[0m13:28:11.408009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f7f3a9d3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f7ea8fce80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f7ea8fc2b0>]}
[0m13:28:11.408377 [debug] [MainThread]: Flushing usage events
[0m13:28:12.112790 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:28:19.788429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddde63a13f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddde5364250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddde53641f0>]}


============================== 13:28:19.791531 | 7d1ea1fa-eee1-44d7-8116-1e5bd01958c9 ==============================
[0m13:28:19.791531 [info ] [MainThread]: Running with dbt=1.10.15
[0m13:28:19.792130 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'debug': 'False', 'introspect': 'True', 'empty': 'False', 'partial_parse': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'log_path': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/logs', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'quiet': 'False', 'no_print': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --profiles-dir /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles --vars {"ds": "20251207", "clean_dir": "/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean"}', 'log_cache_events': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'profiles_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles'}
[0m13:28:19.976662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d1ea1fa-eee1-44d7-8116-1e5bd01958c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddde6417190>]}
[0m13:28:20.027318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d1ea1fa-eee1-44d7-8116-1e5bd01958c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddde5362bc0>]}
[0m13:28:20.028783 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:28:20.092392 [debug] [MainThread]: checksum: 505cc0738468dbf8af23784e25e0465f2f41e62e9895701049268b92bd4ad565, vars: {'clean_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean',
 'ds': '20251207'}, profile: , target: , version: 1.10.15
[0m13:28:20.171605 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:28:20.172062 [debug] [MainThread]: previous checksum: 505cc0738468dbf8af23784e25e0465f2f41e62e9895701049268b92bd4ad565, current checksum: 3dc6842b86669272c6e63b6075d79e6b75ca3cfddd92981952adcb8b3d722937
[0m13:28:20.172391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7d1ea1fa-eee1-44d7-8116-1e5bd01958c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddde5bae590>]}
[0m13:28:21.143443 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m13:28:21.143946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7d1ea1fa-eee1-44d7-8116-1e5bd01958c9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddddc16ab30>]}
[0m13:28:21.215981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d1ea1fa-eee1-44d7-8116-1e5bd01958c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddddc054130>]}
[0m13:28:21.346123 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m13:28:21.347903 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m13:28:21.358148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d1ea1fa-eee1-44d7-8116-1e5bd01958c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddddc05b340>]}
[0m13:28:21.358923 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m13:28:21.359302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d1ea1fa-eee1-44d7-8116-1e5bd01958c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddddc0566b0>]}
[0m13:28:21.360659 [info ] [MainThread]: 
[0m13:28:21.360977 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:28:21.361242 [info ] [MainThread]: 
[0m13:28:21.361637 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:28:21.365669 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m13:28:21.390926 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m13:28:21.391369 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m13:28:21.391663 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:21.402708 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m13:28:21.403960 [debug] [ThreadPool]: On list_medallion: Close
[0m13:28:21.404698 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m13:28:21.405239 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m13:28:21.411183 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:28:21.411522 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m13:28:21.411780 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:28:21.412945 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:28:21.414055 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:28:21.414414 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m13:28:21.415043 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:28:21.415324 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:28:21.415584 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m13:28:21.416183 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:28:21.416870 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m13:28:21.417195 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:28:21.417452 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m13:28:21.417830 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:28:21.418109 [debug] [ThreadPool]: On create_medallion_main: Close
[0m13:28:21.419188 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m13:28:21.424179 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m13:28:21.424578 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m13:28:21.424842 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:28:21.425532 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:28:21.425836 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m13:28:21.426103 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m13:28:21.434894 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m13:28:21.436054 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m13:28:21.436544 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m13:28:21.436824 [debug] [ThreadPool]: On list_medallion_main: Close
[0m13:28:21.437627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d1ea1fa-eee1-44d7-8116-1e5bd01958c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddddc286b90>]}
[0m13:28:21.438084 [debug] [MainThread]: Using duckdb connection "master"
[0m13:28:21.438359 [debug] [MainThread]: On master: BEGIN
[0m13:28:21.438603 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:28:21.439137 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:28:21.439400 [debug] [MainThread]: On master: COMMIT
[0m13:28:21.439647 [debug] [MainThread]: Using duckdb connection "master"
[0m13:28:21.439894 [debug] [MainThread]: On master: COMMIT
[0m13:28:21.440322 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:28:21.440596 [debug] [MainThread]: On master: Close
[0m13:28:21.443861 [debug] [Thread-1 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m13:28:21.444387 [debug] [Thread-2 (]: Began running node model.medallion_dbt.stg_transactions
[0m13:28:21.444935 [info ] [Thread-1 (]: 1 of 2 START sql table model main.fct_customer_transactions .................... [RUN]
[0m13:28:21.445457 [info ] [Thread-2 (]: 2 of 2 START sql table model main.stg_transactions ............................. [RUN]
[0m13:28:21.445937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.fct_customer_transactions)
[0m13:28:21.446440 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.medallion_dbt.stg_transactions'
[0m13:28:21.446785 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.fct_customer_transactions
[0m13:28:21.447140 [debug] [Thread-2 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m13:28:21.454732 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.fct_customer_transactions"
[0m13:28:21.458279 [debug] [Thread-2 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m13:28:21.459163 [debug] [Thread-2 (]: Began executing node model.medallion_dbt.stg_transactions
[0m13:28:21.459542 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.fct_customer_transactions
[0m13:28:21.491910 [debug] [Thread-2 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m13:28:21.493992 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.fct_customer_transactions"
[0m13:28:21.495069 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m13:28:21.495609 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:28:21.496113 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: BEGIN
[0m13:28:21.496454 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m13:28:21.496840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:21.497284 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:28:21.498494 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:28:21.498886 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:28:21.499245 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:28:21.499615 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m13:28:21.499999 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
    
    

    create  table
      "medallion"."main"."stg_transactions__dbt_tmp"
  
    as (
      




WITH src AS (

    SELECT *
    FROM read_parquet(
        '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean/transactions_20251207_clean.parquet'
    )

),

typed AS (

    SELECT
        CAST(transaction_id AS VARCHAR) AS transaction_id,
        CAST(customer_id AS VARCHAR) AS customer_id,
        CAST(amount AS DOUBLE) AS amount,
        LOWER(TRIM(status)) AS status,
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM src

),

final AS (

    SELECT
        transaction_id,
        customer_id,
        amount,
        status,
        transaction_ts,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed','pending','failed')

)

SELECT *
FROM final
    );
  
  
[0m13:28:21.500390 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      -- models/silver/stg_transactions.sql
-- Modelo staging de transacciones. Toma el parquet limpio generado en Silver
-- y normaliza columnas seg√∫n lo definido en schema.yml.






WITH source_clean AS (
    SELECT *
    FROM read_parquet(
        clean_dir || '/transactions_' || ds_nodash || '_clean.parquet'
    )
),

typed AS (
    SELECT
        /* Clave primaria obligatoria */
        CAST(transaction_id AS VARCHAR) AS transaction_id,

        /* Relaci√≥n con clientes */
        CAST(customer_id AS VARCHAR) AS customer_id,

        /* Montos: el schema.yml exige non_negative */
        CAST(amount AS DOUBLE) AS amount,

        /* Normalizaci√≥n del estado */
        LOWER(TRIM(status)) AS status,

        /* Timestamp obligatorio */
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM source_clean
),

validated AS (
    SELECT
        *,
        /* Campo derivado obligatorio seg√∫n schema.yml */
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed', 'pending', 'failed')
)

SELECT *
FROM validated
    );
  
  
[0m13:28:21.501563 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      -- models/silver/stg_transactions.sql
-- Modelo staging de transacciones. Toma el parquet limpio generado en Silver
-- y normaliza columnas seg√∫n lo definido en schema.yml.






WITH source_clean AS (
    SELECT *
    FROM read_parquet(
        clean_dir || '/transactions_' || ds_nodash || '_clean.parquet'
    )
),

typed AS (
    SELECT
        /* Clave primaria obligatoria */
        CAST(transaction_id AS VARCHAR) AS transaction_id,

        /* Relaci√≥n con clientes */
        CAST(customer_id AS VARCHAR) AS customer_id,

        /* Montos: el schema.yml exige non_negative */
        CAST(amount AS DOUBLE) AS amount,

        /* Normalizaci√≥n del estado */
        LOWER(TRIM(status)) AS status,

        /* Timestamp obligatorio */
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM source_clean
),

validated AS (
    SELECT
        *,
        /* Campo derivado obligatorio seg√∫n schema.yml */
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed', 'pending', 'failed')
)

SELECT *
FROM validated
    );
  
  
[0m13:28:21.502027 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
    
    

    create  table
      "medallion"."main"."stg_transactions__dbt_tmp"
  
    as (
      




WITH src AS (

    SELECT *
    FROM read_parquet(
        '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean/transactions_20251207_clean.parquet'
    )

),

typed AS (

    SELECT
        CAST(transaction_id AS VARCHAR) AS transaction_id,
        CAST(customer_id AS VARCHAR) AS customer_id,
        CAST(amount AS DOUBLE) AS amount,
        LOWER(TRIM(status)) AS status,
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM src

),

final AS (

    SELECT
        transaction_id,
        customer_id,
        amount,
        status,
        transaction_ts,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed','pending','failed')

)

SELECT *
FROM final
    );
  
  
[0m13:28:21.502374 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:28:21.502713 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m13:28:21.503205 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: ROLLBACK
[0m13:28:21.503636 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m13:28:21.506013 [debug] [Thread-2 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m13:28:21.506563 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.fct_customer_transactions'
[0m13:28:21.506937 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: Close
[0m13:28:21.507357 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: Close
[0m13:28:21.508547 [debug] [Thread-1 (]: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  IO Error: No files found that match the pattern "clean_dir/transactions_ds_nodash_clean.parquet"
  
  LINE 22:     FROM read_parquet(
                    ^
[0m13:28:21.510284 [debug] [Thread-2 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Binder Error: Column "transaction_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m13:28:21.511022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d1ea1fa-eee1-44d7-8116-1e5bd01958c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddde667aa40>]}
[0m13:28:21.511400 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d1ea1fa-eee1-44d7-8116-1e5bd01958c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddddc23e6b0>]}
[0m13:28:21.512356 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model main.fct_customer_transactions ........... [[31mERROR[0m in 0.06s]
[0m13:28:21.513200 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model main.stg_transactions .................... [[31mERROR[0m in 0.06s]
[0m13:28:21.513828 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m13:28:21.514366 [debug] [Thread-2 (]: Finished running node model.medallion_dbt.stg_transactions
[0m13:28:21.514865 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.fct_customer_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  IO Error: No files found that match the pattern "clean_dir/transactions_ds_nodash_clean.parquet"
  
  LINE 22:     FROM read_parquet(
                    ^.
[0m13:28:21.515764 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Binder Error: Column "transaction_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined.
[0m13:28:21.516699 [debug] [MainThread]: Using duckdb connection "master"
[0m13:28:21.517021 [debug] [MainThread]: On master: BEGIN
[0m13:28:21.517359 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:28:21.518172 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:28:21.518454 [debug] [MainThread]: On master: COMMIT
[0m13:28:21.518739 [debug] [MainThread]: Using duckdb connection "master"
[0m13:28:21.519045 [debug] [MainThread]: On master: COMMIT
[0m13:28:21.519502 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:28:21.519770 [debug] [MainThread]: On master: Close
[0m13:28:21.520129 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:28:21.520379 [debug] [MainThread]: Connection 'model.medallion_dbt.fct_customer_transactions' was properly closed.
[0m13:28:21.520605 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m13:28:21.520899 [info ] [MainThread]: 
[0m13:28:21.521200 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m13:28:21.521813 [debug] [MainThread]: Command end result
[0m13:28:21.542104 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m13:28:21.543724 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m13:28:21.549108 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m13:28:21.549721 [info ] [MainThread]: 
[0m13:28:21.550161 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m13:28:21.550515 [info ] [MainThread]: 
[0m13:28:21.550904 [error] [MainThread]: [31mFailure in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)[0m
[0m13:28:21.551238 [error] [MainThread]:   Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  IO Error: No files found that match the pattern "clean_dir/transactions_ds_nodash_clean.parquet"
  
  LINE 22:     FROM read_parquet(
                    ^
[0m13:28:21.551497 [info ] [MainThread]: 
[0m13:28:21.551789 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/fct_customer_transactions.sql
[0m13:28:21.552041 [info ] [MainThread]: 
[0m13:28:21.552343 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m13:28:21.552648 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Binder Error: Column "transaction_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m13:28:21.552885 [info ] [MainThread]: 
[0m13:28:21.553232 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m13:28:21.553531 [info ] [MainThread]: 
[0m13:28:21.553807 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=2
[0m13:28:21.554229 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:28:21.554918 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.8189361, "process_in_blocks": "0", "process_kernel_time": 0.107749, "process_mem_max_rss": "157084", "process_out_blocks": "3240", "process_user_time": 2.836404}
[0m13:28:21.555337 [debug] [MainThread]: Command `dbt run` failed at 13:28:21.555259 after 1.82 seconds
[0m13:28:21.555663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddde63a13f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddde6417190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddddc3fe950>]}
[0m13:28:21.556044 [debug] [MainThread]: Flushing usage events
[0m13:28:22.343570 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:29:25.042045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e993695450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e9926602b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e992660250>]}


============================== 13:29:25.044695 | d7801fb4-e048-4de9-896c-cd6da9b8709c ==============================
[0m13:29:25.044695 [info ] [MainThread]: Running with dbt=1.10.15
[0m13:29:25.045240 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/logs', 'target_path': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'printer_width': '80', 'empty': 'False', 'profiles_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles', 'partial_parse': 'True', 'use_colors': 'True', 'quiet': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'invocation_command': 'dbt run --profiles-dir /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles --vars {"ds": "20251207", "clean_dir": "/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean"}', 'use_experimental_parser': 'False', 'no_print': 'None'}
[0m13:29:25.333789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7801fb4-e048-4de9-896c-cd6da9b8709c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e995079990>]}
[0m13:29:25.403602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7801fb4-e048-4de9-896c-cd6da9b8709c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e992ed7280>]}
[0m13:29:25.407531 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:29:25.474773 [debug] [MainThread]: checksum: 505cc0738468dbf8af23784e25e0465f2f41e62e9895701049268b92bd4ad565, vars: {'clean_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean',
 'ds': '20251207'}, profile: , target: , version: 1.10.15
[0m13:29:25.576561 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:29:25.582896 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:29:25.625341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7801fb4-e048-4de9-896c-cd6da9b8709c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e98a4fc130>]}
[0m13:29:25.787599 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m13:29:25.789991 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m13:29:25.802414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7801fb4-e048-4de9-896c-cd6da9b8709c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e98a5044c0>]}
[0m13:29:25.803037 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m13:29:25.803394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7801fb4-e048-4de9-896c-cd6da9b8709c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e98a505e40>]}
[0m13:29:25.804803 [info ] [MainThread]: 
[0m13:29:25.805134 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:29:25.805419 [info ] [MainThread]: 
[0m13:29:25.805837 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:29:25.810009 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m13:29:25.851931 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m13:29:25.852655 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m13:29:25.853175 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:29:25.867313 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m13:29:25.870243 [debug] [ThreadPool]: On list_medallion: Close
[0m13:29:25.871400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m13:29:25.871943 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m13:29:25.877429 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:29:25.877812 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m13:29:25.878084 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:29:25.881294 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m13:29:25.883487 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:29:25.884180 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m13:29:25.885175 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:29:25.885492 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:29:25.885812 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m13:29:25.886356 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:29:25.887101 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m13:29:25.887388 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:29:25.887631 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m13:29:25.888039 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:29:25.888361 [debug] [ThreadPool]: On create_medallion_main: Close
[0m13:29:25.889443 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m13:29:25.893866 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m13:29:25.894187 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m13:29:25.894442 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:29:25.895240 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:29:25.895668 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m13:29:25.895961 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m13:29:25.907608 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m13:29:25.909115 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m13:29:25.909657 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m13:29:25.909962 [debug] [ThreadPool]: On list_medallion_main: Close
[0m13:29:25.910684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7801fb4-e048-4de9-896c-cd6da9b8709c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e9926267d0>]}
[0m13:29:25.911121 [debug] [MainThread]: Using duckdb connection "master"
[0m13:29:25.911401 [debug] [MainThread]: On master: BEGIN
[0m13:29:25.911653 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:29:25.912254 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:29:25.912531 [debug] [MainThread]: On master: COMMIT
[0m13:29:25.912801 [debug] [MainThread]: Using duckdb connection "master"
[0m13:29:25.913057 [debug] [MainThread]: On master: COMMIT
[0m13:29:25.913718 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:29:25.914619 [debug] [MainThread]: On master: Close
[0m13:29:25.919004 [debug] [Thread-1 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m13:29:25.919727 [debug] [Thread-2 (]: Began running node model.medallion_dbt.stg_transactions
[0m13:29:25.920879 [info ] [Thread-1 (]: 1 of 2 START sql table model main.fct_customer_transactions .................... [RUN]
[0m13:29:25.921806 [info ] [Thread-2 (]: 2 of 2 START sql table model main.stg_transactions ............................. [RUN]
[0m13:29:25.922335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.fct_customer_transactions)
[0m13:29:25.922863 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.medallion_dbt.stg_transactions'
[0m13:29:25.923251 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.fct_customer_transactions
[0m13:29:25.923605 [debug] [Thread-2 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m13:29:25.932407 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.fct_customer_transactions"
[0m13:29:25.941369 [debug] [Thread-2 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m13:29:25.942724 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.fct_customer_transactions
[0m13:29:25.943461 [debug] [Thread-2 (]: Began executing node model.medallion_dbt.stg_transactions
[0m13:29:25.993220 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.fct_customer_transactions"
[0m13:29:25.996900 [debug] [Thread-2 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m13:29:25.998307 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m13:29:25.998948 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:29:25.999567 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: BEGIN
[0m13:29:26.000007 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m13:29:26.000407 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:29:26.000761 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:29:26.001903 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:29:26.002271 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m13:29:26.002608 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:29:26.003095 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      -- models/silver/stg_transactions.sql
-- Modelo staging de transacciones. Toma el parquet limpio generado en Silver
-- y normaliza columnas seg√∫n lo definido en schema.yml.






WITH source_clean AS (
    SELECT *
    FROM read_parquet(
        clean_dir || '/transactions_' || ds_nodash || '_clean.parquet'
    )
),

typed AS (
    SELECT
        /* Clave primaria obligatoria */
        CAST(transaction_id AS VARCHAR) AS transaction_id,

        /* Relaci√≥n con clientes */
        CAST(customer_id AS VARCHAR) AS customer_id,

        /* Montos: el schema.yml exige non_negative */
        CAST(amount AS DOUBLE) AS amount,

        /* Normalizaci√≥n del estado */
        LOWER(TRIM(status)) AS status,

        /* Timestamp obligatorio */
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM source_clean
),

validated AS (
    SELECT
        *,
        /* Campo derivado obligatorio seg√∫n schema.yml */
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed', 'pending', 'failed')
)

SELECT *
FROM validated
    );
  
  
[0m13:29:26.003560 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:29:26.004177 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
    
    

    create  table
      "medallion"."main"."stg_transactions__dbt_tmp"
  
    as (
      




WITH src AS (

    SELECT *
    FROM read_parquet(
        '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean/transactions_20251207_clean.parquet'
    )

),

typed AS (

    SELECT
        CAST(transaction_id AS VARCHAR) AS transaction_id,
        CAST(customer_id AS VARCHAR) AS customer_id,
        CAST(amount AS DOUBLE) AS amount,
        LOWER(TRIM(status)) AS status,
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM src

),

final AS (

    SELECT
        transaction_id,
        customer_id,
        amount,
        status,
        transaction_ts,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed','pending','failed')

)

SELECT *
FROM final
    );
  
  
[0m13:29:26.004872 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      -- models/silver/stg_transactions.sql
-- Modelo staging de transacciones. Toma el parquet limpio generado en Silver
-- y normaliza columnas seg√∫n lo definido en schema.yml.






WITH source_clean AS (
    SELECT *
    FROM read_parquet(
        clean_dir || '/transactions_' || ds_nodash || '_clean.parquet'
    )
),

typed AS (
    SELECT
        /* Clave primaria obligatoria */
        CAST(transaction_id AS VARCHAR) AS transaction_id,

        /* Relaci√≥n con clientes */
        CAST(customer_id AS VARCHAR) AS customer_id,

        /* Montos: el schema.yml exige non_negative */
        CAST(amount AS DOUBLE) AS amount,

        /* Normalizaci√≥n del estado */
        LOWER(TRIM(status)) AS status,

        /* Timestamp obligatorio */
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM source_clean
),

validated AS (
    SELECT
        *,
        /* Campo derivado obligatorio seg√∫n schema.yml */
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed', 'pending', 'failed')
)

SELECT *
FROM validated
    );
  
  
[0m13:29:26.005303 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
    
    

    create  table
      "medallion"."main"."stg_transactions__dbt_tmp"
  
    as (
      




WITH src AS (

    SELECT *
    FROM read_parquet(
        '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean/transactions_20251207_clean.parquet'
    )

),

typed AS (

    SELECT
        CAST(transaction_id AS VARCHAR) AS transaction_id,
        CAST(customer_id AS VARCHAR) AS customer_id,
        CAST(amount AS DOUBLE) AS amount,
        LOWER(TRIM(status)) AS status,
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM src

),

final AS (

    SELECT
        transaction_id,
        customer_id,
        amount,
        status,
        transaction_ts,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed','pending','failed')

)

SELECT *
FROM final
    );
  
  
[0m13:29:26.005732 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:29:26.006101 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m13:29:26.006559 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: ROLLBACK
[0m13:29:26.007038 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m13:29:26.009297 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.fct_customer_transactions'
[0m13:29:26.009754 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: Close
[0m13:29:26.010320 [debug] [Thread-2 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m13:29:26.010870 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: Close
[0m13:29:26.011692 [debug] [Thread-1 (]: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  IO Error: No files found that match the pattern "clean_dir/transactions_ds_nodash_clean.parquet"
  
  LINE 22:     FROM read_parquet(
                    ^
[0m13:29:26.013600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7801fb4-e048-4de9-896c-cd6da9b8709c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e9950d4160>]}
[0m13:29:26.014638 [debug] [Thread-2 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Binder Error: Column "transaction_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m13:29:26.015752 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model main.fct_customer_transactions ........... [[31mERROR[0m in 0.09s]
[0m13:29:26.016677 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7801fb4-e048-4de9-896c-cd6da9b8709c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e98a50c430>]}
[0m13:29:26.017262 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m13:29:26.018007 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model main.stg_transactions .................... [[31mERROR[0m in 0.09s]
[0m13:29:26.018769 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.fct_customer_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  IO Error: No files found that match the pattern "clean_dir/transactions_ds_nodash_clean.parquet"
  
  LINE 22:     FROM read_parquet(
                    ^.
[0m13:29:26.019453 [debug] [Thread-2 (]: Finished running node model.medallion_dbt.stg_transactions
[0m13:29:26.020599 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Binder Error: Column "transaction_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined.
[0m13:29:26.021956 [debug] [MainThread]: Using duckdb connection "master"
[0m13:29:26.022336 [debug] [MainThread]: On master: BEGIN
[0m13:29:26.022621 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:29:26.023333 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:29:26.023631 [debug] [MainThread]: On master: COMMIT
[0m13:29:26.023892 [debug] [MainThread]: Using duckdb connection "master"
[0m13:29:26.024140 [debug] [MainThread]: On master: COMMIT
[0m13:29:26.024695 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:29:26.024987 [debug] [MainThread]: On master: Close
[0m13:29:26.025374 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:29:26.025711 [debug] [MainThread]: Connection 'model.medallion_dbt.fct_customer_transactions' was properly closed.
[0m13:29:26.026072 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m13:29:26.026847 [info ] [MainThread]: 
[0m13:29:26.027408 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m13:29:26.028600 [debug] [MainThread]: Command end result
[0m13:29:26.050929 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m13:29:26.053346 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m13:29:26.058925 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m13:29:26.059286 [info ] [MainThread]: 
[0m13:29:26.059785 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m13:29:26.060612 [info ] [MainThread]: 
[0m13:29:26.061616 [error] [MainThread]: [31mFailure in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)[0m
[0m13:29:26.062387 [error] [MainThread]:   Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  IO Error: No files found that match the pattern "clean_dir/transactions_ds_nodash_clean.parquet"
  
  LINE 22:     FROM read_parquet(
                    ^
[0m13:29:26.062833 [info ] [MainThread]: 
[0m13:29:26.063341 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/fct_customer_transactions.sql
[0m13:29:26.063699 [info ] [MainThread]: 
[0m13:29:26.064121 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m13:29:26.064504 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Binder Error: Column "transaction_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m13:29:26.064951 [info ] [MainThread]: 
[0m13:29:26.065375 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m13:29:26.065738 [info ] [MainThread]: 
[0m13:29:26.066168 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=2
[0m13:29:26.066991 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0794322, "process_in_blocks": "0", "process_kernel_time": 0.120049, "process_mem_max_rss": "152316", "process_out_blocks": "2224", "process_user_time": 2.135872}
[0m13:29:26.067534 [debug] [MainThread]: Command `dbt run` failed at 13:29:26.067447 after 1.08 seconds
[0m13:29:26.068042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e993695450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e98a5258d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e98a5257b0>]}
[0m13:29:26.068622 [debug] [MainThread]: Flushing usage events
[0m13:29:26.756181 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:34:24.806516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fbe3095420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fbe20602b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fbe2060250>]}


============================== 13:34:24.815643 | 97d69087-4efc-4534-b169-9fae19dbff13 ==============================
[0m13:34:24.815643 [info ] [MainThread]: Running with dbt=1.10.15
[0m13:34:24.817430 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'target_path': 'None', 'printer_width': '80', 'introspect': 'True', 'use_colors': 'True', 'log_path': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/logs', 'cache_selected_only': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'debug': 'False', 'static_parser': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'invocation_command': 'dbt run --profiles-dir /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles --vars {"ds": "20251206", "clean_dir": "/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean"}', 'no_print': 'None', 'warn_error': 'None', 'profiles_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles'}
[0m13:34:25.091141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97d69087-4efc-4534-b169-9fae19dbff13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fbe2f90f10>]}
[0m13:34:25.168726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97d69087-4efc-4534-b169-9fae19dbff13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fbe290bbe0>]}
[0m13:34:25.170651 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:34:25.253593 [debug] [MainThread]: checksum: 5a0d0a0a49a7e85d4a833cb08f50826341053ce165b4334dfaae473f545daa2d, vars: {'clean_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean',
 'ds': '20251206'}, profile: , target: , version: 1.10.15
[0m13:34:25.359887 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:34:25.361150 [debug] [MainThread]: previous checksum: 5a0d0a0a49a7e85d4a833cb08f50826341053ce165b4334dfaae473f545daa2d, current checksum: 505cc0738468dbf8af23784e25e0465f2f41e62e9895701049268b92bd4ad565
[0m13:34:25.361694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '97d69087-4efc-4534-b169-9fae19dbff13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fbe28a5de0>]}
[0m13:34:26.590709 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m13:34:26.591460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '97d69087-4efc-4534-b169-9fae19dbff13', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fbd8ea8af0>]}
[0m13:34:26.692971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97d69087-4efc-4534-b169-9fae19dbff13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fbd8d44100>]}
[0m13:34:26.864792 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m13:34:26.867777 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m13:34:26.880072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97d69087-4efc-4534-b169-9fae19dbff13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fbd8d44d00>]}
[0m13:34:26.881194 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m13:34:26.881663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97d69087-4efc-4534-b169-9fae19dbff13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fbd8d46cb0>]}
[0m13:34:26.884151 [info ] [MainThread]: 
[0m13:34:26.884996 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:34:26.885499 [info ] [MainThread]: 
[0m13:34:26.886114 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:34:26.890426 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m13:34:26.931560 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m13:34:26.932440 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m13:34:26.932830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:34:26.947329 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m13:34:26.949469 [debug] [ThreadPool]: On list_medallion: Close
[0m13:34:26.950577 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m13:34:26.951247 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m13:34:26.959115 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:34:26.959620 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m13:34:26.959930 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:34:26.963791 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m13:34:26.967614 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:34:26.968559 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m13:34:26.970195 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:34:26.970599 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:34:26.970912 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m13:34:26.971500 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:34:26.972434 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m13:34:26.972740 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:34:26.972998 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m13:34:26.973434 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:34:26.973728 [debug] [ThreadPool]: On create_medallion_main: Close
[0m13:34:26.974808 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m13:34:26.981659 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m13:34:26.982433 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m13:34:26.982959 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:34:26.984449 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:34:26.985155 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m13:34:26.985589 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m13:34:26.996339 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m13:34:26.999366 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m13:34:27.000464 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m13:34:27.000824 [debug] [ThreadPool]: On list_medallion_main: Close
[0m13:34:27.001812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97d69087-4efc-4534-b169-9fae19dbff13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fbd8d38670>]}
[0m13:34:27.002398 [debug] [MainThread]: Using duckdb connection "master"
[0m13:34:27.002691 [debug] [MainThread]: On master: BEGIN
[0m13:34:27.002959 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:34:27.003855 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:34:27.004241 [debug] [MainThread]: On master: COMMIT
[0m13:34:27.004537 [debug] [MainThread]: Using duckdb connection "master"
[0m13:34:27.004815 [debug] [MainThread]: On master: COMMIT
[0m13:34:27.005306 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:34:27.005582 [debug] [MainThread]: On master: Close
[0m13:34:27.008049 [debug] [Thread-1 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m13:34:27.008439 [debug] [Thread-2 (]: Began running node model.medallion_dbt.stg_transactions
[0m13:34:27.009001 [info ] [Thread-1 (]: 1 of 2 START sql table model main.fct_customer_transactions .................... [RUN]
[0m13:34:27.009664 [info ] [Thread-2 (]: 2 of 2 START sql table model main.stg_transactions ............................. [RUN]
[0m13:34:27.010900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.fct_customer_transactions)
[0m13:34:27.012322 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.medallion_dbt.stg_transactions'
[0m13:34:27.012938 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.fct_customer_transactions
[0m13:34:27.013428 [debug] [Thread-2 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m13:34:27.022328 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.fct_customer_transactions"
[0m13:34:27.025865 [debug] [Thread-2 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m13:34:27.027406 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.fct_customer_transactions
[0m13:34:27.028698 [debug] [Thread-2 (]: Began executing node model.medallion_dbt.stg_transactions
[0m13:34:27.074550 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.fct_customer_transactions"
[0m13:34:27.075180 [debug] [Thread-2 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m13:34:27.076073 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m13:34:27.076580 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:34:27.078373 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m13:34:27.079046 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:34:27.077392 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: BEGIN
[0m13:34:27.080286 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:34:27.081367 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:34:27.081838 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:34:27.082212 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
    
    

    create  table
      "medallion"."main"."stg_transactions__dbt_tmp"
  
    as (
      




WITH src AS (

    SELECT *
    FROM read_parquet(
        '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean/transactions_20251206_clean.parquet'
    )

),

typed AS (

    SELECT
        CAST(transaction_id AS VARCHAR) AS transaction_id,
        CAST(customer_id AS VARCHAR) AS customer_id,
        CAST(amount AS DOUBLE) AS amount,
        LOWER(TRIM(status)) AS status,
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM src

),

final AS (

    SELECT
        transaction_id,
        customer_id,
        amount,
        status,
        transaction_ts,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed','pending','failed')

)

SELECT *
FROM final
    );
  
  
[0m13:34:27.082609 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:34:27.083350 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m13:34:27.083707 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      -- models/silver/stg_transactions.sql
-- Modelo staging de transacciones. Toma el parquet limpio generado en Silver
-- y normaliza columnas seg√∫n lo definido en schema.yml.






WITH source_clean AS (
    SELECT *
    FROM read_parquet(
        clean_dir || '/transactions_' || ds_nodash || '_clean.parquet'
    )
),

typed AS (
    SELECT
        /* Clave primaria obligatoria */
        CAST(transaction_id AS VARCHAR) AS transaction_id,

        /* Relaci√≥n con clientes */
        CAST(customer_id AS VARCHAR) AS customer_id,

        /* Montos: el schema.yml exige non_negative */
        CAST(amount AS DOUBLE) AS amount,

        /* Normalizaci√≥n del estado */
        LOWER(TRIM(status)) AS status,

        /* Timestamp obligatorio */
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM source_clean
),

validated AS (
    SELECT
        *,
        /* Campo derivado obligatorio seg√∫n schema.yml */
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed', 'pending', 'failed')
)

SELECT *
FROM validated
    );
  
  
[0m13:34:27.085845 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      -- models/silver/stg_transactions.sql
-- Modelo staging de transacciones. Toma el parquet limpio generado en Silver
-- y normaliza columnas seg√∫n lo definido en schema.yml.






WITH source_clean AS (
    SELECT *
    FROM read_parquet(
        clean_dir || '/transactions_' || ds_nodash || '_clean.parquet'
    )
),

typed AS (
    SELECT
        /* Clave primaria obligatoria */
        CAST(transaction_id AS VARCHAR) AS transaction_id,

        /* Relaci√≥n con clientes */
        CAST(customer_id AS VARCHAR) AS customer_id,

        /* Montos: el schema.yml exige non_negative */
        CAST(amount AS DOUBLE) AS amount,

        /* Normalizaci√≥n del estado */
        LOWER(TRIM(status)) AS status,

        /* Timestamp obligatorio */
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM source_clean
),

validated AS (
    SELECT
        *,
        /* Campo derivado obligatorio seg√∫n schema.yml */
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed', 'pending', 'failed')
)

SELECT *
FROM validated
    );
  
  
[0m13:34:27.086394 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:34:27.086890 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m13:34:27.087459 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: ROLLBACK
[0m13:34:27.091961 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:34:27.092508 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_transactions'
  
[0m13:34:27.095024 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:34:27.096805 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.fct_customer_transactions'
[0m13:34:27.099017 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:34:27.100116 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: Close
[0m13:34:27.100765 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_transactions'
  
[0m13:34:27.102758 [debug] [Thread-1 (]: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  IO Error: No files found that match the pattern "clean_dir/transactions_ds_nodash_clean.parquet"
  
  LINE 22:     FROM read_parquet(
                    ^
[0m13:34:27.105237 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m13:34:27.106051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97d69087-4efc-4534-b169-9fae19dbff13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fbe3372ec0>]}
[0m13:34:27.107035 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model main.fct_customer_transactions ........... [[31mERROR[0m in 0.09s]
[0m13:34:27.118055 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:34:27.119282 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m13:34:27.119767 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */
alter table "medallion"."main"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m13:34:27.120419 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.fct_customer_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  IO Error: No files found that match the pattern "clean_dir/transactions_ds_nodash_clean.parquet"
  
  LINE 22:     FROM read_parquet(
                    ^.
[0m13:34:27.121664 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:34:27.124276 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:34:27.124603 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */
alter table "medallion"."main"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m13:34:27.125306 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m13:34:27.143015 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m13:34:27.143692 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:34:27.144652 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m13:34:27.148292 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:34:27.161246 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:34:27.161728 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

      drop table if exists "medallion"."main"."stg_transactions__dbt_backup" cascade
    
[0m13:34:27.163148 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:34:27.165388 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: Close
[0m13:34:27.166073 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97d69087-4efc-4534-b169-9fae19dbff13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fbe4a55330>]}
[0m13:34:27.166669 [info ] [Thread-2 (]: 2 of 2 OK created sql table model main.stg_transactions ........................ [[32mOK[0m in 0.15s]
[0m13:34:27.167155 [debug] [Thread-2 (]: Finished running node model.medallion_dbt.stg_transactions
[0m13:34:27.169411 [debug] [MainThread]: Using duckdb connection "master"
[0m13:34:27.170194 [debug] [MainThread]: On master: BEGIN
[0m13:34:27.170783 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:34:27.172268 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:34:27.172651 [debug] [MainThread]: On master: COMMIT
[0m13:34:27.173132 [debug] [MainThread]: Using duckdb connection "master"
[0m13:34:27.173612 [debug] [MainThread]: On master: COMMIT
[0m13:34:27.174703 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:34:27.175126 [debug] [MainThread]: On master: Close
[0m13:34:27.175719 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:34:27.176013 [debug] [MainThread]: Connection 'model.medallion_dbt.fct_customer_transactions' was properly closed.
[0m13:34:27.176269 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m13:34:27.176886 [info ] [MainThread]: 
[0m13:34:27.177302 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m13:34:27.177983 [debug] [MainThread]: Command end result
[0m13:34:27.203017 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m13:34:27.207912 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m13:34:27.212946 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m13:34:27.213306 [info ] [MainThread]: 
[0m13:34:27.213632 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:34:27.213913 [info ] [MainThread]: 
[0m13:34:27.214251 [error] [MainThread]: [31mFailure in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)[0m
[0m13:34:27.214779 [error] [MainThread]:   Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  IO Error: No files found that match the pattern "clean_dir/transactions_ds_nodash_clean.parquet"
  
  LINE 22:     FROM read_parquet(
                    ^
[0m13:34:27.215274 [info ] [MainThread]: 
[0m13:34:27.216146 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/fct_customer_transactions.sql
[0m13:34:27.216686 [info ] [MainThread]: 
[0m13:34:27.217157 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m13:34:27.217867 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:34:27.219314 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.4743755, "process_in_blocks": "0", "process_kernel_time": 0.174418, "process_mem_max_rss": "159124", "process_out_blocks": "3272", "process_user_time": 3.839204}
[0m13:34:27.219977 [debug] [MainThread]: Command `dbt run` failed at 13:34:27.219818 after 2.48 seconds
[0m13:34:27.220569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fbe3095420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fbd8d38670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fbe2f92a70>]}
[0m13:34:27.221128 [debug] [MainThread]: Flushing usage events
[0m13:34:28.060863 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:35:30.933690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c60c0871450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c60bf8402b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c60bf840250>]}


============================== 13:35:30.936018 | 4fabc338-1880-494e-93af-a00e9f1a6ae1 ==============================
[0m13:35:30.936018 [info ] [MainThread]: Running with dbt=1.10.15
[0m13:35:30.936586 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'cache_selected_only': 'False', 'quiet': 'False', 'target_path': 'None', 'introspect': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'partial_parse': 'True', 'empty': 'False', 'debug': 'False', 'printer_width': '80', 'log_path': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/logs', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'use_colors': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'fail_fast': 'False', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles', 'invocation_command': 'dbt run --profiles-dir /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles --vars {"ds": "20251206", "clean_dir": "/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean"}'}
[0m13:35:31.123645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4fabc338-1880-494e-93af-a00e9f1a6ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c60c076faf0>]}
[0m13:35:31.176503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4fabc338-1880-494e-93af-a00e9f1a6ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c60c004e980>]}
[0m13:35:31.178204 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:35:31.243375 [debug] [MainThread]: checksum: 5a0d0a0a49a7e85d4a833cb08f50826341053ce165b4334dfaae473f545daa2d, vars: {'clean_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean',
 'ds': '20251206'}, profile: , target: , version: 1.10.15
[0m13:35:31.332313 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:35:31.333449 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:35:31.371646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fabc338-1880-494e-93af-a00e9f1a6ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c60b78d8130>]}
[0m13:35:31.493396 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m13:35:31.495277 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m13:35:31.505112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fabc338-1880-494e-93af-a00e9f1a6ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c60b78eca30>]}
[0m13:35:31.505619 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m13:35:31.506004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fabc338-1880-494e-93af-a00e9f1a6ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c60b78ecc10>]}
[0m13:35:31.507429 [info ] [MainThread]: 
[0m13:35:31.507813 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:35:31.508185 [info ] [MainThread]: 
[0m13:35:31.508664 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:35:31.514679 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m13:35:31.540156 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m13:35:31.540583 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m13:35:31.540858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:35:31.551806 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m13:35:31.552952 [debug] [ThreadPool]: On list_medallion: Close
[0m13:35:31.553584 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m13:35:31.554105 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m13:35:31.560907 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:35:31.561336 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m13:35:31.561619 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:35:31.562692 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:35:31.563730 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:35:31.564016 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m13:35:31.564513 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:35:31.564801 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:35:31.565050 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m13:35:31.565482 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:35:31.566137 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m13:35:31.566415 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:35:31.566659 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m13:35:31.567036 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:35:31.567305 [debug] [ThreadPool]: On create_medallion_main: Close
[0m13:35:31.568289 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m13:35:31.572584 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m13:35:31.572903 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m13:35:31.573179 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:35:31.573954 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:35:31.574239 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m13:35:31.574495 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m13:35:31.583016 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m13:35:31.584147 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m13:35:31.584700 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m13:35:31.585007 [debug] [ThreadPool]: On list_medallion_main: Close
[0m13:35:31.586084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fabc338-1880-494e-93af-a00e9f1a6ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c60b78b0340>]}
[0m13:35:31.586523 [debug] [MainThread]: Using duckdb connection "master"
[0m13:35:31.586842 [debug] [MainThread]: On master: BEGIN
[0m13:35:31.587196 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:35:31.587994 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:35:31.588288 [debug] [MainThread]: On master: COMMIT
[0m13:35:31.588552 [debug] [MainThread]: Using duckdb connection "master"
[0m13:35:31.588792 [debug] [MainThread]: On master: COMMIT
[0m13:35:31.589245 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:35:31.589512 [debug] [MainThread]: On master: Close
[0m13:35:31.591302 [debug] [Thread-1 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m13:35:31.591684 [debug] [Thread-2 (]: Began running node model.medallion_dbt.stg_transactions
[0m13:35:31.592146 [info ] [Thread-1 (]: 1 of 2 START sql table model main.fct_customer_transactions .................... [RUN]
[0m13:35:31.592655 [info ] [Thread-2 (]: 2 of 2 START sql table model main.stg_transactions ............................. [RUN]
[0m13:35:31.593162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.fct_customer_transactions)
[0m13:35:31.593739 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.medallion_dbt.stg_transactions'
[0m13:35:31.594512 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.fct_customer_transactions
[0m13:35:31.594961 [debug] [Thread-2 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m13:35:31.603072 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.fct_customer_transactions"
[0m13:35:31.608476 [debug] [Thread-2 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m13:35:31.609336 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.fct_customer_transactions
[0m13:35:31.609749 [debug] [Thread-2 (]: Began executing node model.medallion_dbt.stg_transactions
[0m13:35:31.645203 [debug] [Thread-2 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m13:35:31.646676 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.fct_customer_transactions"
[0m13:35:31.648449 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:35:31.649169 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m13:35:31.649648 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m13:35:31.650034 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: BEGIN
[0m13:35:31.650440 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:35:31.650793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:35:31.651666 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:35:31.652016 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:35:31.652376 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:35:31.652805 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
    
    

    create  table
      "medallion"."main"."stg_transactions__dbt_tmp"
  
    as (
      




WITH src AS (

    SELECT *
    FROM read_parquet(
        '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean/transactions_20251206_clean.parquet'
    )

),

typed AS (

    SELECT
        CAST(transaction_id AS VARCHAR) AS transaction_id,
        CAST(customer_id AS VARCHAR) AS customer_id,
        CAST(amount AS DOUBLE) AS amount,
        LOWER(TRIM(status)) AS status,
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM src

),

final AS (

    SELECT
        transaction_id,
        customer_id,
        amount,
        status,
        transaction_ts,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed','pending','failed')

)

SELECT *
FROM final
    );
  
  
[0m13:35:31.653279 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m13:35:31.653823 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      -- models/silver/stg_transactions.sql
-- Modelo staging de transacciones. Toma el parquet limpio generado en Silver
-- y normaliza columnas seg√∫n lo definido en schema.yml.






WITH source_clean AS (
    SELECT *
    FROM read_parquet(
        clean_dir || '/transactions_' || ds_nodash || '_clean.parquet'
    )
),

typed AS (
    SELECT
        /* Clave primaria obligatoria */
        CAST(transaction_id AS VARCHAR) AS transaction_id,

        /* Relaci√≥n con clientes */
        CAST(customer_id AS VARCHAR) AS customer_id,

        /* Montos: el schema.yml exige non_negative */
        CAST(amount AS DOUBLE) AS amount,

        /* Normalizaci√≥n del estado */
        LOWER(TRIM(status)) AS status,

        /* Timestamp obligatorio */
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM source_clean
),

validated AS (
    SELECT
        *,
        /* Campo derivado obligatorio seg√∫n schema.yml */
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed', 'pending', 'failed')
)

SELECT *
FROM validated
    );
  
  
[0m13:35:31.654904 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      -- models/silver/stg_transactions.sql
-- Modelo staging de transacciones. Toma el parquet limpio generado en Silver
-- y normaliza columnas seg√∫n lo definido en schema.yml.






WITH source_clean AS (
    SELECT *
    FROM read_parquet(
        clean_dir || '/transactions_' || ds_nodash || '_clean.parquet'
    )
),

typed AS (
    SELECT
        /* Clave primaria obligatoria */
        CAST(transaction_id AS VARCHAR) AS transaction_id,

        /* Relaci√≥n con clientes */
        CAST(customer_id AS VARCHAR) AS customer_id,

        /* Montos: el schema.yml exige non_negative */
        CAST(amount AS DOUBLE) AS amount,

        /* Normalizaci√≥n del estado */
        LOWER(TRIM(status)) AS status,

        /* Timestamp obligatorio */
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM source_clean
),

validated AS (
    SELECT
        *,
        /* Campo derivado obligatorio seg√∫n schema.yml */
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed', 'pending', 'failed')
)

SELECT *
FROM validated
    );
  
  
[0m13:35:31.655343 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:35:31.655904 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: ROLLBACK
[0m13:35:31.656405 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:35:31.661903 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:35:31.662459 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_transactions'
  
[0m13:35:31.663841 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.fct_customer_transactions'
[0m13:35:31.664213 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: Close
[0m13:35:31.664565 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:35:31.665896 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:35:31.666484 [debug] [Thread-1 (]: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  IO Error: No files found that match the pattern "clean_dir/transactions_ds_nodash_clean.parquet"
  
  LINE 22:     FROM read_parquet(
                    ^
[0m13:35:31.666880 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_transactions'
  
[0m13:35:31.668560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fabc338-1880-494e-93af-a00e9f1a6ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c60bf7e85e0>]}
[0m13:35:31.669332 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model main.fct_customer_transactions ........... [[31mERROR[0m in 0.07s]
[0m13:35:31.669739 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:35:31.670304 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m13:35:31.677929 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:35:31.678615 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.fct_customer_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  IO Error: No files found that match the pattern "clean_dir/transactions_ds_nodash_clean.parquet"
  
  LINE 22:     FROM read_parquet(
                    ^.
[0m13:35:31.679217 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */
alter table "medallion"."main"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m13:35:31.681009 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:35:31.683779 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:35:31.684131 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */
alter table "medallion"."main"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m13:35:31.684762 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m13:35:31.699018 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m13:35:31.699523 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:35:31.699852 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m13:35:31.701419 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:35:31.706274 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:35:31.706710 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

      drop table if exists "medallion"."main"."stg_transactions__dbt_backup" cascade
    
[0m13:35:31.708162 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:35:31.710246 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: Close
[0m13:35:31.710909 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fabc338-1880-494e-93af-a00e9f1a6ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c60c2239360>]}
[0m13:35:31.711929 [info ] [Thread-2 (]: 2 of 2 OK created sql table model main.stg_transactions ........................ [[32mOK[0m in 0.12s]
[0m13:35:31.713025 [debug] [Thread-2 (]: Finished running node model.medallion_dbt.stg_transactions
[0m13:35:31.715409 [debug] [MainThread]: Using duckdb connection "master"
[0m13:35:31.715853 [debug] [MainThread]: On master: BEGIN
[0m13:35:31.716208 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:35:31.716832 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:35:31.717128 [debug] [MainThread]: On master: COMMIT
[0m13:35:31.717389 [debug] [MainThread]: Using duckdb connection "master"
[0m13:35:31.717629 [debug] [MainThread]: On master: COMMIT
[0m13:35:31.718054 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:35:31.718370 [debug] [MainThread]: On master: Close
[0m13:35:31.718802 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:35:31.719104 [debug] [MainThread]: Connection 'model.medallion_dbt.fct_customer_transactions' was properly closed.
[0m13:35:31.719337 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m13:35:31.719632 [info ] [MainThread]: 
[0m13:35:31.719964 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m13:35:31.720728 [debug] [MainThread]: Command end result
[0m13:35:31.738617 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m13:35:31.740196 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m13:35:31.745199 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m13:35:31.745549 [info ] [MainThread]: 
[0m13:35:31.745948 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:35:31.746333 [info ] [MainThread]: 
[0m13:35:31.746726 [error] [MainThread]: [31mFailure in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)[0m
[0m13:35:31.747107 [error] [MainThread]:   Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  IO Error: No files found that match the pattern "clean_dir/transactions_ds_nodash_clean.parquet"
  
  LINE 22:     FROM read_parquet(
                    ^
[0m13:35:31.747440 [info ] [MainThread]: 
[0m13:35:31.747855 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/fct_customer_transactions.sql
[0m13:35:31.748184 [info ] [MainThread]: 
[0m13:35:31.748533 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m13:35:31.749278 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8636509, "process_in_blocks": "0", "process_kernel_time": 0.119934, "process_mem_max_rss": "155056", "process_out_blocks": "2240", "process_user_time": 1.841989}
[0m13:35:31.749660 [debug] [MainThread]: Command `dbt run` failed at 13:35:31.749584 after 0.86 seconds
[0m13:35:31.750003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c60c0871450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c60c076d780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c60b7722140>]}
[0m13:35:31.750348 [debug] [MainThread]: Flushing usage events
[0m13:35:32.464354 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:35:39.866396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7518c2f71390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7518c1f38280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7518c1f38220>]}


============================== 13:35:39.868665 | 6f75b520-99c1-46a7-b437-152691ea4eca ==============================
[0m13:35:39.868665 [info ] [MainThread]: Running with dbt=1.10.15
[0m13:35:39.869181 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'version_check': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --profiles-dir /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles --vars {"ds": "20251207", "clean_dir": "/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean"}', 'empty': 'False', 'use_colors': 'True', 'introspect': 'True', 'printer_width': '80', 'profiles_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles', 'no_print': 'None', 'quiet': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'log_path': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'partial_parse': 'True', 'log_format': 'default', 'warn_error': 'None'}
[0m13:35:40.055862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f75b520-99c1-46a7-b437-152691ea4eca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7518c291f130>]}
[0m13:35:40.108425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f75b520-99c1-46a7-b437-152691ea4eca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7518c1ee6dd0>]}
[0m13:35:40.110146 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:35:40.180662 [debug] [MainThread]: checksum: 505cc0738468dbf8af23784e25e0465f2f41e62e9895701049268b92bd4ad565, vars: {'clean_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean',
 'ds': '20251207'}, profile: , target: , version: 1.10.15
[0m13:35:40.264247 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:35:40.264686 [debug] [MainThread]: previous checksum: 505cc0738468dbf8af23784e25e0465f2f41e62e9895701049268b92bd4ad565, current checksum: 5a0d0a0a49a7e85d4a833cb08f50826341053ce165b4334dfaae473f545daa2d
[0m13:35:40.265052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6f75b520-99c1-46a7-b437-152691ea4eca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7518c2748be0>]}
[0m13:35:41.249412 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m13:35:41.250001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6f75b520-99c1-46a7-b437-152691ea4eca', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7518b8d3eda0>]}
[0m13:35:41.321786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f75b520-99c1-46a7-b437-152691ea4eca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7518b8c28130>]}
[0m13:35:41.454582 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m13:35:41.456301 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m13:35:41.466615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f75b520-99c1-46a7-b437-152691ea4eca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7518b8c47d90>]}
[0m13:35:41.467105 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m13:35:41.467462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f75b520-99c1-46a7-b437-152691ea4eca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7518b8c297e0>]}
[0m13:35:41.468821 [info ] [MainThread]: 
[0m13:35:41.469169 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:35:41.469434 [info ] [MainThread]: 
[0m13:35:41.469853 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:35:41.474165 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m13:35:41.500029 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m13:35:41.500459 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m13:35:41.500732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:35:41.513425 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m13:35:41.514650 [debug] [ThreadPool]: On list_medallion: Close
[0m13:35:41.515363 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m13:35:41.515797 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m13:35:41.521412 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:35:41.521823 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m13:35:41.522105 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:35:41.523322 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:35:41.524375 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:35:41.524654 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m13:35:41.525099 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:35:41.525369 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:35:41.525615 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m13:35:41.526032 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:35:41.526761 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m13:35:41.527054 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:35:41.527316 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m13:35:41.527766 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:35:41.528153 [debug] [ThreadPool]: On create_medallion_main: Close
[0m13:35:41.529324 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m13:35:41.534059 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m13:35:41.534485 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m13:35:41.534915 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:35:41.535649 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:35:41.535951 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m13:35:41.536228 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m13:35:41.544756 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m13:35:41.546071 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m13:35:41.546582 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m13:35:41.546878 [debug] [ThreadPool]: On list_medallion_main: Close
[0m13:35:41.547695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f75b520-99c1-46a7-b437-152691ea4eca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7518b8d8fb20>]}
[0m13:35:41.548190 [debug] [MainThread]: Using duckdb connection "master"
[0m13:35:41.548486 [debug] [MainThread]: On master: BEGIN
[0m13:35:41.548773 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:35:41.550554 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:35:41.551034 [debug] [MainThread]: On master: COMMIT
[0m13:35:41.551453 [debug] [MainThread]: Using duckdb connection "master"
[0m13:35:41.551758 [debug] [MainThread]: On master: COMMIT
[0m13:35:41.552579 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:35:41.552860 [debug] [MainThread]: On master: Close
[0m13:35:41.555979 [debug] [Thread-1 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m13:35:41.556488 [debug] [Thread-2 (]: Began running node model.medallion_dbt.stg_transactions
[0m13:35:41.556969 [info ] [Thread-1 (]: 1 of 2 START sql table model main.fct_customer_transactions .................... [RUN]
[0m13:35:41.557507 [info ] [Thread-2 (]: 2 of 2 START sql table model main.stg_transactions ............................. [RUN]
[0m13:35:41.557972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.fct_customer_transactions)
[0m13:35:41.558442 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.medallion_dbt.stg_transactions'
[0m13:35:41.558771 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.fct_customer_transactions
[0m13:35:41.559128 [debug] [Thread-2 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m13:35:41.566205 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.fct_customer_transactions"
[0m13:35:41.569392 [debug] [Thread-2 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m13:35:41.570183 [debug] [Thread-2 (]: Began executing node model.medallion_dbt.stg_transactions
[0m13:35:41.575861 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.fct_customer_transactions
[0m13:35:41.606156 [debug] [Thread-2 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m13:35:41.609086 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.fct_customer_transactions"
[0m13:35:41.609800 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:35:41.610246 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m13:35:41.610634 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m13:35:41.611042 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: BEGIN
[0m13:35:41.611470 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:35:41.611857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:35:41.613495 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:35:41.613932 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:35:41.614292 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:35:41.614769 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
    
    

    create  table
      "medallion"."main"."stg_transactions__dbt_tmp"
  
    as (
      




WITH src AS (

    SELECT *
    FROM read_parquet(
        '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean/transactions_20251207_clean.parquet'
    )

),

typed AS (

    SELECT
        CAST(transaction_id AS VARCHAR) AS transaction_id,
        CAST(customer_id AS VARCHAR) AS customer_id,
        CAST(amount AS DOUBLE) AS amount,
        LOWER(TRIM(status)) AS status,
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM src

),

final AS (

    SELECT
        transaction_id,
        customer_id,
        amount,
        status,
        transaction_ts,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed','pending','failed')

)

SELECT *
FROM final
    );
  
  
[0m13:35:41.615181 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m13:35:41.615746 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      -- models/silver/stg_transactions.sql
-- Modelo staging de transacciones. Toma el parquet limpio generado en Silver
-- y normaliza columnas seg√∫n lo definido en schema.yml.






WITH source_clean AS (
    SELECT *
    FROM read_parquet(
        clean_dir || '/transactions_' || ds_nodash || '_clean.parquet'
    )
),

typed AS (
    SELECT
        /* Clave primaria obligatoria */
        CAST(transaction_id AS VARCHAR) AS transaction_id,

        /* Relaci√≥n con clientes */
        CAST(customer_id AS VARCHAR) AS customer_id,

        /* Montos: el schema.yml exige non_negative */
        CAST(amount AS DOUBLE) AS amount,

        /* Normalizaci√≥n del estado */
        LOWER(TRIM(status)) AS status,

        /* Timestamp obligatorio */
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM source_clean
),

validated AS (
    SELECT
        *,
        /* Campo derivado obligatorio seg√∫n schema.yml */
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed', 'pending', 'failed')
)

SELECT *
FROM validated
    );
  
  
[0m13:35:41.616312 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
    
    

    create  table
      "medallion"."main"."stg_transactions__dbt_tmp"
  
    as (
      




WITH src AS (

    SELECT *
    FROM read_parquet(
        '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean/transactions_20251207_clean.parquet'
    )

),

typed AS (

    SELECT
        CAST(transaction_id AS VARCHAR) AS transaction_id,
        CAST(customer_id AS VARCHAR) AS customer_id,
        CAST(amount AS DOUBLE) AS amount,
        LOWER(TRIM(status)) AS status,
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM src

),

final AS (

    SELECT
        transaction_id,
        customer_id,
        amount,
        status,
        transaction_ts,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed','pending','failed')

)

SELECT *
FROM final
    );
  
  
[0m13:35:41.616749 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      -- models/silver/stg_transactions.sql
-- Modelo staging de transacciones. Toma el parquet limpio generado en Silver
-- y normaliza columnas seg√∫n lo definido en schema.yml.






WITH source_clean AS (
    SELECT *
    FROM read_parquet(
        clean_dir || '/transactions_' || ds_nodash || '_clean.parquet'
    )
),

typed AS (
    SELECT
        /* Clave primaria obligatoria */
        CAST(transaction_id AS VARCHAR) AS transaction_id,

        /* Relaci√≥n con clientes */
        CAST(customer_id AS VARCHAR) AS customer_id,

        /* Montos: el schema.yml exige non_negative */
        CAST(amount AS DOUBLE) AS amount,

        /* Normalizaci√≥n del estado */
        LOWER(TRIM(status)) AS status,

        /* Timestamp obligatorio */
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM source_clean
),

validated AS (
    SELECT
        *,
        /* Campo derivado obligatorio seg√∫n schema.yml */
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed', 'pending', 'failed')
)

SELECT *
FROM validated
    );
  
  
[0m13:35:41.617161 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m13:35:41.617516 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:35:41.618003 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m13:35:41.618450 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: ROLLBACK
[0m13:35:41.621131 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.fct_customer_transactions'
[0m13:35:41.621640 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: Close
[0m13:35:41.622238 [debug] [Thread-2 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m13:35:41.622632 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: Close
[0m13:35:41.623773 [debug] [Thread-1 (]: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  IO Error: No files found that match the pattern "clean_dir/transactions_ds_nodash_clean.parquet"
  
  LINE 22:     FROM read_parquet(
                    ^
[0m13:35:41.625667 [debug] [Thread-2 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Binder Error: Column "transaction_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m13:35:41.626096 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f75b520-99c1-46a7-b437-152691ea4eca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7518b9f2c790>]}
[0m13:35:41.626586 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f75b520-99c1-46a7-b437-152691ea4eca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7518c1e00370>]}
[0m13:35:41.627224 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model main.fct_customer_transactions ........... [[31mERROR[0m in 0.07s]
[0m13:35:41.627889 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model main.stg_transactions .................... [[31mERROR[0m in 0.07s]
[0m13:35:41.628427 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m13:35:41.628908 [debug] [Thread-2 (]: Finished running node model.medallion_dbt.stg_transactions
[0m13:35:41.629420 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.fct_customer_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  IO Error: No files found that match the pattern "clean_dir/transactions_ds_nodash_clean.parquet"
  
  LINE 22:     FROM read_parquet(
                    ^.
[0m13:35:41.630407 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Binder Error: Column "transaction_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined.
[0m13:35:41.631368 [debug] [MainThread]: Using duckdb connection "master"
[0m13:35:41.631708 [debug] [MainThread]: On master: BEGIN
[0m13:35:41.631992 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:35:41.632643 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:35:41.632935 [debug] [MainThread]: On master: COMMIT
[0m13:35:41.633232 [debug] [MainThread]: Using duckdb connection "master"
[0m13:35:41.633518 [debug] [MainThread]: On master: COMMIT
[0m13:35:41.633954 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:35:41.634252 [debug] [MainThread]: On master: Close
[0m13:35:41.634663 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:35:41.635010 [debug] [MainThread]: Connection 'model.medallion_dbt.fct_customer_transactions' was properly closed.
[0m13:35:41.635295 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m13:35:41.635692 [info ] [MainThread]: 
[0m13:35:41.636043 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m13:35:41.636662 [debug] [MainThread]: Command end result
[0m13:35:41.658196 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m13:35:41.659817 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m13:35:41.664709 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m13:35:41.665002 [info ] [MainThread]: 
[0m13:35:41.665334 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m13:35:41.665654 [info ] [MainThread]: 
[0m13:35:41.666036 [error] [MainThread]: [31mFailure in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)[0m
[0m13:35:41.666356 [error] [MainThread]:   Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  IO Error: No files found that match the pattern "clean_dir/transactions_ds_nodash_clean.parquet"
  
  LINE 22:     FROM read_parquet(
                    ^
[0m13:35:41.666607 [info ] [MainThread]: 
[0m13:35:41.666910 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/fct_customer_transactions.sql
[0m13:35:41.667175 [info ] [MainThread]: 
[0m13:35:41.667467 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m13:35:41.667752 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Binder Error: Column "transaction_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m13:35:41.667991 [info ] [MainThread]: 
[0m13:35:41.668385 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m13:35:41.668646 [info ] [MainThread]: 
[0m13:35:41.668943 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=2
[0m13:35:41.669438 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:35:41.670117 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.8499268, "process_in_blocks": "0", "process_kernel_time": 0.108978, "process_mem_max_rss": "157044", "process_out_blocks": "3240", "process_user_time": 2.773458}
[0m13:35:41.670523 [debug] [MainThread]: Command `dbt run` failed at 13:35:41.670428 after 1.85 seconds
[0m13:35:41.670896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7518c2f71390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7518b8de2890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7518c2e6d4b0>]}
[0m13:35:41.671250 [debug] [MainThread]: Flushing usage events
[0m13:35:42.463246 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:36:45.419055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a3cc39d420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a3cb36c2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a3cb36c250>]}


============================== 13:36:45.421828 | b8ba1d65-6edb-45a3-854f-566fe5d52077 ==============================
[0m13:36:45.421828 [info ] [MainThread]: Running with dbt=1.10.15
[0m13:36:45.422470 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/logs', 'static_parser': 'True', 'introspect': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'debug': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'no_print': 'None', 'empty': 'False', 'printer_width': '80', 'profiles_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'target_path': 'None', 'fail_fast': 'False', 'invocation_command': 'dbt run --profiles-dir /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles --vars {"ds": "20251207", "clean_dir": "/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean"}', 'write_json': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'partial_parse': 'True'}
[0m13:36:45.605441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8ba1d65-6edb-45a3-854f-566fe5d52077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a3cc298f10>]}
[0m13:36:45.659255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8ba1d65-6edb-45a3-854f-566fe5d52077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a3cbc13be0>]}
[0m13:36:45.660712 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:36:45.725713 [debug] [MainThread]: checksum: 505cc0738468dbf8af23784e25e0465f2f41e62e9895701049268b92bd4ad565, vars: {'clean_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean',
 'ds': '20251207'}, profile: , target: , version: 1.10.15
[0m13:36:45.820091 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:36:45.821190 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:36:45.856060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8ba1d65-6edb-45a3-854f-566fe5d52077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a3c320c130>]}
[0m13:36:45.985561 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m13:36:45.987574 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m13:36:45.998438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8ba1d65-6edb-45a3-854f-566fe5d52077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a3c3398fd0>]}
[0m13:36:45.998930 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m13:36:45.999281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8ba1d65-6edb-45a3-854f-566fe5d52077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a3c339a9b0>]}
[0m13:36:46.000587 [info ] [MainThread]: 
[0m13:36:46.000903 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:36:46.001186 [info ] [MainThread]: 
[0m13:36:46.001603 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:36:46.006355 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m13:36:46.032065 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m13:36:46.032625 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m13:36:46.032958 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:36:46.044113 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m13:36:46.045394 [debug] [ThreadPool]: On list_medallion: Close
[0m13:36:46.046050 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m13:36:46.046469 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m13:36:46.052576 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:36:46.053136 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m13:36:46.053484 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:36:46.054820 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:36:46.055990 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:36:46.056339 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m13:36:46.056859 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:36:46.057153 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:36:46.057424 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m13:36:46.057900 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:36:46.058607 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m13:36:46.058932 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:36:46.059261 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m13:36:46.059772 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:36:46.060048 [debug] [ThreadPool]: On create_medallion_main: Close
[0m13:36:46.061168 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m13:36:46.066378 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m13:36:46.066774 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m13:36:46.067089 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:36:46.067961 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:36:46.068245 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m13:36:46.068529 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m13:36:46.078883 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m13:36:46.080609 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m13:36:46.081131 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m13:36:46.081465 [debug] [ThreadPool]: On list_medallion_main: Close
[0m13:36:46.082293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8ba1d65-6edb-45a3-854f-566fe5d52077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a3c33e2f20>]}
[0m13:36:46.082776 [debug] [MainThread]: Using duckdb connection "master"
[0m13:36:46.083065 [debug] [MainThread]: On master: BEGIN
[0m13:36:46.083380 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:36:46.084004 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:36:46.084279 [debug] [MainThread]: On master: COMMIT
[0m13:36:46.084533 [debug] [MainThread]: Using duckdb connection "master"
[0m13:36:46.084773 [debug] [MainThread]: On master: COMMIT
[0m13:36:46.085221 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:36:46.085503 [debug] [MainThread]: On master: Close
[0m13:36:46.087581 [debug] [Thread-1 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m13:36:46.088106 [debug] [Thread-2 (]: Began running node model.medallion_dbt.stg_transactions
[0m13:36:46.089321 [info ] [Thread-1 (]: 1 of 2 START sql table model main.fct_customer_transactions .................... [RUN]
[0m13:36:46.089988 [info ] [Thread-2 (]: 2 of 2 START sql table model main.stg_transactions ............................. [RUN]
[0m13:36:46.090496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.fct_customer_transactions)
[0m13:36:46.091043 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.medallion_dbt.stg_transactions'
[0m13:36:46.091488 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.fct_customer_transactions
[0m13:36:46.091906 [debug] [Thread-2 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m13:36:46.099309 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.fct_customer_transactions"
[0m13:36:46.103437 [debug] [Thread-2 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m13:36:46.104152 [debug] [Thread-2 (]: Began executing node model.medallion_dbt.stg_transactions
[0m13:36:46.104565 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.fct_customer_transactions
[0m13:36:46.144070 [debug] [Thread-2 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m13:36:46.146072 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.fct_customer_transactions"
[0m13:36:46.146800 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m13:36:46.147211 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:36:46.147643 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: BEGIN
[0m13:36:46.148007 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m13:36:46.148416 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:36:46.148795 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:36:46.149665 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:36:46.150007 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m13:36:46.150324 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:36:46.150710 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      -- models/silver/stg_transactions.sql
-- Modelo staging de transacciones. Toma el parquet limpio generado en Silver
-- y normaliza columnas seg√∫n lo definido en schema.yml.






WITH source_clean AS (
    SELECT *
    FROM read_parquet(
        clean_dir || '/transactions_' || ds_nodash || '_clean.parquet'
    )
),

typed AS (
    SELECT
        /* Clave primaria obligatoria */
        CAST(transaction_id AS VARCHAR) AS transaction_id,

        /* Relaci√≥n con clientes */
        CAST(customer_id AS VARCHAR) AS customer_id,

        /* Montos: el schema.yml exige non_negative */
        CAST(amount AS DOUBLE) AS amount,

        /* Normalizaci√≥n del estado */
        LOWER(TRIM(status)) AS status,

        /* Timestamp obligatorio */
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM source_clean
),

validated AS (
    SELECT
        *,
        /* Campo derivado obligatorio seg√∫n schema.yml */
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed', 'pending', 'failed')
)

SELECT *
FROM validated
    );
  
  
[0m13:36:46.151111 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:36:46.151687 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
    
    

    create  table
      "medallion"."main"."stg_transactions__dbt_tmp"
  
    as (
      




WITH src AS (

    SELECT *
    FROM read_parquet(
        '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean/transactions_20251207_clean.parquet'
    )

),

typed AS (

    SELECT
        CAST(transaction_id AS VARCHAR) AS transaction_id,
        CAST(customer_id AS VARCHAR) AS customer_id,
        CAST(amount AS DOUBLE) AS amount,
        LOWER(TRIM(status)) AS status,
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM src

),

final AS (

    SELECT
        transaction_id,
        customer_id,
        amount,
        status,
        transaction_ts,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed','pending','failed')

)

SELECT *
FROM final
    );
  
  
[0m13:36:46.152200 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      -- models/silver/stg_transactions.sql
-- Modelo staging de transacciones. Toma el parquet limpio generado en Silver
-- y normaliza columnas seg√∫n lo definido en schema.yml.






WITH source_clean AS (
    SELECT *
    FROM read_parquet(
        clean_dir || '/transactions_' || ds_nodash || '_clean.parquet'
    )
),

typed AS (
    SELECT
        /* Clave primaria obligatoria */
        CAST(transaction_id AS VARCHAR) AS transaction_id,

        /* Relaci√≥n con clientes */
        CAST(customer_id AS VARCHAR) AS customer_id,

        /* Montos: el schema.yml exige non_negative */
        CAST(amount AS DOUBLE) AS amount,

        /* Normalizaci√≥n del estado */
        LOWER(TRIM(status)) AS status,

        /* Timestamp obligatorio */
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM source_clean
),

validated AS (
    SELECT
        *,
        /* Campo derivado obligatorio seg√∫n schema.yml */
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed', 'pending', 'failed')
)

SELECT *
FROM validated
    );
  
  
[0m13:36:46.152743 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:36:46.153191 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: ROLLBACK
[0m13:36:46.153614 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
    
    

    create  table
      "medallion"."main"."stg_transactions__dbt_tmp"
  
    as (
      




WITH src AS (

    SELECT *
    FROM read_parquet(
        '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean/transactions_20251207_clean.parquet'
    )

),

typed AS (

    SELECT
        CAST(transaction_id AS VARCHAR) AS transaction_id,
        CAST(customer_id AS VARCHAR) AS customer_id,
        CAST(amount AS DOUBLE) AS amount,
        LOWER(TRIM(status)) AS status,
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM src

),

final AS (

    SELECT
        transaction_id,
        customer_id,
        amount,
        status,
        transaction_ts,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed','pending','failed')

)

SELECT *
FROM final
    );
  
  
[0m13:36:46.154065 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m13:36:46.154475 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m13:36:46.156674 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.fct_customer_transactions'
[0m13:36:46.157264 [debug] [Thread-2 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m13:36:46.157628 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: Close
[0m13:36:46.157992 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: Close
[0m13:36:46.158941 [debug] [Thread-2 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Binder Error: Column "transaction_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m13:36:46.160564 [debug] [Thread-1 (]: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  IO Error: No files found that match the pattern "clean_dir/transactions_ds_nodash_clean.parquet"
  
  LINE 22:     FROM read_parquet(
                    ^
[0m13:36:46.161124 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8ba1d65-6edb-45a3-854f-566fe5d52077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a3cc67aec0>]}
[0m13:36:46.161427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8ba1d65-6edb-45a3-854f-566fe5d52077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a3cc29b100>]}
[0m13:36:46.162155 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model main.stg_transactions .................... [[31mERROR[0m in 0.07s]
[0m13:36:46.163016 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model main.fct_customer_transactions ........... [[31mERROR[0m in 0.07s]
[0m13:36:46.163645 [debug] [Thread-2 (]: Finished running node model.medallion_dbt.stg_transactions
[0m13:36:46.164193 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m13:36:46.164833 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Binder Error: Column "transaction_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined.
[0m13:36:46.166146 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.fct_customer_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  IO Error: No files found that match the pattern "clean_dir/transactions_ds_nodash_clean.parquet"
  
  LINE 22:     FROM read_parquet(
                    ^.
[0m13:36:46.167208 [debug] [MainThread]: Using duckdb connection "master"
[0m13:36:46.167561 [debug] [MainThread]: On master: BEGIN
[0m13:36:46.167826 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:36:46.168449 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:36:46.168719 [debug] [MainThread]: On master: COMMIT
[0m13:36:46.168976 [debug] [MainThread]: Using duckdb connection "master"
[0m13:36:46.169233 [debug] [MainThread]: On master: COMMIT
[0m13:36:46.169685 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:36:46.169951 [debug] [MainThread]: On master: Close
[0m13:36:46.170313 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:36:46.170574 [debug] [MainThread]: Connection 'model.medallion_dbt.fct_customer_transactions' was properly closed.
[0m13:36:46.170862 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m13:36:46.171201 [info ] [MainThread]: 
[0m13:36:46.171560 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m13:36:46.172652 [debug] [MainThread]: Command end result
[0m13:36:46.190895 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m13:36:46.192498 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m13:36:46.201038 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m13:36:46.201580 [info ] [MainThread]: 
[0m13:36:46.202071 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m13:36:46.202533 [info ] [MainThread]: 
[0m13:36:46.202956 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m13:36:46.203367 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Binder Error: Column "transaction_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m13:36:46.203701 [info ] [MainThread]: 
[0m13:36:46.204103 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m13:36:46.204378 [info ] [MainThread]: 
[0m13:36:46.204691 [error] [MainThread]: [31mFailure in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)[0m
[0m13:36:46.204994 [error] [MainThread]:   Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  IO Error: No files found that match the pattern "clean_dir/transactions_ds_nodash_clean.parquet"
  
  LINE 22:     FROM read_parquet(
                    ^
[0m13:36:46.205250 [info ] [MainThread]: 
[0m13:36:46.205534 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/fct_customer_transactions.sql
[0m13:36:46.205770 [info ] [MainThread]: 
[0m13:36:46.206040 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=2
[0m13:36:46.206751 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.83542466, "process_in_blocks": "0", "process_kernel_time": 0.094001, "process_mem_max_rss": "152880", "process_out_blocks": "2224", "process_user_time": 1.837033}
[0m13:36:46.207156 [debug] [MainThread]: Command `dbt run` failed at 13:36:46.207064 after 0.84 seconds
[0m13:36:46.207489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a3cc39d420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a3c367bd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a3cc257a30>]}
[0m13:36:46.207817 [debug] [MainThread]: Flushing usage events
[0m13:36:46.901573 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:38:10.990195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727fdeda1420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727fddd642b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727fddd64250>]}


============================== 13:38:10.992736 | 4b6a6ff1-4c33-43e4-b269-00d9e3c684cc ==============================
[0m13:38:10.992736 [info ] [MainThread]: Running with dbt=1.10.15
[0m13:38:10.993412 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'warn_error': 'None', 'target_path': 'None', 'quiet': 'False', 'empty': 'False', 'write_json': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'static_parser': 'True', 'log_path': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/logs', 'profiles_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles', 'use_colors': 'True', 'no_print': 'None', 'invocation_command': 'dbt run --profiles-dir /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles --vars {"ds": "20251207", "clean_dir": "/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean"}', 'debug': 'False', 'log_format': 'default', 'introspect': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'partial_parse': 'True', 'printer_width': '80'}
[0m13:38:11.256009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b6a6ff1-4c33-43e4-b269-00d9e3c684cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727fdec98f10>]}
[0m13:38:11.323039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b6a6ff1-4c33-43e4-b269-00d9e3c684cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727fde61fbe0>]}
[0m13:38:11.327139 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:38:11.416704 [debug] [MainThread]: checksum: 505cc0738468dbf8af23784e25e0465f2f41e62e9895701049268b92bd4ad565, vars: {'clean_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean',
 'ds': '20251207'}, profile: , target: , version: 1.10.15
[0m13:38:11.556255 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:38:11.559103 [debug] [MainThread]: Partial parsing: updated file: medallion_dbt://models/staging/stg_transactions.sql
[0m13:38:11.559865 [debug] [MainThread]: Partial parsing: updated file: medallion_dbt://models/marts/fct_customer_transactions.sql
[0m13:38:12.152191 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m13:38:12.153483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4b6a6ff1-4c33-43e4-b269-00d9e3c684cc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727fd4b010f0>]}
[0m13:38:12.251145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b6a6ff1-4c33-43e4-b269-00d9e3c684cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727fd4bb5f00>]}
[0m13:38:12.349989 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m13:38:12.355423 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m13:38:12.369919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b6a6ff1-4c33-43e4-b269-00d9e3c684cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727fd4bb5b10>]}
[0m13:38:12.370878 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m13:38:12.371436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b6a6ff1-4c33-43e4-b269-00d9e3c684cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727fd5d9b0d0>]}
[0m13:38:12.373120 [info ] [MainThread]: 
[0m13:38:12.373530 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:38:12.373888 [info ] [MainThread]: 
[0m13:38:12.374392 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:38:12.379174 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m13:38:12.421408 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m13:38:12.422172 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m13:38:12.422702 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:12.439765 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m13:38:12.441122 [debug] [ThreadPool]: On list_medallion: Close
[0m13:38:12.441861 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m13:38:12.442296 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m13:38:12.453710 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:38:12.454979 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m13:38:12.455603 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:38:12.457204 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m13:38:12.458323 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:38:12.458628 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m13:38:12.459122 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:38:12.459388 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:38:12.459663 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m13:38:12.460189 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:38:12.460839 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m13:38:12.461143 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:38:12.461399 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m13:38:12.461917 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:38:12.462362 [debug] [ThreadPool]: On create_medallion_main: Close
[0m13:38:12.464493 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m13:38:12.473612 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m13:38:12.474175 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m13:38:12.474576 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:38:12.475406 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:38:12.475697 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m13:38:12.475957 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m13:38:12.489010 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m13:38:12.491673 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m13:38:12.492299 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m13:38:12.492615 [debug] [ThreadPool]: On list_medallion_main: Close
[0m13:38:12.493422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b6a6ff1-4c33-43e4-b269-00d9e3c684cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727fd4b701c0>]}
[0m13:38:12.493888 [debug] [MainThread]: Using duckdb connection "master"
[0m13:38:12.494192 [debug] [MainThread]: On master: BEGIN
[0m13:38:12.494465 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:38:12.495215 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:38:12.495614 [debug] [MainThread]: On master: COMMIT
[0m13:38:12.496027 [debug] [MainThread]: Using duckdb connection "master"
[0m13:38:12.496459 [debug] [MainThread]: On master: COMMIT
[0m13:38:12.497161 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:38:12.497547 [debug] [MainThread]: On master: Close
[0m13:38:12.504706 [debug] [Thread-1 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m13:38:12.505879 [debug] [Thread-2 (]: Began running node model.medallion_dbt.stg_transactions
[0m13:38:12.506950 [info ] [Thread-1 (]: 1 of 2 START sql table model main.fct_customer_transactions .................... [RUN]
[0m13:38:12.507755 [info ] [Thread-2 (]: 2 of 2 START sql table model main.stg_transactions ............................. [RUN]
[0m13:38:12.508349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.fct_customer_transactions)
[0m13:38:12.508932 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.medallion_dbt.stg_transactions'
[0m13:38:12.509451 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.fct_customer_transactions
[0m13:38:12.509840 [debug] [Thread-2 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m13:38:12.522158 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.fct_customer_transactions"
[0m13:38:12.526661 [debug] [Thread-2 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m13:38:12.527370 [debug] [Thread-2 (]: Began executing node model.medallion_dbt.stg_transactions
[0m13:38:12.527761 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.fct_customer_transactions
[0m13:38:12.579618 [debug] [Thread-2 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m13:38:12.585996 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.fct_customer_transactions"
[0m13:38:12.588386 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:38:12.589480 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m13:38:12.590191 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m13:38:12.590843 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: BEGIN
[0m13:38:12.591248 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:38:12.591715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:12.592671 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:38:12.593142 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:38:12.593582 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:38:12.593957 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
    
    

    create  table
      "medallion"."main"."stg_transactions__dbt_tmp"
  
    as (
      




WITH src AS (
    SELECT *
    FROM read_parquet(
        '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean/transactions_20251207_clean.parquet'
    )
),

typed AS (

    SELECT
        CAST(transaction_id AS VARCHAR) AS transaction_id,
        CAST(customer_id AS VARCHAR) AS customer_id,
        CAST(amount AS DOUBLE) AS amount,
        LOWER(TRIM(status)) AS status,
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM src

),

final AS (

    SELECT
        transaction_id,
        customer_id,
        amount,
        status,
        transaction_ts,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed','pending','failed')

)

SELECT *
FROM final
    );
  
  
[0m13:38:12.594426 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m13:38:12.594968 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      




WITH source_clean AS (
    SELECT *
    FROM read_parquet(
        '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean/transactions_20251207_clean.parquet'
    )
),

typed AS (
    SELECT
        CAST(transaction_id AS VARCHAR) AS transaction_id,
        CAST(customer_id AS VARCHAR) AS customer_id,
        CAST(amount AS DOUBLE) AS amount,
        LOWER(TRIM(status)) AS status,
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM source_clean
),

validated AS (
    SELECT
        *,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed', 'pending', 'failed')
)

SELECT *
FROM validated
    );
  
  
[0m13:38:12.595799 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
    
    

    create  table
      "medallion"."main"."stg_transactions__dbt_tmp"
  
    as (
      




WITH src AS (
    SELECT *
    FROM read_parquet(
        '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean/transactions_20251207_clean.parquet'
    )
),

typed AS (

    SELECT
        CAST(transaction_id AS VARCHAR) AS transaction_id,
        CAST(customer_id AS VARCHAR) AS customer_id,
        CAST(amount AS DOUBLE) AS amount,
        LOWER(TRIM(status)) AS status,
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM src

),

final AS (

    SELECT
        transaction_id,
        customer_id,
        amount,
        status,
        transaction_ts,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed','pending','failed')

)

SELECT *
FROM final
    );
  
  
[0m13:38:12.596345 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      




WITH source_clean AS (
    SELECT *
    FROM read_parquet(
        '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean/transactions_20251207_clean.parquet'
    )
),

typed AS (
    SELECT
        CAST(transaction_id AS VARCHAR) AS transaction_id,
        CAST(customer_id AS VARCHAR) AS customer_id,
        CAST(amount AS DOUBLE) AS amount,
        LOWER(TRIM(status)) AS status,
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM source_clean
),

validated AS (
    SELECT
        *,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed', 'pending', 'failed')
)

SELECT *
FROM validated
    );
  
  
[0m13:38:12.596751 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m13:38:12.597233 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:38:12.597781 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m13:38:12.598921 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: ROLLBACK
[0m13:38:12.605011 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.fct_customer_transactions'
[0m13:38:12.606864 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: Close
[0m13:38:12.608123 [debug] [Thread-2 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m13:38:12.608611 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: Close
[0m13:38:12.609646 [debug] [Thread-1 (]: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  Binder Error: Column "transaction_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m13:38:12.611394 [debug] [Thread-2 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Binder Error: Column "transaction_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m13:38:12.611910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b6a6ff1-4c33-43e4-b269-00d9e3c684cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727fcfe5c370>]}
[0m13:38:12.612216 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b6a6ff1-4c33-43e4-b269-00d9e3c684cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727fd4df7c10>]}
[0m13:38:12.612828 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model main.fct_customer_transactions ........... [[31mERROR[0m in 0.10s]
[0m13:38:12.613424 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model main.stg_transactions .................... [[31mERROR[0m in 0.10s]
[0m13:38:12.614003 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m13:38:12.614538 [debug] [Thread-2 (]: Finished running node model.medallion_dbt.stg_transactions
[0m13:38:12.615848 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.fct_customer_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  Binder Error: Column "transaction_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined.
[0m13:38:12.618296 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Binder Error: Column "transaction_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined.
[0m13:38:12.621581 [debug] [MainThread]: Using duckdb connection "master"
[0m13:38:12.622698 [debug] [MainThread]: On master: BEGIN
[0m13:38:12.623191 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:38:12.623999 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:38:12.624342 [debug] [MainThread]: On master: COMMIT
[0m13:38:12.624634 [debug] [MainThread]: Using duckdb connection "master"
[0m13:38:12.624878 [debug] [MainThread]: On master: COMMIT
[0m13:38:12.625341 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:38:12.625619 [debug] [MainThread]: On master: Close
[0m13:38:12.625981 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:38:12.626270 [debug] [MainThread]: Connection 'model.medallion_dbt.fct_customer_transactions' was properly closed.
[0m13:38:12.626505 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m13:38:12.626815 [info ] [MainThread]: 
[0m13:38:12.627111 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m13:38:12.627778 [debug] [MainThread]: Command end result
[0m13:38:12.653269 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m13:38:12.659476 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m13:38:12.666228 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m13:38:12.666645 [info ] [MainThread]: 
[0m13:38:12.667132 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m13:38:12.667589 [info ] [MainThread]: 
[0m13:38:12.668051 [error] [MainThread]: [31mFailure in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)[0m
[0m13:38:12.668652 [error] [MainThread]:   Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  Binder Error: Column "transaction_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m13:38:12.669010 [info ] [MainThread]: 
[0m13:38:12.669397 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/fct_customer_transactions.sql
[0m13:38:12.669761 [info ] [MainThread]: 
[0m13:38:12.670188 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m13:38:12.670776 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Binder Error: Column "transaction_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m13:38:12.671059 [info ] [MainThread]: 
[0m13:38:12.671502 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m13:38:12.671993 [info ] [MainThread]: 
[0m13:38:12.672687 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=2
[0m13:38:12.673867 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:38:12.675049 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7564785, "process_in_blocks": "0", "process_kernel_time": 0.148107, "process_mem_max_rss": "158124", "process_out_blocks": "3248", "process_user_time": 3.008173}
[0m13:38:12.675539 [debug] [MainThread]: Command `dbt run` failed at 13:38:12.675452 after 1.76 seconds
[0m13:38:12.675913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727fdeda1420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727fd4d06b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727fe07e59c0>]}
[0m13:38:12.676313 [debug] [MainThread]: Flushing usage events
[0m13:38:13.372683 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:39:15.892839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae681b91420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae680b5c2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae680b5c250>]}


============================== 13:39:15.895038 | bef0977f-cb37-487b-b68f-619172069958 ==============================
[0m13:39:15.895038 [info ] [MainThread]: Running with dbt=1.10.15
[0m13:39:15.895478 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'invocation_command': 'dbt run --profiles-dir /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles --vars {"ds": "20251207", "clean_dir": "/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean"}', 'quiet': 'False', 'use_colors': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles', 'indirect_selection': 'eager', 'warn_error': 'None', 'write_json': 'True', 'fail_fast': 'False', 'log_path': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/logs', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'version_check': 'True', 'static_parser': 'True', 'empty': 'False', 'target_path': 'None'}
[0m13:39:16.095224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bef0977f-cb37-487b-b68f-619172069958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae680b21930>]}
[0m13:39:16.152782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bef0977f-cb37-487b-b68f-619172069958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae68133c760>]}
[0m13:39:16.154428 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:39:16.270989 [debug] [MainThread]: checksum: 505cc0738468dbf8af23784e25e0465f2f41e62e9895701049268b92bd4ad565, vars: {'clean_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean',
 'ds': '20251207'}, profile: , target: , version: 1.10.15
[0m13:39:16.401080 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:39:16.403515 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:39:16.443634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bef0977f-cb37-487b-b68f-619172069958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae678100130>]}
[0m13:39:16.613295 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m13:39:16.614970 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m13:39:16.628003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bef0977f-cb37-487b-b68f-619172069958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae678b8aa10>]}
[0m13:39:16.628878 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m13:39:16.629480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bef0977f-cb37-487b-b68f-619172069958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae678b881c0>]}
[0m13:39:16.631427 [info ] [MainThread]: 
[0m13:39:16.631844 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:39:16.632210 [info ] [MainThread]: 
[0m13:39:16.632709 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:39:16.637147 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m13:39:16.667410 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m13:39:16.667832 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m13:39:16.668124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:16.679088 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m13:39:16.682391 [debug] [ThreadPool]: On list_medallion: Close
[0m13:39:16.684023 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m13:39:16.685151 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m13:39:16.695886 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:39:16.696588 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m13:39:16.697022 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:39:16.698190 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:39:16.699365 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:39:16.699676 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m13:39:16.701211 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:39:16.701717 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:39:16.701990 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m13:39:16.702856 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:39:16.703864 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m13:39:16.704277 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:39:16.704672 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m13:39:16.705418 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:39:16.705826 [debug] [ThreadPool]: On create_medallion_main: Close
[0m13:39:16.707039 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m13:39:16.712692 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m13:39:16.713219 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m13:39:16.713633 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:39:16.714551 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:39:16.715032 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m13:39:16.715514 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m13:39:16.728334 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m13:39:16.731513 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m13:39:16.732425 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m13:39:16.732994 [debug] [ThreadPool]: On list_medallion_main: Close
[0m13:39:16.734041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bef0977f-cb37-487b-b68f-619172069958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae678dadf60>]}
[0m13:39:16.735257 [debug] [MainThread]: Using duckdb connection "master"
[0m13:39:16.735608 [debug] [MainThread]: On master: BEGIN
[0m13:39:16.735919 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:39:16.736867 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:39:16.737181 [debug] [MainThread]: On master: COMMIT
[0m13:39:16.737434 [debug] [MainThread]: Using duckdb connection "master"
[0m13:39:16.737674 [debug] [MainThread]: On master: COMMIT
[0m13:39:16.738103 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:39:16.738424 [debug] [MainThread]: On master: Close
[0m13:39:16.740868 [debug] [Thread-1 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m13:39:16.741696 [debug] [Thread-2 (]: Began running node model.medallion_dbt.stg_transactions
[0m13:39:16.742627 [info ] [Thread-1 (]: 1 of 2 START sql table model main.fct_customer_transactions .................... [RUN]
[0m13:39:16.743365 [info ] [Thread-2 (]: 2 of 2 START sql table model main.stg_transactions ............................. [RUN]
[0m13:39:16.744208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.fct_customer_transactions)
[0m13:39:16.744846 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.medallion_dbt.stg_transactions'
[0m13:39:16.745328 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.fct_customer_transactions
[0m13:39:16.745766 [debug] [Thread-2 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m13:39:16.754110 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.fct_customer_transactions"
[0m13:39:16.758202 [debug] [Thread-2 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m13:39:16.758873 [debug] [Thread-2 (]: Began executing node model.medallion_dbt.stg_transactions
[0m13:39:16.759237 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.fct_customer_transactions
[0m13:39:16.798287 [debug] [Thread-2 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m13:39:16.795272 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.fct_customer_transactions"
[0m13:39:16.799392 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:39:16.799836 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m13:39:16.800315 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m13:39:16.800655 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: BEGIN
[0m13:39:16.801043 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:39:16.801397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:16.803121 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:39:16.803596 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:39:16.804023 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:39:16.804424 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
    
    

    create  table
      "medallion"."main"."stg_transactions__dbt_tmp"
  
    as (
      




WITH src AS (
    SELECT *
    FROM read_parquet(
        '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean/transactions_20251207_clean.parquet'
    )
),

typed AS (

    SELECT
        CAST(transaction_id AS VARCHAR) AS transaction_id,
        CAST(customer_id AS VARCHAR) AS customer_id,
        CAST(amount AS DOUBLE) AS amount,
        LOWER(TRIM(status)) AS status,
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM src

),

final AS (

    SELECT
        transaction_id,
        customer_id,
        amount,
        status,
        transaction_ts,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed','pending','failed')

)

SELECT *
FROM final
    );
  
  
[0m13:39:16.804837 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m13:39:16.805370 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      




WITH source_clean AS (
    SELECT *
    FROM read_parquet(
        '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean/transactions_20251207_clean.parquet'
    )
),

typed AS (
    SELECT
        CAST(transaction_id AS VARCHAR) AS transaction_id,
        CAST(customer_id AS VARCHAR) AS customer_id,
        CAST(amount AS DOUBLE) AS amount,
        LOWER(TRIM(status)) AS status,
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM source_clean
),

validated AS (
    SELECT
        *,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed', 'pending', 'failed')
)

SELECT *
FROM validated
    );
  
  
[0m13:39:16.806045 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
    
    

    create  table
      "medallion"."main"."stg_transactions__dbt_tmp"
  
    as (
      




WITH src AS (
    SELECT *
    FROM read_parquet(
        '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean/transactions_20251207_clean.parquet'
    )
),

typed AS (

    SELECT
        CAST(transaction_id AS VARCHAR) AS transaction_id,
        CAST(customer_id AS VARCHAR) AS customer_id,
        CAST(amount AS DOUBLE) AS amount,
        LOWER(TRIM(status)) AS status,
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM src

),

final AS (

    SELECT
        transaction_id,
        customer_id,
        amount,
        status,
        transaction_ts,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed','pending','failed')

)

SELECT *
FROM final
    );
  
  
[0m13:39:16.806622 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      




WITH source_clean AS (
    SELECT *
    FROM read_parquet(
        '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean/transactions_20251207_clean.parquet'
    )
),

typed AS (
    SELECT
        CAST(transaction_id AS VARCHAR) AS transaction_id,
        CAST(customer_id AS VARCHAR) AS customer_id,
        CAST(amount AS DOUBLE) AS amount,
        LOWER(TRIM(status)) AS status,
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM source_clean
),

validated AS (
    SELECT
        *,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed', 'pending', 'failed')
)

SELECT *
FROM validated
    );
  
  
[0m13:39:16.806988 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m13:39:16.807364 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:39:16.807942 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m13:39:16.808750 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: ROLLBACK
[0m13:39:16.812497 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.fct_customer_transactions'
[0m13:39:16.813164 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: Close
[0m13:39:16.813888 [debug] [Thread-2 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m13:39:16.814454 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: Close
[0m13:39:16.815468 [debug] [Thread-1 (]: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  Binder Error: Column "transaction_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m13:39:16.817676 [debug] [Thread-2 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Binder Error: Column "transaction_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m13:39:16.818400 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bef0977f-cb37-487b-b68f-619172069958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae65b0d38e0>]}
[0m13:39:16.819202 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bef0977f-cb37-487b-b68f-619172069958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae65af9bdc0>]}
[0m13:39:16.819891 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model main.fct_customer_transactions ........... [[31mERROR[0m in 0.07s]
[0m13:39:16.820522 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model main.stg_transactions .................... [[31mERROR[0m in 0.07s]
[0m13:39:16.821142 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m13:39:16.821648 [debug] [Thread-2 (]: Finished running node model.medallion_dbt.stg_transactions
[0m13:39:16.822144 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.fct_customer_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  Binder Error: Column "transaction_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined.
[0m13:39:16.823368 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Binder Error: Column "transaction_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined.
[0m13:39:16.824428 [debug] [MainThread]: Using duckdb connection "master"
[0m13:39:16.824757 [debug] [MainThread]: On master: BEGIN
[0m13:39:16.825030 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:39:16.825729 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:39:16.826021 [debug] [MainThread]: On master: COMMIT
[0m13:39:16.826292 [debug] [MainThread]: Using duckdb connection "master"
[0m13:39:16.826533 [debug] [MainThread]: On master: COMMIT
[0m13:39:16.826940 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:39:16.827210 [debug] [MainThread]: On master: Close
[0m13:39:16.827558 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:39:16.827890 [debug] [MainThread]: Connection 'model.medallion_dbt.fct_customer_transactions' was properly closed.
[0m13:39:16.828250 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m13:39:16.828727 [info ] [MainThread]: 
[0m13:39:16.829053 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m13:39:16.829773 [debug] [MainThread]: Command end result
[0m13:39:16.849285 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m13:39:16.851043 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m13:39:16.857218 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m13:39:16.857631 [info ] [MainThread]: 
[0m13:39:16.857994 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m13:39:16.858297 [info ] [MainThread]: 
[0m13:39:16.858635 [error] [MainThread]: [31mFailure in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)[0m
[0m13:39:16.858954 [error] [MainThread]:   Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  Binder Error: Column "transaction_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m13:39:16.859305 [info ] [MainThread]: 
[0m13:39:16.859615 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/fct_customer_transactions.sql
[0m13:39:16.859871 [info ] [MainThread]: 
[0m13:39:16.860227 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m13:39:16.860532 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Binder Error: Column "transaction_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m13:39:16.860797 [info ] [MainThread]: 
[0m13:39:16.861099 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m13:39:16.861388 [info ] [MainThread]: 
[0m13:39:16.861672 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=2
[0m13:39:16.862413 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0174897, "process_in_blocks": "0", "process_kernel_time": 0.114774, "process_mem_max_rss": "151700", "process_out_blocks": "2224", "process_user_time": 2.129823}
[0m13:39:16.862850 [debug] [MainThread]: Command `dbt run` failed at 13:39:16.862774 after 1.02 seconds
[0m13:39:16.863225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae681b91420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae681a57010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae678b0aef0>]}
[0m13:39:16.863559 [debug] [MainThread]: Flushing usage events
[0m13:39:17.707429 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:42:42.895943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a52c695480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a52b6542b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a52b654250>]}


============================== 13:42:42.899070 | ca6d305b-5227-4948-bc68-67b3752963c8 ==============================
[0m13:42:42.899070 [info ] [MainThread]: Running with dbt=1.10.15
[0m13:42:42.899568 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'empty': 'False', 'log_format': 'default', 'debug': 'False', 'printer_width': '80', 'quiet': 'False', 'partial_parse': 'True', 'log_path': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/logs', 'profiles_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles', 'static_parser': 'True', 'warn_error': 'None', 'no_print': 'None', 'log_cache_events': 'False', 'use_colors': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles --vars {"ds": "20251207", "clean_dir": "/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean"}', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m13:42:43.079139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca6d305b-5227-4948-bc68-67b3752963c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a52e0799c0>]}
[0m13:42:43.132671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca6d305b-5227-4948-bc68-67b3752963c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a52bf16f50>]}
[0m13:42:43.134718 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:42:43.203490 [debug] [MainThread]: checksum: 505cc0738468dbf8af23784e25e0465f2f41e62e9895701049268b92bd4ad565, vars: {'clean_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean',
 'ds': '20251207'}, profile: , target: , version: 1.10.15
[0m13:42:43.297751 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:42:43.298960 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:42:43.336993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca6d305b-5227-4948-bc68-67b3752963c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a5234fc130>]}
[0m13:42:43.478630 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m13:42:43.480626 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m13:42:43.495118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca6d305b-5227-4948-bc68-67b3752963c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a523525150>]}
[0m13:42:43.495610 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m13:42:43.495963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca6d305b-5227-4948-bc68-67b3752963c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a523505360>]}
[0m13:42:43.497306 [info ] [MainThread]: 
[0m13:42:43.497649 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:42:43.497946 [info ] [MainThread]: 
[0m13:42:43.498568 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:42:43.506780 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m13:42:43.545032 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m13:42:43.545684 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m13:42:43.546209 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:42:43.561811 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m13:42:43.564030 [debug] [ThreadPool]: On list_medallion: Close
[0m13:42:43.564820 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m13:42:43.565356 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m13:42:43.573649 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:42:43.574204 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m13:42:43.574598 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:42:43.576001 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:42:43.578239 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:42:43.578689 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m13:42:43.579357 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:42:43.579648 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:42:43.579907 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m13:42:43.580788 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:42:43.581651 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m13:42:43.581963 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:42:43.582241 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m13:42:43.582799 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:42:43.583070 [debug] [ThreadPool]: On create_medallion_main: Close
[0m13:42:43.584146 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m13:42:43.588631 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m13:42:43.588977 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m13:42:43.589257 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:42:43.590113 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:42:43.590449 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m13:42:43.590729 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m13:42:43.600895 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m13:42:43.602088 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m13:42:43.602625 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m13:42:43.602917 [debug] [ThreadPool]: On list_medallion_main: Close
[0m13:42:43.603865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca6d305b-5227-4948-bc68-67b3752963c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a5238ae200>]}
[0m13:42:43.604393 [debug] [MainThread]: Using duckdb connection "master"
[0m13:42:43.604678 [debug] [MainThread]: On master: BEGIN
[0m13:42:43.604927 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:42:43.605582 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:42:43.605855 [debug] [MainThread]: On master: COMMIT
[0m13:42:43.606114 [debug] [MainThread]: Using duckdb connection "master"
[0m13:42:43.606370 [debug] [MainThread]: On master: COMMIT
[0m13:42:43.606785 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:42:43.607051 [debug] [MainThread]: On master: Close
[0m13:42:43.608821 [debug] [Thread-1 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m13:42:43.609181 [debug] [Thread-2 (]: Began running node model.medallion_dbt.stg_transactions
[0m13:42:43.609691 [info ] [Thread-1 (]: 1 of 2 START sql table model main.fct_customer_transactions .................... [RUN]
[0m13:42:43.610191 [info ] [Thread-2 (]: 2 of 2 START sql table model main.stg_transactions ............................. [RUN]
[0m13:42:43.610736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.fct_customer_transactions)
[0m13:42:43.611292 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.medallion_dbt.stg_transactions'
[0m13:42:43.611671 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.fct_customer_transactions
[0m13:42:43.612069 [debug] [Thread-2 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m13:42:43.619699 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.fct_customer_transactions"
[0m13:42:43.623685 [debug] [Thread-2 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m13:42:43.624329 [debug] [Thread-2 (]: Began executing node model.medallion_dbt.stg_transactions
[0m13:42:43.630250 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.fct_customer_transactions
[0m13:42:43.660448 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.fct_customer_transactions"
[0m13:42:43.661041 [debug] [Thread-2 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m13:42:43.661834 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:42:43.662304 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m13:42:43.662860 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m13:42:43.663298 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: BEGIN
[0m13:42:43.663682 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:42:43.664050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:42:43.665419 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:42:43.665791 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:42:43.666141 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:42:43.666506 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
    
    

    create  table
      "medallion"."main"."stg_transactions__dbt_tmp"
  
    as (
      




WITH src AS (
    SELECT *
    FROM read_parquet(
        '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean/transactions_20251207_clean.parquet'
    )
),

typed AS (

    SELECT
        CAST(transaction_id AS VARCHAR) AS transaction_id,
        CAST(customer_id AS VARCHAR) AS customer_id,
        CAST(amount AS DOUBLE) AS amount,
        LOWER(TRIM(status)) AS status,
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM src

),

final AS (

    SELECT
        transaction_id,
        customer_id,
        amount,
        status,
        transaction_ts,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed','pending','failed')

)

SELECT *
FROM final
    );
  
  
[0m13:42:43.666854 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m13:42:43.667388 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      




WITH source_clean AS (
    SELECT *
    FROM read_parquet(
        '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean/transactions_20251207_clean.parquet'
    )
),

typed AS (
    SELECT
        CAST(transaction_id AS VARCHAR) AS transaction_id,
        CAST(customer_id AS VARCHAR) AS customer_id,
        CAST(amount AS DOUBLE) AS amount,
        LOWER(TRIM(status)) AS status,
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM source_clean
),

validated AS (
    SELECT
        *,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed', 'pending', 'failed')
)

SELECT *
FROM validated
    );
  
  
[0m13:42:43.668015 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
    
    

    create  table
      "medallion"."main"."stg_transactions__dbt_tmp"
  
    as (
      




WITH src AS (
    SELECT *
    FROM read_parquet(
        '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean/transactions_20251207_clean.parquet'
    )
),

typed AS (

    SELECT
        CAST(transaction_id AS VARCHAR) AS transaction_id,
        CAST(customer_id AS VARCHAR) AS customer_id,
        CAST(amount AS DOUBLE) AS amount,
        LOWER(TRIM(status)) AS status,
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM src

),

final AS (

    SELECT
        transaction_id,
        customer_id,
        amount,
        status,
        transaction_ts,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed','pending','failed')

)

SELECT *
FROM final
    );
  
  
[0m13:42:43.668460 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m13:42:43.668983 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      




WITH source_clean AS (
    SELECT *
    FROM read_parquet(
        '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean/transactions_20251207_clean.parquet'
    )
),

typed AS (
    SELECT
        CAST(transaction_id AS VARCHAR) AS transaction_id,
        CAST(customer_id AS VARCHAR) AS customer_id,
        CAST(amount AS DOUBLE) AS amount,
        LOWER(TRIM(status)) AS status,
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM source_clean
),

validated AS (
    SELECT
        *,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed', 'pending', 'failed')
)

SELECT *
FROM validated
    );
  
  
[0m13:42:43.669593 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m13:42:43.670028 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:42:43.671064 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: ROLLBACK
[0m13:42:43.673447 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.fct_customer_transactions'
[0m13:42:43.673808 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: Close
[0m13:42:43.674395 [debug] [Thread-2 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m13:42:43.674789 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: Close
[0m13:42:43.675748 [debug] [Thread-2 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Binder Error: Column "transaction_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m13:42:43.677718 [debug] [Thread-1 (]: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  Binder Error: Column "transaction_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m13:42:43.678303 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca6d305b-5227-4948-bc68-67b3752963c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a52c973040>]}
[0m13:42:43.678641 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca6d305b-5227-4948-bc68-67b3752963c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a521b288b0>]}
[0m13:42:43.679317 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model main.stg_transactions .................... [[31mERROR[0m in 0.06s]
[0m13:42:43.680071 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model main.fct_customer_transactions ........... [[31mERROR[0m in 0.07s]
[0m13:42:43.680686 [debug] [Thread-2 (]: Finished running node model.medallion_dbt.stg_transactions
[0m13:42:43.681191 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m13:42:43.681755 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Binder Error: Column "transaction_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined.
[0m13:42:43.682794 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.fct_customer_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  Binder Error: Column "transaction_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined.
[0m13:42:43.684036 [debug] [MainThread]: Using duckdb connection "master"
[0m13:42:43.684391 [debug] [MainThread]: On master: BEGIN
[0m13:42:43.684683 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:42:43.685403 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:42:43.685685 [debug] [MainThread]: On master: COMMIT
[0m13:42:43.685939 [debug] [MainThread]: Using duckdb connection "master"
[0m13:42:43.686193 [debug] [MainThread]: On master: COMMIT
[0m13:42:43.686647 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:42:43.686976 [debug] [MainThread]: On master: Close
[0m13:42:43.687387 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:42:43.687646 [debug] [MainThread]: Connection 'model.medallion_dbt.fct_customer_transactions' was properly closed.
[0m13:42:43.687880 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m13:42:43.688183 [info ] [MainThread]: 
[0m13:42:43.688466 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m13:42:43.689072 [debug] [MainThread]: Command end result
[0m13:42:43.707367 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m13:42:43.708832 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m13:42:43.714479 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m13:42:43.714855 [info ] [MainThread]: 
[0m13:42:43.715285 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m13:42:43.715609 [info ] [MainThread]: 
[0m13:42:43.715940 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m13:42:43.716262 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Binder Error: Column "transaction_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m13:42:43.716508 [info ] [MainThread]: 
[0m13:42:43.716789 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m13:42:43.717033 [info ] [MainThread]: 
[0m13:42:43.717325 [error] [MainThread]: [31mFailure in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)[0m
[0m13:42:43.717607 [error] [MainThread]:   Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  Binder Error: Column "transaction_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m13:42:43.717840 [info ] [MainThread]: 
[0m13:42:43.718123 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/fct_customer_transactions.sql
[0m13:42:43.718359 [info ] [MainThread]: 
[0m13:42:43.718621 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=2
[0m13:42:43.719355 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8694303, "process_in_blocks": "0", "process_kernel_time": 0.09103, "process_mem_max_rss": "151636", "process_out_blocks": "2216", "process_user_time": 1.776595}
[0m13:42:43.719733 [debug] [MainThread]: Command `dbt run` failed at 13:42:43.719662 after 0.87 seconds
[0m13:42:43.720059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a52c695480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a52c70d5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a52e079d20>]}
[0m13:42:43.720405 [debug] [MainThread]: Flushing usage events
[0m13:42:44.401273 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:43:46.427237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78992a7613f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789929704250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7899297041f0>]}


============================== 13:43:46.429908 | 99954e07-2b41-493d-b15d-3161a326e890 ==============================
[0m13:43:46.429908 [info ] [MainThread]: Running with dbt=1.10.15
[0m13:43:46.430480 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'target_path': 'None', 'fail_fast': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'profiles_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles', 'debug': 'False', 'write_json': 'True', 'log_path': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/logs', 'introspect': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'invocation_command': 'dbt run --profiles-dir /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles --vars {"ds": "20251207", "clean_dir": "/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean"}', 'log_cache_events': 'False', 'quiet': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'static_parser': 'True', 'version_check': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:43:46.632534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99954e07-2b41-493d-b15d-3161a326e890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78992a7db190>]}
[0m13:43:46.691288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99954e07-2b41-493d-b15d-3161a326e890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789929702bc0>]}
[0m13:43:46.692835 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:43:46.764399 [debug] [MainThread]: checksum: 505cc0738468dbf8af23784e25e0465f2f41e62e9895701049268b92bd4ad565, vars: {'clean_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean',
 'ds': '20251207'}, profile: , target: , version: 1.10.15
[0m13:43:46.867205 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:43:46.868638 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:43:46.909145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99954e07-2b41-493d-b15d-3161a326e890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7899217e4130>]}
[0m13:43:47.052415 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m13:43:47.054485 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m13:43:47.065881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99954e07-2b41-493d-b15d-3161a326e890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7899217e80a0>]}
[0m13:43:47.066470 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m13:43:47.066834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99954e07-2b41-493d-b15d-3161a326e890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7899217e9e10>]}
[0m13:43:47.068356 [info ] [MainThread]: 
[0m13:43:47.068705 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:43:47.068969 [info ] [MainThread]: 
[0m13:43:47.069398 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:43:47.073757 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m13:43:47.105921 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m13:43:47.106382 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m13:43:47.106668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:47.122060 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m13:43:47.123391 [debug] [ThreadPool]: On list_medallion: Close
[0m13:43:47.124060 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m13:43:47.124532 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m13:43:47.131544 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:43:47.132073 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m13:43:47.132385 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:47.133533 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:43:47.134554 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:43:47.134825 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m13:43:47.135400 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:43:47.135663 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:43:47.135901 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m13:43:47.136390 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:43:47.137191 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m13:43:47.137477 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:43:47.137726 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m13:43:47.138135 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:43:47.138403 [debug] [ThreadPool]: On create_medallion_main: Close
[0m13:43:47.139394 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m13:43:47.144151 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m13:43:47.144839 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m13:43:47.145196 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:47.146338 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:43:47.146727 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m13:43:47.147100 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m13:43:47.158380 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m13:43:47.159655 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m13:43:47.160239 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m13:43:47.160585 [debug] [ThreadPool]: On list_medallion_main: Close
[0m13:43:47.161533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99954e07-2b41-493d-b15d-3161a326e890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789921babd00>]}
[0m13:43:47.162344 [debug] [MainThread]: Using duckdb connection "master"
[0m13:43:47.162681 [debug] [MainThread]: On master: BEGIN
[0m13:43:47.162966 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:43:47.164947 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m13:43:47.165363 [debug] [MainThread]: On master: COMMIT
[0m13:43:47.165666 [debug] [MainThread]: Using duckdb connection "master"
[0m13:43:47.165952 [debug] [MainThread]: On master: COMMIT
[0m13:43:47.166454 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:43:47.166748 [debug] [MainThread]: On master: Close
[0m13:43:47.168741 [debug] [Thread-1 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m13:43:47.169284 [info ] [Thread-1 (]: 1 of 2 START sql table model main.fct_customer_transactions .................... [RUN]
[0m13:43:47.169803 [debug] [Thread-2 (]: Began running node model.medallion_dbt.stg_transactions
[0m13:43:47.170355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.fct_customer_transactions)
[0m13:43:47.170831 [info ] [Thread-2 (]: 2 of 2 START sql table model main.stg_transactions ............................. [RUN]
[0m13:43:47.171292 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.fct_customer_transactions
[0m13:43:47.171778 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.medallion_dbt.stg_transactions'
[0m13:43:47.179576 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.fct_customer_transactions"
[0m13:43:47.180603 [debug] [Thread-2 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m13:43:47.187587 [debug] [Thread-2 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m13:43:47.188206 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.fct_customer_transactions
[0m13:43:47.209200 [debug] [Thread-2 (]: Began executing node model.medallion_dbt.stg_transactions
[0m13:43:47.221818 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.fct_customer_transactions"
[0m13:43:47.227365 [debug] [Thread-2 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m13:43:47.228327 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m13:43:47.229210 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: BEGIN
[0m13:43:47.229736 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:43:47.230217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:47.230668 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m13:43:47.232093 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:43:47.232600 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:43:47.232961 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m13:43:47.233303 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:43:47.233695 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      




WITH source_clean AS (
    SELECT *
    FROM read_parquet(
        '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean/transactions_20251207_clean.parquet'
    )
),

typed AS (
    SELECT
        CAST(transaction_id AS VARCHAR) AS transaction_id,
        CAST(customer_id AS VARCHAR) AS customer_id,
        CAST(amount AS DOUBLE) AS amount,
        LOWER(TRIM(status)) AS status,
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM source_clean
),

validated AS (
    SELECT
        *,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed', 'pending', 'failed')
)

SELECT *
FROM validated
    );
  
  
[0m13:43:47.234091 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:43:47.234605 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
    
    

    create  table
      "medallion"."main"."stg_transactions__dbt_tmp"
  
    as (
      




WITH src AS (
    SELECT *
    FROM read_parquet(
        '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean/transactions_20251207_clean.parquet'
    )
),

typed AS (

    SELECT
        CAST(transaction_id AS VARCHAR) AS transaction_id,
        CAST(customer_id AS VARCHAR) AS customer_id,
        CAST(amount AS DOUBLE) AS amount,
        LOWER(TRIM(status)) AS status,
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM src

),

final AS (

    SELECT
        transaction_id,
        customer_id,
        amount,
        status,
        transaction_ts,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed','pending','failed')

)

SELECT *
FROM final
    );
  
  
[0m13:43:47.235164 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      




WITH source_clean AS (
    SELECT *
    FROM read_parquet(
        '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean/transactions_20251207_clean.parquet'
    )
),

typed AS (
    SELECT
        CAST(transaction_id AS VARCHAR) AS transaction_id,
        CAST(customer_id AS VARCHAR) AS customer_id,
        CAST(amount AS DOUBLE) AS amount,
        LOWER(TRIM(status)) AS status,
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM source_clean
),

validated AS (
    SELECT
        *,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed', 'pending', 'failed')
)

SELECT *
FROM validated
    );
  
  
[0m13:43:47.235574 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
    
    

    create  table
      "medallion"."main"."stg_transactions__dbt_tmp"
  
    as (
      




WITH src AS (
    SELECT *
    FROM read_parquet(
        '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean/transactions_20251207_clean.parquet'
    )
),

typed AS (

    SELECT
        CAST(transaction_id AS VARCHAR) AS transaction_id,
        CAST(customer_id AS VARCHAR) AS customer_id,
        CAST(amount AS DOUBLE) AS amount,
        LOWER(TRIM(status)) AS status,
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM src

),

final AS (

    SELECT
        transaction_id,
        customer_id,
        amount,
        status,
        transaction_ts,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed','pending','failed')

)

SELECT *
FROM final
    );
  
  
[0m13:43:47.236043 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:43:47.236400 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m13:43:47.236927 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: ROLLBACK
[0m13:43:47.237454 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m13:43:47.240132 [debug] [Thread-2 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m13:43:47.241033 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.fct_customer_transactions'
[0m13:43:47.241641 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: Close
[0m13:43:47.242068 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: Close
[0m13:43:47.243311 [debug] [Thread-2 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Binder Error: Column "transaction_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m13:43:47.245509 [debug] [Thread-1 (]: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  Binder Error: Column "transaction_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m13:43:47.246059 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99954e07-2b41-493d-b15d-3161a326e890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7899204d3cd0>]}
[0m13:43:47.246652 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99954e07-2b41-493d-b15d-3161a326e890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789921614700>]}
[0m13:43:47.247483 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model main.stg_transactions .................... [[31mERROR[0m in 0.07s]
[0m13:43:47.248354 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model main.fct_customer_transactions ........... [[31mERROR[0m in 0.08s]
[0m13:43:47.249096 [debug] [Thread-2 (]: Finished running node model.medallion_dbt.stg_transactions
[0m13:43:47.249767 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m13:43:47.250742 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Binder Error: Column "transaction_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined.
[0m13:43:47.252610 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.fct_customer_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  Binder Error: Column "transaction_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined.
[0m13:43:47.254373 [debug] [MainThread]: Using duckdb connection "master"
[0m13:43:47.254690 [debug] [MainThread]: On master: BEGIN
[0m13:43:47.254986 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:43:47.255789 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:43:47.256131 [debug] [MainThread]: On master: COMMIT
[0m13:43:47.256427 [debug] [MainThread]: Using duckdb connection "master"
[0m13:43:47.256680 [debug] [MainThread]: On master: COMMIT
[0m13:43:47.257129 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:43:47.257411 [debug] [MainThread]: On master: Close
[0m13:43:47.257880 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:43:47.258261 [debug] [MainThread]: Connection 'model.medallion_dbt.fct_customer_transactions' was properly closed.
[0m13:43:47.258647 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m13:43:47.259132 [info ] [MainThread]: 
[0m13:43:47.259612 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m13:43:47.260398 [debug] [MainThread]: Command end result
[0m13:43:47.281768 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m13:43:47.286599 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m13:43:47.292360 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m13:43:47.292742 [info ] [MainThread]: 
[0m13:43:47.293086 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m13:43:47.293416 [info ] [MainThread]: 
[0m13:43:47.293740 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m13:43:47.294040 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Binder Error: Column "transaction_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m13:43:47.294292 [info ] [MainThread]: 
[0m13:43:47.294654 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m13:43:47.295056 [info ] [MainThread]: 
[0m13:43:47.295515 [error] [MainThread]: [31mFailure in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)[0m
[0m13:43:47.295860 [error] [MainThread]:   Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  Binder Error: Column "transaction_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m13:43:47.296146 [info ] [MainThread]: 
[0m13:43:47.296462 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/fct_customer_transactions.sql
[0m13:43:47.296878 [info ] [MainThread]: 
[0m13:43:47.297500 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=2
[0m13:43:47.298917 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9201704, "process_in_blocks": "0", "process_kernel_time": 0.105842, "process_mem_max_rss": "151464", "process_out_blocks": "2216", "process_user_time": 1.897174}
[0m13:43:47.299423 [debug] [MainThread]: Command `dbt run` failed at 13:43:47.299333 after 0.92 seconds
[0m13:43:47.299773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78992a7613f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7899217d48b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7899217d4760>]}
[0m13:43:47.300162 [debug] [MainThread]: Flushing usage events
[0m13:43:47.975715 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:30:43.536819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db87ba99480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db87aa682b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db87aa68250>]}


============================== 18:30:43.539141 | df24cbdb-eb01-496f-b517-d504f24728fc ==============================
[0m18:30:43.539141 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:30:43.539588 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'log_format': 'default', 'printer_width': '80', 'cache_selected_only': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --profiles-dir /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles --vars {"ds": "20251207", "clean_dir": "/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean"}', 'quiet': 'False', 'warn_error': 'None', 'target_path': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'debug': 'False', 'empty': 'False', 'log_path': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'profiles_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles', 'no_print': 'None'}
[0m18:30:43.798521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df24cbdb-eb01-496f-b517-d504f24728fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db87b995630>]}
[0m18:30:43.868862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df24cbdb-eb01-496f-b517-d504f24728fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db87b30a680>]}
[0m18:30:43.870967 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:30:43.953851 [debug] [MainThread]: checksum: 505cc0738468dbf8af23784e25e0465f2f41e62e9895701049268b92bd4ad565, vars: {'clean_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean',
 'ds': '20251207'}, profile: , target: , version: 1.10.15
[0m18:30:44.076512 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:30:44.081329 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:30:44.127595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df24cbdb-eb01-496f-b517-d504f24728fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db87290c130>]}
[0m18:30:44.334318 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m18:30:44.337050 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m18:30:44.354473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df24cbdb-eb01-496f-b517-d504f24728fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db872930790>]}
[0m18:30:44.355323 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m18:30:44.355814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df24cbdb-eb01-496f-b517-d504f24728fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db872930d60>]}
[0m18:30:44.358519 [info ] [MainThread]: 
[0m18:30:44.359456 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:30:44.360374 [info ] [MainThread]: 
[0m18:30:44.361254 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:30:44.368043 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m18:30:44.404502 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m18:30:44.405231 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m18:30:44.405577 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:30:44.427866 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m18:30:44.430989 [debug] [ThreadPool]: On list_medallion: Close
[0m18:30:44.433825 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m18:30:44.434722 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m18:30:44.444763 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m18:30:44.447121 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m18:30:44.448098 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:30:44.450415 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:30:44.451630 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m18:30:44.452001 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m18:30:44.452712 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:30:44.453073 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m18:30:44.453461 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m18:30:44.454116 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:30:44.455048 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m18:30:44.455454 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m18:30:44.455843 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m18:30:44.456515 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:30:44.457004 [debug] [ThreadPool]: On create_medallion_main: Close
[0m18:30:44.459985 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m18:30:44.471785 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m18:30:44.472315 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m18:30:44.472639 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:30:44.473423 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:30:44.473739 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m18:30:44.474014 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m18:30:44.485614 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:30:44.487384 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m18:30:44.488448 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m18:30:44.488855 [debug] [ThreadPool]: On list_medallion_main: Close
[0m18:30:44.489779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df24cbdb-eb01-496f-b517-d504f24728fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db872cba1a0>]}
[0m18:30:44.490879 [debug] [MainThread]: Using duckdb connection "master"
[0m18:30:44.491354 [debug] [MainThread]: On master: BEGIN
[0m18:30:44.491740 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:30:44.495463 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:30:44.497241 [debug] [MainThread]: On master: COMMIT
[0m18:30:44.498436 [debug] [MainThread]: Using duckdb connection "master"
[0m18:30:44.499001 [debug] [MainThread]: On master: COMMIT
[0m18:30:44.500282 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:30:44.500854 [debug] [MainThread]: On master: Close
[0m18:30:44.503754 [debug] [Thread-1 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m18:30:44.504421 [debug] [Thread-2 (]: Began running node model.medallion_dbt.stg_transactions
[0m18:30:44.505456 [info ] [Thread-1 (]: 1 of 2 START sql table model main.fct_customer_transactions .................... [RUN]
[0m18:30:44.507134 [info ] [Thread-2 (]: 2 of 2 START sql table model main.stg_transactions ............................. [RUN]
[0m18:30:44.510200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.fct_customer_transactions)
[0m18:30:44.512774 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.medallion_dbt.stg_transactions'
[0m18:30:44.513885 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.fct_customer_transactions
[0m18:30:44.514640 [debug] [Thread-2 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m18:30:44.523426 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.fct_customer_transactions"
[0m18:30:44.534297 [debug] [Thread-2 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m18:30:44.535383 [debug] [Thread-2 (]: Began executing node model.medallion_dbt.stg_transactions
[0m18:30:44.535903 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.fct_customer_transactions
[0m18:30:44.604755 [debug] [Thread-2 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m18:30:44.603103 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.fct_customer_transactions"
[0m18:30:44.605835 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m18:30:44.606377 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m18:30:44.607227 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m18:30:44.608074 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: BEGIN
[0m18:30:44.608914 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:30:44.609822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:30:44.613338 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m18:30:44.616059 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m18:30:44.618281 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
    
    

    create  table
      "medallion"."main"."stg_transactions__dbt_tmp"
  
    as (
      




WITH src AS (
    SELECT *
    FROM read_parquet(
        '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean/transactions_20251207_clean.parquet'
    )
),

typed AS (

    SELECT
        CAST(transaction_id AS VARCHAR) AS transaction_id,
        CAST(customer_id AS VARCHAR) AS customer_id,
        CAST(amount AS DOUBLE) AS amount,
        LOWER(TRIM(status)) AS status,
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM src

),

final AS (

    SELECT
        transaction_id,
        customer_id,
        amount,
        status,
        transaction_ts,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed','pending','failed')

)

SELECT *
FROM final
    );
  
  
[0m18:30:44.619614 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m18:30:44.621577 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m18:30:44.622376 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      




WITH source_clean AS (
    SELECT *
    FROM read_parquet(
        '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean/transactions_20251207_clean.parquet'
    )
),

typed AS (
    SELECT
        CAST(transaction_id AS VARCHAR) AS transaction_id,
        CAST(customer_id AS VARCHAR) AS customer_id,
        CAST(amount AS DOUBLE) AS amount,
        LOWER(TRIM(status)) AS status,
        CAST(transaction_ts AS TIMESTAMP) AS transaction_ts
    FROM source_clean
),

validated AS (
    SELECT
        *,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed', 'pending', 'failed')
)

SELECT *
FROM validated
    );
  
  
[0m18:30:44.625131 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m18:30:44.629980 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m18:30:44.630573 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m18:30:44.631212 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_transactions'
  
[0m18:30:44.651134 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m18:30:44.651948 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */
alter table "medallion"."main"."fct_customer_transactions__dbt_tmp" rename to "fct_customer_transactions"
[0m18:30:44.652625 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m18:30:44.653263 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:30:44.654526 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m18:30:44.671224 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: COMMIT
[0m18:30:44.671795 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_transactions'
  
[0m18:30:44.672408 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m18:30:44.673001 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: COMMIT
[0m18:30:44.673762 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:30:44.681809 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m18:30:44.682810 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m18:30:44.683688 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */
alter table "medallion"."main"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m18:30:44.689177 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m18:30:44.689998 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

      drop table if exists "medallion"."main"."fct_customer_transactions__dbt_backup" cascade
    
[0m18:30:44.690830 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:30:44.697765 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m18:30:44.698909 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m18:30:44.700136 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */
alter table "medallion"."main"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m18:30:44.706545 [debug] [Thread-1 (]: On model.medallion_dbt.fct_customer_transactions: Close
[0m18:30:44.709614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df24cbdb-eb01-496f-b517-d504f24728fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db872956a70>]}
[0m18:30:44.710243 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m18:30:44.711251 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.fct_customer_transactions ............... [[32mOK[0m in 0.20s]
[0m18:30:44.718812 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m18:30:44.720098 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m18:30:44.720669 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m18:30:44.721406 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m18:30:44.723147 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:30:44.726594 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m18:30:44.727141 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

      drop table if exists "medallion"."main"."stg_transactions__dbt_backup" cascade
    
[0m18:30:44.729124 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:30:44.731991 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: Close
[0m18:30:44.732752 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df24cbdb-eb01-496f-b517-d504f24728fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db872919030>]}
[0m18:30:44.733380 [info ] [Thread-2 (]: 2 of 2 OK created sql table model main.stg_transactions ........................ [[32mOK[0m in 0.22s]
[0m18:30:44.733848 [debug] [Thread-2 (]: Finished running node model.medallion_dbt.stg_transactions
[0m18:30:44.734928 [debug] [MainThread]: Using duckdb connection "master"
[0m18:30:44.735247 [debug] [MainThread]: On master: BEGIN
[0m18:30:44.735538 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:30:44.736248 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:30:44.736611 [debug] [MainThread]: On master: COMMIT
[0m18:30:44.736971 [debug] [MainThread]: Using duckdb connection "master"
[0m18:30:44.737242 [debug] [MainThread]: On master: COMMIT
[0m18:30:44.737916 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:30:44.738219 [debug] [MainThread]: On master: Close
[0m18:30:44.738591 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:30:44.738852 [debug] [MainThread]: Connection 'model.medallion_dbt.fct_customer_transactions' was properly closed.
[0m18:30:44.739097 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m18:30:44.739420 [info ] [MainThread]: 
[0m18:30:44.739985 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m18:30:44.741985 [debug] [MainThread]: Command end result
[0m18:30:44.769675 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m18:30:44.771534 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m18:30:44.778911 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m18:30:44.780921 [info ] [MainThread]: 
[0m18:30:44.781656 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:30:44.782133 [info ] [MainThread]: 
[0m18:30:44.782574 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m18:30:44.783860 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3016477, "process_in_blocks": "0", "process_kernel_time": 0.155928, "process_mem_max_rss": "151952", "process_out_blocks": "2248", "process_user_time": 2.450872}
[0m18:30:44.784314 [debug] [MainThread]: Command `dbt run` succeeded at 18:30:44.784229 after 1.30 seconds
[0m18:30:44.784680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db87ba99480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db87b995630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db8728ff9d0>]}
[0m18:30:44.785083 [debug] [MainThread]: Flushing usage events
[0m18:30:45.815178 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:30:48.520339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cbdc2f993f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cbdc1f68280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cbdc1f68220>]}


============================== 18:30:48.524748 | e93f4c48-e329-4e4e-aad9-aa207f5cdc55 ==============================
[0m18:30:48.524748 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:30:48.526346 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'no_print': 'None', 'target_path': 'None', 'cache_selected_only': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test --profiles-dir /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles --vars {"ds": "20251207", "clean_dir": "/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean"}', 'profiles_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles', 'log_format': 'default', 'log_path': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/logs', 'use_experimental_parser': 'False', 'warn_error': 'None', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'debug': 'False', 'printer_width': '80', 'use_colors': 'True'}
[0m18:30:48.774384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e93f4c48-e329-4e4e-aad9-aa207f5cdc55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cbdc49a99c0>]}
[0m18:30:48.840193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e93f4c48-e329-4e4e-aad9-aa207f5cdc55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cbdc27d9ff0>]}
[0m18:30:48.841737 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:30:48.918253 [debug] [MainThread]: checksum: 505cc0738468dbf8af23784e25e0465f2f41e62e9895701049268b92bd4ad565, vars: {'clean_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean',
 'ds': '20251207'}, profile: , target: , version: 1.10.15
[0m18:30:49.044465 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:30:49.046800 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:30:49.093815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e93f4c48-e329-4e4e-aad9-aa207f5cdc55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cbdb8f0c130>]}
[0m18:30:49.252025 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m18:30:49.253771 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m18:30:49.276672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e93f4c48-e329-4e4e-aad9-aa207f5cdc55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cbdb9fab8e0>]}
[0m18:30:49.277195 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m18:30:49.277570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e93f4c48-e329-4e4e-aad9-aa207f5cdc55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cbdb9f8c1c0>]}
[0m18:30:49.279332 [info ] [MainThread]: 
[0m18:30:49.279663 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:30:49.279938 [info ] [MainThread]: 
[0m18:30:49.280551 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:30:49.284898 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion_main'
[0m18:30:49.316174 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m18:30:49.316897 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m18:30:49.317398 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:30:49.329435 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m18:30:49.329893 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m18:30:49.330214 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m18:30:49.341285 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:30:49.344436 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m18:30:49.344998 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m18:30:49.345324 [debug] [ThreadPool]: On list_medallion_main: Close
[0m18:30:49.346165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e93f4c48-e329-4e4e-aad9-aa207f5cdc55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cbdb9fab8e0>]}
[0m18:30:49.346623 [debug] [MainThread]: Using duckdb connection "master"
[0m18:30:49.346956 [debug] [MainThread]: On master: BEGIN
[0m18:30:49.347252 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:30:49.348035 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:30:49.348316 [debug] [MainThread]: On master: COMMIT
[0m18:30:49.348574 [debug] [MainThread]: Using duckdb connection "master"
[0m18:30:49.348821 [debug] [MainThread]: On master: COMMIT
[0m18:30:49.349240 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:30:49.349513 [debug] [MainThread]: On master: Close
[0m18:30:49.351412 [debug] [Thread-1 (]: Began running node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m18:30:49.351812 [debug] [Thread-2 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m18:30:49.352255 [debug] [Thread-3 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m18:30:49.352965 [debug] [Thread-4 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m18:30:49.352644 [info ] [Thread-1 (]: 1 of 16 START test accepted_values_stg_transactions_status__completed__pending__failed  [RUN]
[0m18:30:49.353563 [info ] [Thread-2 (]: 2 of 16 START test non_negative_fct_customer_transactions_total_amount_all ..... [RUN]
[0m18:30:49.354175 [info ] [Thread-3 (]: 3 of 16 START test non_negative_fct_customer_transactions_total_amount_completed  [RUN]
[0m18:30:49.354629 [info ] [Thread-4 (]: 4 of 16 START test non_negative_fct_customer_transactions_transaction_count .... [RUN]
[0m18:30:49.355147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26)
[0m18:30:49.355666 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89'
[0m18:30:49.357398 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428'
[0m18:30:49.359064 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4'
[0m18:30:49.359883 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m18:30:49.360598 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m18:30:49.363772 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m18:30:49.364343 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m18:30:49.380828 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m18:30:49.385692 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m18:30:49.389305 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m18:30:49.399418 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m18:30:49.400857 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m18:30:49.401604 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m18:30:49.402014 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m18:30:49.402455 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m18:30:49.418989 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m18:30:49.423788 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m18:30:49.427812 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m18:30:49.430254 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m18:30:49.431168 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m18:30:49.431643 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m18:30:49.432167 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: BEGIN
[0m18:30:49.432617 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m18:30:49.433152 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: BEGIN
[0m18:30:49.433511 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m18:30:49.433840 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:30:49.434226 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: BEGIN
[0m18:30:49.434686 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:30:49.435045 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: BEGIN
[0m18:30:49.435694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:30:49.436335 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:30:49.436652 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:30:49.436959 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:30:49.437465 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m18:30:49.438091 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:30:49.439762 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m18:30:49.438878 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:30:49.439337 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all < 0 or total_amount_all is null


  
  
      
    ) dbt_internal_test
[0m18:30:49.438438 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m18:30:49.440108 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "medallion"."main"."stg_transactions"
    group by status

)

select *
from all_values
where value_field not in (
    'completed','pending','failed'
)



  
  
      
    ) dbt_internal_test
[0m18:30:49.440560 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m18:30:49.442475 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed < 0 or total_amount_completed is null


  
  
      
    ) dbt_internal_test
[0m18:30:49.443221 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all < 0 or total_amount_all is null


  
  
      
    ) dbt_internal_test
[0m18:30:49.444181 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count < 0 or transaction_count is null


  
  
      
    ) dbt_internal_test
[0m18:30:49.445211 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m18:30:49.445928 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed < 0 or total_amount_completed is null


  
  
      
    ) dbt_internal_test
[0m18:30:49.446773 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: ROLLBACK
[0m18:30:49.447244 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count < 0 or transaction_count is null


  
  
      
    ) dbt_internal_test
[0m18:30:49.447624 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m18:30:49.448033 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:30:49.448540 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m18:30:49.449152 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: ROLLBACK
[0m18:30:49.449717 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: ROLLBACK
[0m18:30:49.453698 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: ROLLBACK
[0m18:30:49.454953 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26'
[0m18:30:49.455482 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: Close
[0m18:30:49.456327 [info ] [Thread-1 (]: 1 of 16 PASS accepted_values_stg_transactions_status__completed__pending__failed  [[32mPASS[0m in 0.10s]
[0m18:30:49.457118 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m18:30:49.457654 [debug] [Thread-1 (]: Began running node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m18:30:49.458254 [info ] [Thread-1 (]: 5 of 16 START test non_negative_stg_transactions_amount ........................ [RUN]
[0m18:30:49.459515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26, now test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733)
[0m18:30:49.460428 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m18:30:49.469039 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m18:30:49.470433 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428'
[0m18:30:49.470929 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: Close
[0m18:30:49.471651 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89'
[0m18:30:49.472253 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m18:30:49.472992 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4'
[0m18:30:49.473832 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: Close
[0m18:30:49.480515 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m18:30:49.481700 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: Close
[0m18:30:49.482354 [debug] [Thread-3 (]: Runtime Error in test non_negative_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)
  Binder Error: Referenced column "total_amount_completed" not found in FROM clause!
  Candidate bindings: "transaction_date", "amount", "transaction_id", "transaction_ts", "status"
  
  LINE 17: where total_amount_completed < 0 or total_amount_completed is...
                 ^
[0m18:30:49.483573 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m18:30:49.484154 [error] [Thread-3 (]: 3 of 16 ERROR non_negative_fct_customer_transactions_total_amount_completed .... [[31mERROR[0m in 0.13s]
[0m18:30:49.484760 [debug] [Thread-1 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: BEGIN
[0m18:30:49.485715 [debug] [Thread-2 (]: Runtime Error in test non_negative_fct_customer_transactions_total_amount_all (models/marts/schema.yml)
  Binder Error: Referenced column "total_amount_all" not found in FROM clause!
  Candidate bindings: "amount", "transaction_ts", "transaction_date", "status", "transaction_id"
  
  LINE 17: where total_amount_all < 0 or total_amount_all is null
                 ^
[0m18:30:49.486475 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m18:30:49.487182 [debug] [Thread-4 (]: Runtime Error in test non_negative_fct_customer_transactions_transaction_count (models/marts/schema.yml)
  Binder Error: Referenced column "transaction_count" not found in FROM clause!
  Candidate bindings: "transaction_ts", "transaction_date", "transaction_id", "amount", "status"
  
  LINE 17: where transaction_count < 0 or transaction_count is null
                 ^
[0m18:30:49.487720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:30:49.488408 [error] [Thread-2 (]: 2 of 16 ERROR non_negative_fct_customer_transactions_total_amount_all .......... [[31mERROR[0m in 0.13s]
[0m18:30:49.489245 [debug] [Thread-3 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m18:30:49.490145 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428' to be skipped because of status 'error'.  Reason: Runtime Error in test non_negative_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)
  Binder Error: Referenced column "total_amount_completed" not found in FROM clause!
  Candidate bindings: "transaction_date", "amount", "transaction_id", "transaction_ts", "status"
  
  LINE 17: where total_amount_completed < 0 or total_amount_completed is...
                 ^.
[0m18:30:49.490938 [error] [Thread-4 (]: 4 of 16 ERROR non_negative_fct_customer_transactions_transaction_count ......... [[31mERROR[0m in 0.13s]
[0m18:30:49.493025 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m18:30:49.494590 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m18:30:49.493974 [info ] [Thread-3 (]: 6 of 16 START test not_null_fct_customer_transactions_customer_id .............. [RUN]
[0m18:30:49.496247 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m18:30:49.496924 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m18:30:49.497788 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89' to be skipped because of status 'error'.  Reason: Runtime Error in test non_negative_fct_customer_transactions_total_amount_all (models/marts/schema.yml)
  Binder Error: Referenced column "total_amount_all" not found in FROM clause!
  Candidate bindings: "amount", "transaction_ts", "transaction_date", "status", "transaction_id"
  
  LINE 17: where total_amount_all < 0 or total_amount_all is null
                 ^.
[0m18:30:49.498360 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m18:30:49.499326 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428, now test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c)
[0m18:30:49.499880 [debug] [Thread-4 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m18:30:49.500329 [info ] [Thread-2 (]: 7 of 16 START test not_null_fct_customer_transactions_total_amount_all ......... [RUN]
[0m18:30:49.502734 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89, now test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f)
[0m18:30:49.501407 [debug] [Thread-1 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    amount
from "medallion"."main"."stg_transactions"
where amount < 0 or amount is null


  
  
      
    ) dbt_internal_test
[0m18:30:49.501907 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m18:30:49.502260 [info ] [Thread-4 (]: 8 of 16 START test not_null_fct_customer_transactions_total_amount_completed ... [RUN]
[0m18:30:49.503099 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m18:30:49.500990 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4' to be skipped because of status 'error'.  Reason: Runtime Error in test non_negative_fct_customer_transactions_transaction_count (models/marts/schema.yml)
  Binder Error: Referenced column "transaction_count" not found in FROM clause!
  Candidate bindings: "transaction_ts", "transaction_date", "transaction_id", "amount", "status"
  
  LINE 17: where transaction_count < 0 or transaction_count is null
                 ^.
[0m18:30:49.514629 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m18:30:49.515161 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m18:30:49.515742 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4, now test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418)
[0m18:30:49.520470 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m18:30:49.521544 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m18:30:49.524644 [debug] [Thread-1 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: ROLLBACK
[0m18:30:49.526178 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m18:30:49.533439 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m18:30:49.533899 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m18:30:49.534526 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733'
[0m18:30:49.537869 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m18:30:49.543781 [debug] [Thread-1 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: Close
[0m18:30:49.543363 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m18:30:49.544544 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m18:30:49.545196 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m18:30:49.545828 [error] [Thread-1 (]: 5 of 16 FAIL 1 non_negative_stg_transactions_amount ............................ [[31mFAIL 1[0m in 0.09s]
[0m18:30:49.548372 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m18:30:49.548842 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m18:30:49.549217 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: BEGIN
[0m18:30:49.549851 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m18:30:49.550318 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: BEGIN
[0m18:30:49.550699 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m18:30:49.551025 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:30:49.551516 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m18:30:49.551905 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:30:49.552266 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: BEGIN
[0m18:30:49.552960 [info ] [Thread-1 (]: 9 of 16 START test not_null_fct_customer_transactions_transaction_count ........ [RUN]
[0m18:30:49.553600 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:30:49.554206 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m18:30:49.554650 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m18:30:49.555069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733, now test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e)
[0m18:30:49.555619 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m18:30:49.556101 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m18:30:49.557779 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m18:30:49.559155 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m18:30:49.559893 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "medallion"."main"."fct_customer_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m18:30:49.560644 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all is null



  
  
      
    ) dbt_internal_test
[0m18:30:49.561228 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m18:30:49.566718 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m18:30:49.567727 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed is null



  
  
      
    ) dbt_internal_test
[0m18:30:49.568375 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all is null



  
  
      
    ) dbt_internal_test
[0m18:30:49.568960 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:30:49.569763 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m18:30:49.570296 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed is null



  
  
      
    ) dbt_internal_test
[0m18:30:49.570784 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m18:30:49.578546 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m18:30:49.580004 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: ROLLBACK
[0m18:30:49.580696 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m18:30:49.581321 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: ROLLBACK
[0m18:30:49.581981 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c'
[0m18:30:49.582520 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: ROLLBACK
[0m18:30:49.582966 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m18:30:49.583566 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: Close
[0m18:30:49.584190 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f'
[0m18:30:49.584774 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: BEGIN
[0m18:30:49.585530 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418'
[0m18:30:49.586649 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: Close
[0m18:30:49.586277 [info ] [Thread-3 (]: 6 of 16 PASS not_null_fct_customer_transactions_customer_id .................... [[32mPASS[0m in 0.09s]
[0m18:30:49.587299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:30:49.587949 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: Close
[0m18:30:49.588653 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m18:30:49.590488 [debug] [Thread-2 (]: Runtime Error in test not_null_fct_customer_transactions_total_amount_all (models/marts/schema.yml)
  Binder Error: Referenced column "total_amount_all" not found in FROM clause!
  Candidate bindings: "amount", "transaction_ts", "transaction_date", "status", "transaction_id"
  
  LINE 18: where total_amount_all is null
                 ^
[0m18:30:49.592194 [debug] [Thread-3 (]: Began running node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m18:30:49.593237 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m18:30:49.594674 [error] [Thread-2 (]: 7 of 16 ERROR not_null_fct_customer_transactions_total_amount_all .............. [[31mERROR[0m in 0.09s]
[0m18:30:49.595711 [info ] [Thread-3 (]: 10 of 16 START test not_null_stg_transactions_amount ........................... [RUN]
[0m18:30:49.596219 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m18:30:49.596986 [debug] [Thread-4 (]: Runtime Error in test not_null_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)
  Binder Error: Referenced column "total_amount_completed" not found in FROM clause!
  Candidate bindings: "transaction_date", "amount", "transaction_id", "transaction_ts", "status"
  
  LINE 18: where total_amount_completed is null
                 ^
[0m18:30:49.597641 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m18:30:49.598141 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c, now test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e)
[0m18:30:49.598710 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count is null



  
  
      
    ) dbt_internal_test
[0m18:30:49.599248 [error] [Thread-4 (]: 8 of 16 ERROR not_null_fct_customer_transactions_total_amount_completed ........ [[31mERROR[0m in 0.08s]
[0m18:30:49.599727 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m18:30:49.600188 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_fct_customer_transactions_total_amount_all (models/marts/schema.yml)
  Binder Error: Referenced column "total_amount_all" not found in FROM clause!
  Candidate bindings: "amount", "transaction_ts", "transaction_date", "status", "transaction_id"
  
  LINE 18: where total_amount_all is null
                 ^.
[0m18:30:49.600556 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m18:30:49.601364 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m18:30:49.601755 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count is null



  
  
      
    ) dbt_internal_test
[0m18:30:49.602202 [info ] [Thread-2 (]: 11 of 16 START test not_null_stg_transactions_customer_id ...................... [RUN]
[0m18:30:49.608381 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m18:30:49.609123 [debug] [Thread-4 (]: Began running node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m18:30:49.609725 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)
  Binder Error: Referenced column "total_amount_completed" not found in FROM clause!
  Candidate bindings: "transaction_date", "amount", "transaction_id", "transaction_ts", "status"
  
  LINE 18: where total_amount_completed is null
                 ^.
[0m18:30:49.610311 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:30:49.611108 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f, now test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf)
[0m18:30:49.611957 [info ] [Thread-4 (]: 12 of 16 START test not_null_stg_transactions_status ........................... [RUN]
[0m18:30:49.612607 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m18:30:49.613216 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: ROLLBACK
[0m18:30:49.613627 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m18:30:49.614057 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418, now test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875)
[0m18:30:49.616205 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m18:30:49.619685 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m18:30:49.620314 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m18:30:49.621040 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e'
[0m18:30:49.621794 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m18:30:49.622204 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m18:30:49.625933 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m18:30:49.626441 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: Close
[0m18:30:49.626953 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: BEGIN
[0m18:30:49.631172 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m18:30:49.633197 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:30:49.638808 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m18:30:49.637044 [debug] [Thread-1 (]: Runtime Error in test not_null_fct_customer_transactions_transaction_count (models/marts/schema.yml)
  Binder Error: Referenced column "transaction_count" not found in FROM clause!
  Candidate bindings: "transaction_ts", "transaction_date", "transaction_id", "amount", "status"
  
  LINE 18: where transaction_count is null
                 ^
[0m18:30:49.637718 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m18:30:49.639483 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m18:30:49.634976 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m18:30:49.640169 [error] [Thread-1 (]: 9 of 16 ERROR not_null_fct_customer_transactions_transaction_count ............. [[31mERROR[0m in 0.09s]
[0m18:30:49.640667 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: BEGIN
[0m18:30:49.641098 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select amount
from "medallion"."main"."stg_transactions"
where amount is null



  
  
      
    ) dbt_internal_test
[0m18:30:49.643816 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m18:30:49.644491 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m18:30:49.645412 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:30:49.647378 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m18:30:49.648551 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_fct_customer_transactions_transaction_count (models/marts/schema.yml)
  Binder Error: Referenced column "transaction_count" not found in FROM clause!
  Candidate bindings: "transaction_ts", "transaction_date", "transaction_id", "amount", "status"
  
  LINE 18: where transaction_count is null
                 ^.
[0m18:30:49.649480 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m18:30:49.650048 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m18:30:49.650449 [info ] [Thread-1 (]: 13 of 16 START test not_null_stg_transactions_transaction_date ................. [RUN]
[0m18:30:49.650852 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m18:30:49.652431 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: ROLLBACK
[0m18:30:49.652830 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: BEGIN
[0m18:30:49.653419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e, now test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c)
[0m18:30:49.653874 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m18:30:49.654530 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e'
[0m18:30:49.654908 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:30:49.655277 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m18:30:49.655698 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "medallion"."main"."stg_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m18:30:49.656206 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: Close
[0m18:30:49.664344 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m18:30:49.664823 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m18:30:49.665976 [error] [Thread-3 (]: 10 of 16 FAIL 1 not_null_stg_transactions_amount ............................... [[31mFAIL 1[0m in 0.07s]
[0m18:30:49.667176 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:30:49.667651 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m18:30:49.668045 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m18:30:49.668580 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m18:30:49.670103 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: ROLLBACK
[0m18:30:49.670493 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select status
from "medallion"."main"."stg_transactions"
where status is null



  
  
      
    ) dbt_internal_test
[0m18:30:49.675319 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m18:30:49.676178 [debug] [Thread-3 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m18:30:49.676786 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf'
[0m18:30:49.677657 [info ] [Thread-3 (]: 14 of 16 START test not_null_stg_transactions_transaction_id ................... [RUN]
[0m18:30:49.678236 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:30:49.678635 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: Close
[0m18:30:49.679118 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m18:30:49.679687 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e, now test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4)
[0m18:30:49.681263 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: ROLLBACK
[0m18:30:49.681785 [info ] [Thread-2 (]: 11 of 16 PASS not_null_stg_transactions_customer_id ............................ [[32mPASS[0m in 0.07s]
[0m18:30:49.682213 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: BEGIN
[0m18:30:49.682579 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m18:30:49.683013 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875'
[0m18:30:49.683502 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m18:30:49.683882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:30:49.687884 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m18:30:49.688634 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: Close
[0m18:30:49.689172 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m18:30:49.690274 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m18:30:49.690901 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m18:30:49.691349 [info ] [Thread-2 (]: 15 of 16 START test not_null_stg_transactions_transaction_ts ................... [RUN]
[0m18:30:49.694842 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m18:30:49.691840 [info ] [Thread-4 (]: 12 of 16 PASS not_null_stg_transactions_status ................................. [[32mPASS[0m in 0.08s]
[0m18:30:49.696163 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m18:30:49.697146 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf, now test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7)
[0m18:30:49.698458 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m18:30:49.701470 [debug] [Thread-4 (]: Began running node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m18:30:49.700185 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m18:30:49.700600 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m18:30:49.699307 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_date
from "medallion"."main"."stg_transactions"
where transaction_date is null



  
  
      
    ) dbt_internal_test
[0m18:30:49.702338 [info ] [Thread-4 (]: 16 of 16 START test unique_stg_transactions_transaction_id ..................... [RUN]
[0m18:30:49.710040 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875, now test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396)
[0m18:30:49.707495 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m18:30:49.702858 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: BEGIN
[0m18:30:49.714937 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:30:49.713194 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m18:30:49.711765 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m18:30:49.730314 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: ROLLBACK
[0m18:30:49.731985 [debug] [Thread-3 (]: SQL status: OK in 0.017 seconds
[0m18:30:49.732693 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m18:30:49.733287 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m18:30:49.733743 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c'
[0m18:30:49.734142 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m18:30:49.737768 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m18:30:49.738373 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: Close
[0m18:30:49.738882 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m18:30:49.739362 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from "medallion"."main"."stg_transactions"
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m18:30:49.740135 [info ] [Thread-1 (]: 13 of 16 PASS not_null_stg_transactions_transaction_date ....................... [[32mPASS[0m in 0.09s]
[0m18:30:49.740661 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m18:30:49.746351 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m18:30:49.747956 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m18:30:49.748441 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: BEGIN
[0m18:30:49.748965 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:30:49.749468 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:30:49.749897 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m18:30:49.751305 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: ROLLBACK
[0m18:30:49.751683 [debug] [Thread-4 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: BEGIN
[0m18:30:49.752030 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m18:30:49.752478 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4'
[0m18:30:49.752817 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:30:49.753156 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m18:30:49.753642 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: Close
[0m18:30:49.754729 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_ts
from "medallion"."main"."stg_transactions"
where transaction_ts is null



  
  
      
    ) dbt_internal_test
[0m18:30:49.755204 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:30:49.756531 [info ] [Thread-3 (]: 14 of 16 PASS not_null_stg_transactions_transaction_id ......................... [[32mPASS[0m in 0.08s]
[0m18:30:49.757327 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m18:30:49.758519 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m18:30:49.759505 [debug] [Thread-4 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "medallion"."main"."stg_transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:30:49.761179 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m18:30:49.763747 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: ROLLBACK
[0m18:30:49.764452 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m18:30:49.764954 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7'
[0m18:30:49.765441 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: Close
[0m18:30:49.767043 [debug] [Thread-4 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: ROLLBACK
[0m18:30:49.768238 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396'
[0m18:30:49.767883 [info ] [Thread-2 (]: 15 of 16 PASS not_null_stg_transactions_transaction_ts ......................... [[32mPASS[0m in 0.07s]
[0m18:30:49.768668 [debug] [Thread-4 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: Close
[0m18:30:49.769174 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m18:30:49.770243 [info ] [Thread-4 (]: 16 of 16 PASS unique_stg_transactions_transaction_id ........................... [[32mPASS[0m in 0.06s]
[0m18:30:49.771425 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m18:30:49.774660 [debug] [MainThread]: Using duckdb connection "master"
[0m18:30:49.776358 [debug] [MainThread]: On master: BEGIN
[0m18:30:49.777200 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:30:49.778811 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m18:30:49.779195 [debug] [MainThread]: On master: COMMIT
[0m18:30:49.779575 [debug] [MainThread]: Using duckdb connection "master"
[0m18:30:49.779866 [debug] [MainThread]: On master: COMMIT
[0m18:30:49.780620 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:30:49.781004 [debug] [MainThread]: On master: Close
[0m18:30:49.781441 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:30:49.781744 [debug] [MainThread]: Connection 'test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c' was properly closed.
[0m18:30:49.781990 [debug] [MainThread]: Connection 'test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7' was properly closed.
[0m18:30:49.782228 [debug] [MainThread]: Connection 'test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4' was properly closed.
[0m18:30:49.782449 [debug] [MainThread]: Connection 'test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396' was properly closed.
[0m18:30:49.782741 [info ] [MainThread]: 
[0m18:30:49.783090 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m18:30:49.785299 [debug] [MainThread]: Command end result
[0m18:30:49.812851 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m18:30:49.814824 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m18:30:49.821803 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m18:30:49.822467 [info ] [MainThread]: 
[0m18:30:49.822882 [info ] [MainThread]: [31mCompleted with 8 errors, 0 partial successes, and 0 warnings:[0m
[0m18:30:49.823191 [info ] [MainThread]: 
[0m18:30:49.823513 [error] [MainThread]: [31mFailure in test non_negative_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)[0m
[0m18:30:49.823821 [error] [MainThread]:   Runtime Error in test non_negative_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)
  Binder Error: Referenced column "total_amount_completed" not found in FROM clause!
  Candidate bindings: "transaction_date", "amount", "transaction_id", "transaction_ts", "status"
  
  LINE 17: where total_amount_completed < 0 or total_amount_completed is...
                 ^
[0m18:30:49.824064 [info ] [MainThread]: 
[0m18:30:49.824365 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/non_negative_fct_customer_transactions_total_amount_completed.sql
[0m18:30:49.824614 [info ] [MainThread]: 
[0m18:30:49.824901 [error] [MainThread]: [31mFailure in test non_negative_fct_customer_transactions_total_amount_all (models/marts/schema.yml)[0m
[0m18:30:49.825194 [error] [MainThread]:   Runtime Error in test non_negative_fct_customer_transactions_total_amount_all (models/marts/schema.yml)
  Binder Error: Referenced column "total_amount_all" not found in FROM clause!
  Candidate bindings: "amount", "transaction_ts", "transaction_date", "status", "transaction_id"
  
  LINE 17: where total_amount_all < 0 or total_amount_all is null
                 ^
[0m18:30:49.825430 [info ] [MainThread]: 
[0m18:30:49.825698 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/non_negative_fct_customer_transactions_total_amount_all.sql
[0m18:30:49.825934 [info ] [MainThread]: 
[0m18:30:49.826256 [error] [MainThread]: [31mFailure in test non_negative_fct_customer_transactions_transaction_count (models/marts/schema.yml)[0m
[0m18:30:49.826562 [error] [MainThread]:   Runtime Error in test non_negative_fct_customer_transactions_transaction_count (models/marts/schema.yml)
  Binder Error: Referenced column "transaction_count" not found in FROM clause!
  Candidate bindings: "transaction_ts", "transaction_date", "transaction_id", "amount", "status"
  
  LINE 17: where transaction_count < 0 or transaction_count is null
                 ^
[0m18:30:49.826804 [info ] [MainThread]: 
[0m18:30:49.827093 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/non_negative_fct_customer_transactions_transaction_count.sql
[0m18:30:49.827359 [info ] [MainThread]: 
[0m18:30:49.827645 [error] [MainThread]: [31mFailure in test non_negative_stg_transactions_amount (models/staging/schema.yml)[0m
[0m18:30:49.827931 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m18:30:49.828249 [info ] [MainThread]: 
[0m18:30:49.828546 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/non_negative_stg_transactions_amount.sql
[0m18:30:49.828957 [info ] [MainThread]: 
[0m18:30:49.829468 [error] [MainThread]: [31mFailure in test not_null_fct_customer_transactions_total_amount_all (models/marts/schema.yml)[0m
[0m18:30:49.829792 [error] [MainThread]:   Runtime Error in test not_null_fct_customer_transactions_total_amount_all (models/marts/schema.yml)
  Binder Error: Referenced column "total_amount_all" not found in FROM clause!
  Candidate bindings: "amount", "transaction_ts", "transaction_date", "status", "transaction_id"
  
  LINE 18: where total_amount_all is null
                 ^
[0m18:30:49.830108 [info ] [MainThread]: 
[0m18:30:49.830535 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/not_null_fct_customer_transactions_total_amount_all.sql
[0m18:30:49.830847 [info ] [MainThread]: 
[0m18:30:49.831218 [error] [MainThread]: [31mFailure in test not_null_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)[0m
[0m18:30:49.831569 [error] [MainThread]:   Runtime Error in test not_null_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)
  Binder Error: Referenced column "total_amount_completed" not found in FROM clause!
  Candidate bindings: "transaction_date", "amount", "transaction_id", "transaction_ts", "status"
  
  LINE 18: where total_amount_completed is null
                 ^
[0m18:30:49.831908 [info ] [MainThread]: 
[0m18:30:49.832299 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/not_null_fct_customer_transactions_total_amount_completed.sql
[0m18:30:49.832628 [info ] [MainThread]: 
[0m18:30:49.833031 [error] [MainThread]: [31mFailure in test not_null_fct_customer_transactions_transaction_count (models/marts/schema.yml)[0m
[0m18:30:49.833644 [error] [MainThread]:   Runtime Error in test not_null_fct_customer_transactions_transaction_count (models/marts/schema.yml)
  Binder Error: Referenced column "transaction_count" not found in FROM clause!
  Candidate bindings: "transaction_ts", "transaction_date", "transaction_id", "amount", "status"
  
  LINE 18: where transaction_count is null
                 ^
[0m18:30:49.833994 [info ] [MainThread]: 
[0m18:30:49.834508 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/not_null_fct_customer_transactions_transaction_count.sql
[0m18:30:49.834931 [info ] [MainThread]: 
[0m18:30:49.835398 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_amount (models/staging/schema.yml)[0m
[0m18:30:49.835810 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m18:30:49.836135 [info ] [MainThread]: 
[0m18:30:49.836595 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/not_null_stg_transactions_amount.sql
[0m18:30:49.837073 [info ] [MainThread]: 
[0m18:30:49.837506 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=8 SKIP=0 NO-OP=0 TOTAL=16
[0m18:30:49.838372 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.3707489, "process_in_blocks": "1760", "process_kernel_time": 0.152578, "process_mem_max_rss": "156312", "process_out_blocks": "2576", "process_user_time": 2.546956}
[0m18:30:49.838781 [debug] [MainThread]: Command `dbt test` failed at 18:30:49.838691 after 1.37 seconds
[0m18:30:49.839142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cbdc2f993f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cbdb04bfac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cbdb04bf640>]}
[0m18:30:49.839510 [debug] [MainThread]: Flushing usage events
[0m18:30:50.489748 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:31:53.158407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7639e7461420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7639e640c280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7639e640c220>]}


============================== 18:31:53.162376 | 6c208e4b-04d8-41f7-9560-181acfea4499 ==============================
[0m18:31:53.162376 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:31:53.162846 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt test --profiles-dir /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles --vars {"ds": "20251207", "clean_dir": "/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean"}', 'log_path': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/logs', 'log_cache_events': 'False', 'log_format': 'default', 'introspect': 'True', 'write_json': 'True', 'no_print': 'None', 'profiles_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles', 'use_colors': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'version_check': 'True', 'empty': 'None', 'target_path': 'None', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False'}
[0m18:31:53.370082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c208e4b-04d8-41f7-9560-181acfea4499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7639e8e0d9c0>]}
[0m18:31:53.435967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c208e4b-04d8-41f7-9560-181acfea4499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7639e7312bf0>]}
[0m18:31:53.437864 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:31:53.515892 [debug] [MainThread]: checksum: 505cc0738468dbf8af23784e25e0465f2f41e62e9895701049268b92bd4ad565, vars: {'clean_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean',
 'ds': '20251207'}, profile: , target: , version: 1.10.15
[0m18:31:53.651586 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:31:53.652746 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:31:53.698486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c208e4b-04d8-41f7-9560-181acfea4499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7639de4dc130>]}
[0m18:31:53.859930 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m18:31:53.861583 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m18:31:53.879515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c208e4b-04d8-41f7-9560-181acfea4499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7639de4943a0>]}
[0m18:31:53.880798 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m18:31:53.881571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c208e4b-04d8-41f7-9560-181acfea4499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7639de464610>]}
[0m18:31:53.884049 [info ] [MainThread]: 
[0m18:31:53.884621 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:31:53.885007 [info ] [MainThread]: 
[0m18:31:53.885761 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:31:53.892023 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion_main'
[0m18:31:53.922911 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m18:31:53.923449 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m18:31:53.923807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:53.934354 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:31:53.934855 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m18:31:53.935261 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m18:31:53.945849 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:31:53.947532 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m18:31:53.948729 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m18:31:53.949150 [debug] [ThreadPool]: On list_medallion_main: Close
[0m18:31:53.950218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c208e4b-04d8-41f7-9560-181acfea4499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7639de4943a0>]}
[0m18:31:53.950872 [debug] [MainThread]: Using duckdb connection "master"
[0m18:31:53.951487 [debug] [MainThread]: On master: BEGIN
[0m18:31:53.951908 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:31:53.952815 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:31:53.953277 [debug] [MainThread]: On master: COMMIT
[0m18:31:53.953713 [debug] [MainThread]: Using duckdb connection "master"
[0m18:31:53.954040 [debug] [MainThread]: On master: COMMIT
[0m18:31:53.954609 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:31:53.954959 [debug] [MainThread]: On master: Close
[0m18:31:53.958724 [debug] [Thread-1 (]: Began running node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m18:31:53.959176 [debug] [Thread-2 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m18:31:53.959558 [debug] [Thread-3 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m18:31:53.959938 [debug] [Thread-4 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m18:31:53.960290 [info ] [Thread-1 (]: 1 of 16 START test accepted_values_stg_transactions_status__completed__pending__failed  [RUN]
[0m18:31:53.960739 [info ] [Thread-2 (]: 2 of 16 START test non_negative_fct_customer_transactions_total_amount_all ..... [RUN]
[0m18:31:53.961157 [info ] [Thread-3 (]: 3 of 16 START test non_negative_fct_customer_transactions_total_amount_completed  [RUN]
[0m18:31:53.961518 [info ] [Thread-4 (]: 4 of 16 START test non_negative_fct_customer_transactions_transaction_count .... [RUN]
[0m18:31:53.962007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26)
[0m18:31:53.962469 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89'
[0m18:31:53.962956 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428'
[0m18:31:53.963384 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4'
[0m18:31:53.963760 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m18:31:53.964153 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m18:31:53.965039 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m18:31:53.965364 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m18:31:53.983250 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m18:31:53.988853 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m18:31:53.994374 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m18:31:53.998576 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m18:31:54.000061 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m18:31:54.000811 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m18:31:54.001293 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m18:31:54.020826 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m18:31:54.022142 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m18:31:54.029190 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m18:31:54.031834 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m18:31:54.034129 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m18:31:54.034686 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m18:31:54.035436 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m18:31:54.035977 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m18:31:54.036487 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m18:31:54.036886 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: BEGIN
[0m18:31:54.037370 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: BEGIN
[0m18:31:54.037849 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: BEGIN
[0m18:31:54.043948 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:31:54.038298 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: BEGIN
[0m18:31:54.039474 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:31:54.038803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:54.049763 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:31:54.050738 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m18:31:54.053328 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m18:31:54.052567 [debug] [Thread-2 (]: SQL status: OK in 0.013 seconds
[0m18:31:54.053905 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m18:31:54.054556 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed < 0 or total_amount_completed is null


  
  
      
    ) dbt_internal_test
[0m18:31:54.054932 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m18:31:54.055422 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m18:31:54.055857 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m18:31:54.056509 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m18:31:54.056945 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed < 0 or total_amount_completed is null


  
  
      
    ) dbt_internal_test
[0m18:31:54.057336 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all < 0 or total_amount_all is null


  
  
      
    ) dbt_internal_test
[0m18:31:54.057760 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "medallion"."main"."stg_transactions"
    group by status

)

select *
from all_values
where value_field not in (
    'completed','pending','failed'
)



  
  
      
    ) dbt_internal_test
[0m18:31:54.058167 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count < 0 or transaction_count is null


  
  
      
    ) dbt_internal_test
[0m18:31:54.058562 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m18:31:54.059398 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all < 0 or total_amount_all is null


  
  
      
    ) dbt_internal_test
[0m18:31:54.059781 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count < 0 or transaction_count is null


  
  
      
    ) dbt_internal_test
[0m18:31:54.060341 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: ROLLBACK
[0m18:31:54.060842 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:31:54.061178 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m18:31:54.061523 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m18:31:54.069121 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: ROLLBACK
[0m18:31:54.068191 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: ROLLBACK
[0m18:31:54.067017 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: ROLLBACK
[0m18:31:54.071558 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428'
[0m18:31:54.072515 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4'
[0m18:31:54.073512 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89'
[0m18:31:54.074211 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26'
[0m18:31:54.074663 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: Close
[0m18:31:54.075017 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: Close
[0m18:31:54.075373 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: Close
[0m18:31:54.075705 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: Close
[0m18:31:54.078840 [debug] [Thread-4 (]: Runtime Error in test non_negative_fct_customer_transactions_transaction_count (models/marts/schema.yml)
  Binder Error: Referenced column "transaction_count" not found in FROM clause!
  Candidate bindings: "transaction_ts", "transaction_date", "transaction_id", "amount", "status"
  
  LINE 17: where transaction_count < 0 or transaction_count is null
                 ^
[0m18:31:54.077906 [info ] [Thread-1 (]: 1 of 16 PASS accepted_values_stg_transactions_status__completed__pending__failed  [[32mPASS[0m in 0.12s]
[0m18:31:54.080598 [error] [Thread-4 (]: 4 of 16 ERROR non_negative_fct_customer_transactions_transaction_count ......... [[31mERROR[0m in 0.12s]
[0m18:31:54.082009 [debug] [Thread-2 (]: Runtime Error in test non_negative_fct_customer_transactions_total_amount_all (models/marts/schema.yml)
  Binder Error: Referenced column "total_amount_all" not found in FROM clause!
  Candidate bindings: "amount", "transaction_ts", "transaction_date", "status", "transaction_id"
  
  LINE 17: where total_amount_all < 0 or total_amount_all is null
                 ^
[0m18:31:54.084600 [error] [Thread-2 (]: 2 of 16 ERROR non_negative_fct_customer_transactions_total_amount_all .......... [[31mERROR[0m in 0.12s]
[0m18:31:54.083454 [debug] [Thread-3 (]: Runtime Error in test non_negative_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)
  Binder Error: Referenced column "total_amount_completed" not found in FROM clause!
  Candidate bindings: "transaction_date", "amount", "transaction_id", "transaction_ts", "status"
  
  LINE 17: where total_amount_completed < 0 or total_amount_completed is...
                 ^
[0m18:31:54.083945 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m18:31:54.082672 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m18:31:54.085317 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m18:31:54.086300 [error] [Thread-3 (]: 3 of 16 ERROR non_negative_fct_customer_transactions_total_amount_completed .... [[31mERROR[0m in 0.12s]
[0m18:31:54.092375 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m18:31:54.089114 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4' to be skipped because of status 'error'.  Reason: Runtime Error in test non_negative_fct_customer_transactions_transaction_count (models/marts/schema.yml)
  Binder Error: Referenced column "transaction_count" not found in FROM clause!
  Candidate bindings: "transaction_ts", "transaction_date", "transaction_id", "amount", "status"
  
  LINE 17: where transaction_count < 0 or transaction_count is null
                 ^.
[0m18:31:54.088352 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m18:31:54.090881 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m18:31:54.093074 [debug] [Thread-3 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m18:31:54.087568 [debug] [Thread-4 (]: Began running node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m18:31:54.094483 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89' to be skipped because of status 'error'.  Reason: Runtime Error in test non_negative_fct_customer_transactions_total_amount_all (models/marts/schema.yml)
  Binder Error: Referenced column "total_amount_all" not found in FROM clause!
  Candidate bindings: "amount", "transaction_ts", "transaction_date", "status", "transaction_id"
  
  LINE 17: where total_amount_all < 0 or total_amount_all is null
                 ^.
[0m18:31:54.095018 [info ] [Thread-1 (]: 6 of 16 START test not_null_fct_customer_transactions_customer_id .............. [RUN]
[0m18:31:54.095626 [info ] [Thread-2 (]: 7 of 16 START test not_null_fct_customer_transactions_total_amount_all ......... [RUN]
[0m18:31:54.096165 [info ] [Thread-3 (]: 8 of 16 START test not_null_fct_customer_transactions_total_amount_completed ... [RUN]
[0m18:31:54.096971 [info ] [Thread-4 (]: 5 of 16 START test non_negative_stg_transactions_amount ........................ [RUN]
[0m18:31:54.097729 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428' to be skipped because of status 'error'.  Reason: Runtime Error in test non_negative_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)
  Binder Error: Referenced column "total_amount_completed" not found in FROM clause!
  Candidate bindings: "transaction_date", "amount", "transaction_id", "transaction_ts", "status"
  
  LINE 17: where total_amount_completed < 0 or total_amount_completed is...
                 ^.
[0m18:31:54.099479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26, now test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c)
[0m18:31:54.100555 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89, now test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f)
[0m18:31:54.101238 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428, now test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418)
[0m18:31:54.101925 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4, now test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733)
[0m18:31:54.102678 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m18:31:54.103237 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m18:31:54.103714 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m18:31:54.104070 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m18:31:54.116030 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m18:31:54.124575 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m18:31:54.132735 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m18:31:54.143976 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m18:31:54.145667 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m18:31:54.146212 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m18:31:54.146644 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m18:31:54.147220 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m18:31:54.150566 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m18:31:54.154762 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m18:31:54.159556 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m18:31:54.162568 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m18:31:54.163771 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m18:31:54.164270 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m18:31:54.164927 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m18:31:54.165392 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: BEGIN
[0m18:31:54.165790 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m18:31:54.167681 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: BEGIN
[0m18:31:54.166167 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: BEGIN
[0m18:31:54.167244 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:31:54.166781 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: BEGIN
[0m18:31:54.168208 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:31:54.168800 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:31:54.171474 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:54.174006 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m18:31:54.175827 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m18:31:54.177331 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m18:31:54.178283 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m18:31:54.178658 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m18:31:54.179050 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m18:31:54.179907 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all is null



  
  
      
    ) dbt_internal_test
[0m18:31:54.180518 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m18:31:54.181121 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m18:31:54.181642 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    amount
from "medallion"."main"."stg_transactions"
where amount < 0 or amount is null


  
  
      
    ) dbt_internal_test
[0m18:31:54.182575 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "medallion"."main"."fct_customer_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m18:31:54.183250 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all is null



  
  
      
    ) dbt_internal_test
[0m18:31:54.183821 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed is null



  
  
      
    ) dbt_internal_test
[0m18:31:54.184548 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m18:31:54.185088 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:54.185459 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:31:54.186021 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed is null



  
  
      
    ) dbt_internal_test
[0m18:31:54.186743 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: ROLLBACK
[0m18:31:54.189388 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: ROLLBACK
[0m18:31:54.190133 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m18:31:54.191456 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: ROLLBACK
[0m18:31:54.192189 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c'
[0m18:31:54.192955 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f'
[0m18:31:54.193487 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: ROLLBACK
[0m18:31:54.194023 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733'
[0m18:31:54.194431 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: Close
[0m18:31:54.195063 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: Close
[0m18:31:54.196219 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: Close
[0m18:31:54.199450 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418'
[0m18:31:54.197955 [info ] [Thread-1 (]: 6 of 16 PASS not_null_fct_customer_transactions_customer_id .................... [[32mPASS[0m in 0.10s]
[0m18:31:54.200691 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: Close
[0m18:31:54.200350 [error] [Thread-4 (]: 5 of 16 FAIL 1 non_negative_stg_transactions_amount ............................ [[31mFAIL 1[0m in 0.10s]
[0m18:31:54.201487 [debug] [Thread-2 (]: Runtime Error in test not_null_fct_customer_transactions_total_amount_all (models/marts/schema.yml)
  Binder Error: Referenced column "total_amount_all" not found in FROM clause!
  Candidate bindings: "amount", "transaction_ts", "transaction_date", "status", "transaction_id"
  
  LINE 18: where total_amount_all is null
                 ^
[0m18:31:54.202039 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m18:31:54.202788 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m18:31:54.203652 [debug] [Thread-3 (]: Runtime Error in test not_null_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)
  Binder Error: Referenced column "total_amount_completed" not found in FROM clause!
  Candidate bindings: "transaction_date", "amount", "transaction_id", "transaction_ts", "status"
  
  LINE 18: where total_amount_completed is null
                 ^
[0m18:31:54.204258 [error] [Thread-2 (]: 7 of 16 ERROR not_null_fct_customer_transactions_total_amount_all .............. [[31mERROR[0m in 0.10s]
[0m18:31:54.205007 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m18:31:54.205532 [debug] [Thread-4 (]: Began running node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m18:31:54.207064 [error] [Thread-3 (]: 8 of 16 ERROR not_null_fct_customer_transactions_total_amount_completed ........ [[31mERROR[0m in 0.11s]
[0m18:31:54.208158 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m18:31:54.208931 [info ] [Thread-1 (]: 9 of 16 START test not_null_fct_customer_transactions_transaction_count ........ [RUN]
[0m18:31:54.209903 [info ] [Thread-4 (]: 10 of 16 START test not_null_stg_transactions_amount ........................... [RUN]
[0m18:31:54.210627 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m18:31:54.211118 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m18:31:54.211681 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_fct_customer_transactions_total_amount_all (models/marts/schema.yml)
  Binder Error: Referenced column "total_amount_all" not found in FROM clause!
  Candidate bindings: "amount", "transaction_ts", "transaction_date", "status", "transaction_id"
  
  LINE 18: where total_amount_all is null
                 ^.
[0m18:31:54.212502 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c, now test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e)
[0m18:31:54.212997 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733, now test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e)
[0m18:31:54.213628 [debug] [Thread-3 (]: Began running node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m18:31:54.214027 [info ] [Thread-2 (]: 11 of 16 START test not_null_stg_transactions_customer_id ...................... [RUN]
[0m18:31:54.214617 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)
  Binder Error: Referenced column "total_amount_completed" not found in FROM clause!
  Candidate bindings: "transaction_date", "amount", "transaction_id", "transaction_ts", "status"
  
  LINE 18: where total_amount_completed is null
                 ^.
[0m18:31:54.215029 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m18:31:54.215483 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m18:31:54.215981 [info ] [Thread-3 (]: 12 of 16 START test not_null_stg_transactions_status ........................... [RUN]
[0m18:31:54.216588 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f, now test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf)
[0m18:31:54.224098 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m18:31:54.227840 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m18:31:54.229359 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418, now test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875)
[0m18:31:54.230268 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m18:31:54.231344 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m18:31:54.236312 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m18:31:54.236868 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m18:31:54.237380 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m18:31:54.243660 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m18:31:54.247680 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m18:31:54.249957 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m18:31:54.250521 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m18:31:54.251139 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m18:31:54.251862 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m18:31:54.254557 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m18:31:54.257652 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m18:31:54.258346 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m18:31:54.259052 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: BEGIN
[0m18:31:54.259702 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: BEGIN
[0m18:31:54.260149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:54.260614 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m18:31:54.261155 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:31:54.261532 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m18:31:54.262255 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: BEGIN
[0m18:31:54.262909 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:31:54.263258 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: BEGIN
[0m18:31:54.263579 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:31:54.263960 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:31:54.264290 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m18:31:54.264641 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:31:54.265117 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m18:31:54.265865 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count is null



  
  
      
    ) dbt_internal_test
[0m18:31:54.266431 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:31:54.266855 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select amount
from "medallion"."main"."stg_transactions"
where amount is null



  
  
      
    ) dbt_internal_test
[0m18:31:54.267196 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m18:31:54.267732 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m18:31:54.268157 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count is null



  
  
      
    ) dbt_internal_test
[0m18:31:54.268743 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m18:31:54.269325 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "medallion"."main"."stg_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m18:31:54.269775 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:31:54.270141 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:31:54.270751 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select status
from "medallion"."main"."stg_transactions"
where status is null



  
  
      
    ) dbt_internal_test
[0m18:31:54.271777 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: ROLLBACK
[0m18:31:54.272932 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:31:54.274529 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: ROLLBACK
[0m18:31:54.275360 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m18:31:54.276246 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e'
[0m18:31:54.277829 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: ROLLBACK
[0m18:31:54.278794 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e'
[0m18:31:54.279723 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: Close
[0m18:31:54.281607 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: ROLLBACK
[0m18:31:54.282140 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf'
[0m18:31:54.282589 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: Close
[0m18:31:54.283328 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875'
[0m18:31:54.283718 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: Close
[0m18:31:54.286137 [debug] [Thread-1 (]: Runtime Error in test not_null_fct_customer_transactions_transaction_count (models/marts/schema.yml)
  Binder Error: Referenced column "transaction_count" not found in FROM clause!
  Candidate bindings: "transaction_ts", "transaction_date", "transaction_id", "amount", "status"
  
  LINE 18: where transaction_count is null
                 ^
[0m18:31:54.286650 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: Close
[0m18:31:54.285264 [error] [Thread-4 (]: 10 of 16 FAIL 1 not_null_stg_transactions_amount ............................... [[31mFAIL 1[0m in 0.07s]
[0m18:31:54.288315 [info ] [Thread-2 (]: 11 of 16 PASS not_null_stg_transactions_customer_id ............................ [[32mPASS[0m in 0.07s]
[0m18:31:54.289389 [error] [Thread-1 (]: 9 of 16 ERROR not_null_fct_customer_transactions_transaction_count ............. [[31mERROR[0m in 0.08s]
[0m18:31:54.290255 [info ] [Thread-3 (]: 12 of 16 PASS not_null_stg_transactions_status ................................. [[32mPASS[0m in 0.06s]
[0m18:31:54.290901 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m18:31:54.291518 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m18:31:54.292064 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m18:31:54.292541 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m18:31:54.293045 [debug] [Thread-4 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m18:31:54.293591 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m18:31:54.294074 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m18:31:54.294528 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_fct_customer_transactions_transaction_count (models/marts/schema.yml)
  Binder Error: Referenced column "transaction_count" not found in FROM clause!
  Candidate bindings: "transaction_ts", "transaction_date", "transaction_id", "amount", "status"
  
  LINE 18: where transaction_count is null
                 ^.
[0m18:31:54.294912 [debug] [Thread-3 (]: Began running node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m18:31:54.295278 [info ] [Thread-4 (]: 13 of 16 START test not_null_stg_transactions_transaction_date ................. [RUN]
[0m18:31:54.295674 [info ] [Thread-2 (]: 14 of 16 START test not_null_stg_transactions_transaction_id ................... [RUN]
[0m18:31:54.296059 [info ] [Thread-1 (]: 15 of 16 START test not_null_stg_transactions_transaction_ts ................... [RUN]
[0m18:31:54.296618 [info ] [Thread-3 (]: 16 of 16 START test unique_stg_transactions_transaction_id ..................... [RUN]
[0m18:31:54.297117 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e, now test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c)
[0m18:31:54.297823 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf, now test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4)
[0m18:31:54.298344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e, now test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7)
[0m18:31:54.298735 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875, now test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396)
[0m18:31:54.299095 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m18:31:54.299469 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m18:31:54.300108 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m18:31:54.300793 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m18:31:54.307664 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m18:31:54.313876 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m18:31:54.317698 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m18:31:54.326451 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m18:31:54.327419 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m18:31:54.327867 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m18:31:54.328417 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m18:31:54.330751 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m18:31:54.333486 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m18:31:54.334029 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m18:31:54.337443 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m18:31:54.342550 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m18:31:54.343243 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m18:31:54.343830 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m18:31:54.344608 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: BEGIN
[0m18:31:54.345009 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m18:31:54.345424 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m18:31:54.345859 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: BEGIN
[0m18:31:54.346236 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:31:54.346617 [debug] [Thread-3 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: BEGIN
[0m18:31:54.347028 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: BEGIN
[0m18:31:54.347471 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:31:54.348415 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:31:54.348930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:54.349817 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m18:31:54.351275 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m18:31:54.352095 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m18:31:54.352761 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m18:31:54.353732 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m18:31:54.354796 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m18:31:54.355592 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m18:31:54.356181 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from "medallion"."main"."stg_transactions"
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m18:31:54.356635 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m18:31:54.357090 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_date
from "medallion"."main"."stg_transactions"
where transaction_date is null



  
  
      
    ) dbt_internal_test
[0m18:31:54.357511 [debug] [Thread-3 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "medallion"."main"."stg_transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:31:54.358270 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_ts
from "medallion"."main"."stg_transactions"
where transaction_ts is null



  
  
      
    ) dbt_internal_test
[0m18:31:54.359096 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:31:54.359574 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:31:54.359960 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:54.360335 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:31:54.361710 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: ROLLBACK
[0m18:31:54.362992 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: ROLLBACK
[0m18:31:54.364105 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: ROLLBACK
[0m18:31:54.365691 [debug] [Thread-3 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: ROLLBACK
[0m18:31:54.366309 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4'
[0m18:31:54.366819 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c'
[0m18:31:54.367392 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7'
[0m18:31:54.368018 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396'
[0m18:31:54.368604 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: Close
[0m18:31:54.369058 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: Close
[0m18:31:54.369705 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: Close
[0m18:31:54.370167 [debug] [Thread-3 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: Close
[0m18:31:54.372601 [info ] [Thread-4 (]: 13 of 16 PASS not_null_stg_transactions_transaction_date ....................... [[32mPASS[0m in 0.08s]
[0m18:31:54.374530 [info ] [Thread-2 (]: 14 of 16 PASS not_null_stg_transactions_transaction_id ......................... [[32mPASS[0m in 0.08s]
[0m18:31:54.377388 [info ] [Thread-1 (]: 15 of 16 PASS not_null_stg_transactions_transaction_ts ......................... [[32mPASS[0m in 0.08s]
[0m18:31:54.379565 [info ] [Thread-3 (]: 16 of 16 PASS unique_stg_transactions_transaction_id ........................... [[32mPASS[0m in 0.08s]
[0m18:31:54.380835 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m18:31:54.381671 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m18:31:54.382411 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m18:31:54.383239 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m18:31:54.387245 [debug] [MainThread]: Using duckdb connection "master"
[0m18:31:54.387940 [debug] [MainThread]: On master: BEGIN
[0m18:31:54.388672 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:31:54.390969 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m18:31:54.391470 [debug] [MainThread]: On master: COMMIT
[0m18:31:54.391901 [debug] [MainThread]: Using duckdb connection "master"
[0m18:31:54.392207 [debug] [MainThread]: On master: COMMIT
[0m18:31:54.392904 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:31:54.393241 [debug] [MainThread]: On master: Close
[0m18:31:54.393665 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:31:54.393935 [debug] [MainThread]: Connection 'test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7' was properly closed.
[0m18:31:54.394194 [debug] [MainThread]: Connection 'test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4' was properly closed.
[0m18:31:54.394462 [debug] [MainThread]: Connection 'test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396' was properly closed.
[0m18:31:54.394728 [debug] [MainThread]: Connection 'test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c' was properly closed.
[0m18:31:54.395538 [info ] [MainThread]: 
[0m18:31:54.396064 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m18:31:54.399442 [debug] [MainThread]: Command end result
[0m18:31:54.422846 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m18:31:54.426388 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m18:31:54.433169 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m18:31:54.433585 [info ] [MainThread]: 
[0m18:31:54.433987 [info ] [MainThread]: [31mCompleted with 8 errors, 0 partial successes, and 0 warnings:[0m
[0m18:31:54.434318 [info ] [MainThread]: 
[0m18:31:54.434677 [error] [MainThread]: [31mFailure in test non_negative_fct_customer_transactions_transaction_count (models/marts/schema.yml)[0m
[0m18:31:54.435014 [error] [MainThread]:   Runtime Error in test non_negative_fct_customer_transactions_transaction_count (models/marts/schema.yml)
  Binder Error: Referenced column "transaction_count" not found in FROM clause!
  Candidate bindings: "transaction_ts", "transaction_date", "transaction_id", "amount", "status"
  
  LINE 17: where transaction_count < 0 or transaction_count is null
                 ^
[0m18:31:54.435317 [info ] [MainThread]: 
[0m18:31:54.435704 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/non_negative_fct_customer_transactions_transaction_count.sql
[0m18:31:54.436040 [info ] [MainThread]: 
[0m18:31:54.436515 [error] [MainThread]: [31mFailure in test non_negative_fct_customer_transactions_total_amount_all (models/marts/schema.yml)[0m
[0m18:31:54.436905 [error] [MainThread]:   Runtime Error in test non_negative_fct_customer_transactions_total_amount_all (models/marts/schema.yml)
  Binder Error: Referenced column "total_amount_all" not found in FROM clause!
  Candidate bindings: "amount", "transaction_ts", "transaction_date", "status", "transaction_id"
  
  LINE 17: where total_amount_all < 0 or total_amount_all is null
                 ^
[0m18:31:54.437300 [info ] [MainThread]: 
[0m18:31:54.437824 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/non_negative_fct_customer_transactions_total_amount_all.sql
[0m18:31:54.438457 [info ] [MainThread]: 
[0m18:31:54.439175 [error] [MainThread]: [31mFailure in test non_negative_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)[0m
[0m18:31:54.439811 [error] [MainThread]:   Runtime Error in test non_negative_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)
  Binder Error: Referenced column "total_amount_completed" not found in FROM clause!
  Candidate bindings: "transaction_date", "amount", "transaction_id", "transaction_ts", "status"
  
  LINE 17: where total_amount_completed < 0 or total_amount_completed is...
                 ^
[0m18:31:54.440229 [info ] [MainThread]: 
[0m18:31:54.440731 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/non_negative_fct_customer_transactions_total_amount_completed.sql
[0m18:31:54.441109 [info ] [MainThread]: 
[0m18:31:54.441465 [error] [MainThread]: [31mFailure in test non_negative_stg_transactions_amount (models/staging/schema.yml)[0m
[0m18:31:54.441789 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m18:31:54.442042 [info ] [MainThread]: 
[0m18:31:54.442373 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/non_negative_stg_transactions_amount.sql
[0m18:31:54.442652 [info ] [MainThread]: 
[0m18:31:54.442962 [error] [MainThread]: [31mFailure in test not_null_fct_customer_transactions_total_amount_all (models/marts/schema.yml)[0m
[0m18:31:54.443301 [error] [MainThread]:   Runtime Error in test not_null_fct_customer_transactions_total_amount_all (models/marts/schema.yml)
  Binder Error: Referenced column "total_amount_all" not found in FROM clause!
  Candidate bindings: "amount", "transaction_ts", "transaction_date", "status", "transaction_id"
  
  LINE 18: where total_amount_all is null
                 ^
[0m18:31:54.443552 [info ] [MainThread]: 
[0m18:31:54.443951 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/not_null_fct_customer_transactions_total_amount_all.sql
[0m18:31:54.444316 [info ] [MainThread]: 
[0m18:31:54.444751 [error] [MainThread]: [31mFailure in test not_null_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)[0m
[0m18:31:54.445171 [error] [MainThread]:   Runtime Error in test not_null_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)
  Binder Error: Referenced column "total_amount_completed" not found in FROM clause!
  Candidate bindings: "transaction_date", "amount", "transaction_id", "transaction_ts", "status"
  
  LINE 18: where total_amount_completed is null
                 ^
[0m18:31:54.445448 [info ] [MainThread]: 
[0m18:31:54.446012 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/not_null_fct_customer_transactions_total_amount_completed.sql
[0m18:31:54.446535 [info ] [MainThread]: 
[0m18:31:54.447023 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_amount (models/staging/schema.yml)[0m
[0m18:31:54.447529 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m18:31:54.447925 [info ] [MainThread]: 
[0m18:31:54.448311 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/not_null_stg_transactions_amount.sql
[0m18:31:54.448642 [info ] [MainThread]: 
[0m18:31:54.449060 [error] [MainThread]: [31mFailure in test not_null_fct_customer_transactions_transaction_count (models/marts/schema.yml)[0m
[0m18:31:54.449527 [error] [MainThread]:   Runtime Error in test not_null_fct_customer_transactions_transaction_count (models/marts/schema.yml)
  Binder Error: Referenced column "transaction_count" not found in FROM clause!
  Candidate bindings: "transaction_ts", "transaction_date", "transaction_id", "amount", "status"
  
  LINE 18: where transaction_count is null
                 ^
[0m18:31:54.449907 [info ] [MainThread]: 
[0m18:31:54.450395 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/not_null_fct_customer_transactions_transaction_count.sql
[0m18:31:54.450829 [info ] [MainThread]: 
[0m18:31:54.451247 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=8 SKIP=0 NO-OP=0 TOTAL=16
[0m18:31:54.453019 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.3460546, "process_in_blocks": "0", "process_kernel_time": 0.148042, "process_mem_max_rss": "155508", "process_out_blocks": "2584", "process_user_time": 2.50172}
[0m18:31:54.453752 [debug] [MainThread]: Command `dbt test` failed at 18:31:54.453625 after 1.35 seconds
[0m18:31:54.454190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7639e7461420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7639e735aa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7639dc195ba0>]}
[0m18:31:54.454679 [debug] [MainThread]: Flushing usage events
[0m18:31:55.332215 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:44:01.540871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b88f471480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b88e4402b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b88e440250>]}


============================== 20:44:01.545175 | 5a1920aa-093d-413d-a15c-1411f72e37a1 ==============================
[0m20:44:01.545175 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:44:01.546191 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'write_json': 'True', 'introspect': 'True', 'no_print': 'None', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'log_path': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/logs', 'quiet': 'False', 'log_format': 'default', 'target_path': 'None', 'use_colors': 'True', 'version_check': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'printer_width': '80', 'invocation_command': 'dbt run --profiles-dir /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles --vars {"ds": "20251207", "clean_dir": "/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean"}', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles', 'use_experimental_parser': 'False'}
[0m20:44:01.770518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a1920aa-093d-413d-a15c-1411f72e37a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b88f36d630>]}
[0m20:44:01.839638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a1920aa-093d-413d-a15c-1411f72e37a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b88ecf2680>]}
[0m20:44:01.842457 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:44:01.920283 [debug] [MainThread]: checksum: 505cc0738468dbf8af23784e25e0465f2f41e62e9895701049268b92bd4ad565, vars: {'clean_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean',
 'ds': '20251207'}, profile: , target: , version: 1.10.15
[0m20:44:02.023537 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m20:44:02.024312 [debug] [MainThread]: Partial parsing: updated file: medallion_dbt://models/staging/stg_transactions.sql
[0m20:44:02.025036 [debug] [MainThread]: Partial parsing: updated file: medallion_dbt://tests/generic/non_negative.sql
[0m20:44:02.025541 [debug] [MainThread]: Partial parsing: updated file: medallion_dbt://models/marts/fct_customer_transactions.sql
[0m20:44:02.518744 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m20:44:02.519270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5a1920aa-093d-413d-a15c-1411f72e37a1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b8842a7700>]}
[0m20:44:02.627676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a1920aa-093d-413d-a15c-1411f72e37a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b8840f8130>]}
[0m20:44:02.721338 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m20:44:02.723932 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m20:44:02.742205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a1920aa-093d-413d-a15c-1411f72e37a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b884162560>]}
[0m20:44:02.743185 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m20:44:02.743832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a1920aa-093d-413d-a15c-1411f72e37a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b8841625f0>]}
[0m20:44:02.746701 [info ] [MainThread]: 
[0m20:44:02.747663 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:44:02.748197 [info ] [MainThread]: 
[0m20:44:02.748962 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:44:02.756369 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m20:44:02.791206 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m20:44:02.792205 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m20:44:02.792775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:44:02.810630 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m20:44:02.813649 [debug] [ThreadPool]: On list_medallion: Close
[0m20:44:02.815173 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m20:44:02.816501 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m20:44:02.826221 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m20:44:02.826925 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m20:44:02.827387 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:44:02.829568 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:44:02.832825 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m20:44:02.833624 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m20:44:02.834706 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:44:02.835117 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m20:44:02.835433 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m20:44:02.836514 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:44:02.837364 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m20:44:02.837744 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m20:44:02.838013 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m20:44:02.838614 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:44:02.838902 [debug] [ThreadPool]: On create_medallion_main: Close
[0m20:44:02.840205 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m20:44:02.847648 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m20:44:02.849282 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m20:44:02.849942 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:44:02.852614 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:44:02.853694 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m20:44:02.854400 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m20:44:02.865503 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m20:44:02.867592 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m20:44:02.868972 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m20:44:02.869480 [debug] [ThreadPool]: On list_medallion_main: Close
[0m20:44:02.871438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a1920aa-093d-413d-a15c-1411f72e37a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b886892da0>]}
[0m20:44:02.872301 [debug] [MainThread]: Using duckdb connection "master"
[0m20:44:02.872978 [debug] [MainThread]: On master: BEGIN
[0m20:44:02.873564 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:44:02.874841 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:44:02.875408 [debug] [MainThread]: On master: COMMIT
[0m20:44:02.875964 [debug] [MainThread]: Using duckdb connection "master"
[0m20:44:02.876499 [debug] [MainThread]: On master: COMMIT
[0m20:44:02.877451 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:44:02.877973 [debug] [MainThread]: On master: Close
[0m20:44:02.880983 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m20:44:02.881811 [info ] [Thread-1 (]: 1 of 2 START sql table model main.stg_transactions ............................. [RUN]
[0m20:44:02.882520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m20:44:02.883071 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m20:44:02.896705 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m20:44:02.898000 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m20:44:02.936687 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m20:44:02.938246 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m20:44:02.938789 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m20:44:02.939217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:44:02.940287 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:44:02.940835 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m20:44:02.941323 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
    
    

    create  table
      "medallion"."main"."stg_transactions__dbt_tmp"
  
    as (
      




WITH src AS (

    -- Leemos el archivo limpio producido por la capa Bronze
    SELECT *
    FROM read_parquet(
        '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean/transactions_20251207_clean.parquet'
    )

),

typed AS (

    SELECT
        CAST(transaction_id AS VARCHAR)    AS transaction_id,
        CAST(customer_id AS VARCHAR)       AS customer_id,
        CAST(amount AS DOUBLE)             AS amount,
        LOWER(TRIM(status))                AS status,
        CAST(transaction_ts AS TIMESTAMP)  AS transaction_ts
    FROM src

),

validated AS (

    SELECT
        transaction_id,
        customer_id,
        amount,
        status,
        transaction_ts,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    -- coherente con accepted_values del schema.yml
    WHERE status IN ('completed', 'pending', 'failed')

)

SELECT *
FROM validated;
    );
  
  
[0m20:44:02.944162 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
    
    

    create  table
      "medallion"."main"."stg_transactions__dbt_tmp"
  
    as (
      




WITH src AS (

    -- Leemos el archivo limpio producido por la capa Bronze
    SELECT *
    FROM read_parquet(
        '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean/transactions_20251207_clean.parquet'
    )

),

typed AS (

    SELECT
        CAST(transaction_id AS VARCHAR)    AS transaction_id,
        CAST(customer_id AS VARCHAR)       AS customer_id,
        CAST(amount AS DOUBLE)             AS amount,
        LOWER(TRIM(status))                AS status,
        CAST(transaction_ts AS TIMESTAMP)  AS transaction_ts
    FROM src

),

validated AS (

    SELECT
        transaction_id,
        customer_id,
        amount,
        status,
        transaction_ts,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    -- coherente con accepted_values del schema.yml
    WHERE status IN ('completed', 'pending', 'failed')

)

SELECT *
FROM validated;
    );
  
  
[0m20:44:02.945862 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:44:02.948035 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m20:44:02.951665 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m20:44:02.952161 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m20:44:02.954231 [debug] [Thread-1 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 54: FROM validated;
                         ^
[0m20:44:02.956119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a1920aa-093d-413d-a15c-1411f72e37a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b88416a9b0>]}
[0m20:44:02.956991 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model main.stg_transactions .................... [[31mERROR[0m in 0.07s]
[0m20:44:02.957682 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m20:44:02.958377 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 54: FROM validated;
                         ^.
[0m20:44:02.959914 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m20:44:02.960452 [info ] [Thread-3 (]: 2 of 2 SKIP relation main.fct_customer_transactions ............................ [[33mSKIP[0m]
[0m20:44:02.961035 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m20:44:02.962429 [debug] [MainThread]: Using duckdb connection "master"
[0m20:44:02.963100 [debug] [MainThread]: On master: BEGIN
[0m20:44:02.963674 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:44:02.965512 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:44:02.966010 [debug] [MainThread]: On master: COMMIT
[0m20:44:02.966406 [debug] [MainThread]: Using duckdb connection "master"
[0m20:44:02.966714 [debug] [MainThread]: On master: COMMIT
[0m20:44:02.967658 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:44:02.968361 [debug] [MainThread]: On master: Close
[0m20:44:02.969295 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:44:02.969787 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m20:44:02.970628 [info ] [MainThread]: 
[0m20:44:02.971260 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m20:44:02.972792 [debug] [MainThread]: Command end result
[0m20:44:03.002143 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m20:44:03.007004 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m20:44:03.017577 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m20:44:03.018151 [info ] [MainThread]: 
[0m20:44:03.018563 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:44:03.018899 [info ] [MainThread]: 
[0m20:44:03.019295 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m20:44:03.019605 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 54: FROM validated;
                         ^
[0m20:44:03.019844 [info ] [MainThread]: 
[0m20:44:03.020148 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m20:44:03.020431 [info ] [MainThread]: 
[0m20:44:03.020713 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m20:44:03.021216 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:44:03.021954 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5363327, "process_in_blocks": "800", "process_kernel_time": 0.154898, "process_mem_max_rss": "158360", "process_out_blocks": "3216", "process_user_time": 2.795174}
[0m20:44:03.022429 [debug] [MainThread]: Command `dbt run` failed at 20:44:03.022338 after 1.54 seconds
[0m20:44:03.023475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b88f471480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b88ecf2680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b88f4e95a0>]}
[0m20:44:03.024702 [debug] [MainThread]: Flushing usage events
[0m20:44:03.758050 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:45:07.104245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723ee4465450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723ee34102b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723ee3410250>]}


============================== 20:45:07.107862 | dccba73a-7927-44ec-83fc-7dfe86c94101 ==============================
[0m20:45:07.107862 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:45:07.108612 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles', 'empty': 'False', 'log_format': 'default', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --profiles-dir /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles --vars {"ds": "20251207", "clean_dir": "/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean"}', 'no_print': 'None', 'fail_fast': 'False', 'static_parser': 'True', 'target_path': 'None', 'quiet': 'False', 'log_path': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/logs'}
[0m20:45:07.382183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dccba73a-7927-44ec-83fc-7dfe86c94101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723ee435faf0>]}
[0m20:45:07.446057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dccba73a-7927-44ec-83fc-7dfe86c94101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723ee3c1e980>]}
[0m20:45:07.447722 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:45:07.524942 [debug] [MainThread]: checksum: 505cc0738468dbf8af23784e25e0465f2f41e62e9895701049268b92bd4ad565, vars: {'clean_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean',
 'ds': '20251207'}, profile: , target: , version: 1.10.15
[0m20:45:07.638256 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:45:07.638822 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:45:07.688295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dccba73a-7927-44ec-83fc-7dfe86c94101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723edb348130>]}
[0m20:45:07.853072 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m20:45:07.854742 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m20:45:07.865636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dccba73a-7927-44ec-83fc-7dfe86c94101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723edb4a0520>]}
[0m20:45:07.866404 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m20:45:07.866890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dccba73a-7927-44ec-83fc-7dfe86c94101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723edb479db0>]}
[0m20:45:07.868456 [info ] [MainThread]: 
[0m20:45:07.868838 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:45:07.869117 [info ] [MainThread]: 
[0m20:45:07.869918 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:45:07.874783 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m20:45:07.911968 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m20:45:07.912448 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m20:45:07.912825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:45:07.925798 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m20:45:07.927155 [debug] [ThreadPool]: On list_medallion: Close
[0m20:45:07.930023 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m20:45:07.931398 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m20:45:07.938235 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m20:45:07.938595 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m20:45:07.938883 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:45:07.940055 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:45:07.941278 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m20:45:07.941616 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m20:45:07.942373 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:45:07.942779 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m20:45:07.943067 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m20:45:07.943634 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:45:07.944372 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m20:45:07.944673 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m20:45:07.944932 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m20:45:07.945565 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:45:07.945932 [debug] [ThreadPool]: On create_medallion_main: Close
[0m20:45:07.949049 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m20:45:07.961248 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m20:45:07.962081 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m20:45:07.962432 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:45:07.965064 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:45:07.965763 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m20:45:07.966221 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m20:45:07.978749 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m20:45:07.980856 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m20:45:07.982320 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m20:45:07.982884 [debug] [ThreadPool]: On list_medallion_main: Close
[0m20:45:07.984792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dccba73a-7927-44ec-83fc-7dfe86c94101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723edb6ffdf0>]}
[0m20:45:07.986170 [debug] [MainThread]: Using duckdb connection "master"
[0m20:45:07.986731 [debug] [MainThread]: On master: BEGIN
[0m20:45:07.987134 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:45:07.989038 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:45:07.989419 [debug] [MainThread]: On master: COMMIT
[0m20:45:07.989831 [debug] [MainThread]: Using duckdb connection "master"
[0m20:45:07.990269 [debug] [MainThread]: On master: COMMIT
[0m20:45:07.991060 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:45:07.991383 [debug] [MainThread]: On master: Close
[0m20:45:07.993546 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m20:45:07.994182 [info ] [Thread-1 (]: 1 of 2 START sql table model main.stg_transactions ............................. [RUN]
[0m20:45:07.994705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m20:45:07.995031 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m20:45:08.005642 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m20:45:08.006288 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m20:45:08.040297 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m20:45:08.041063 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m20:45:08.041455 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m20:45:08.041762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:45:08.042650 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:45:08.043062 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m20:45:08.043437 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
    
    

    create  table
      "medallion"."main"."stg_transactions__dbt_tmp"
  
    as (
      




WITH src AS (

    -- Leemos el archivo limpio producido por la capa Bronze
    SELECT *
    FROM read_parquet(
        '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean/transactions_20251207_clean.parquet'
    )

),

typed AS (

    SELECT
        CAST(transaction_id AS VARCHAR)    AS transaction_id,
        CAST(customer_id AS VARCHAR)       AS customer_id,
        CAST(amount AS DOUBLE)             AS amount,
        LOWER(TRIM(status))                AS status,
        CAST(transaction_ts AS TIMESTAMP)  AS transaction_ts
    FROM src

),

validated AS (

    SELECT
        transaction_id,
        customer_id,
        amount,
        status,
        transaction_ts,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    -- coherente con accepted_values del schema.yml
    WHERE status IN ('completed', 'pending', 'failed')

)

SELECT *
FROM validated;
    );
  
  
[0m20:45:08.044092 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
    
    

    create  table
      "medallion"."main"."stg_transactions__dbt_tmp"
  
    as (
      




WITH src AS (

    -- Leemos el archivo limpio producido por la capa Bronze
    SELECT *
    FROM read_parquet(
        '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean/transactions_20251207_clean.parquet'
    )

),

typed AS (

    SELECT
        CAST(transaction_id AS VARCHAR)    AS transaction_id,
        CAST(customer_id AS VARCHAR)       AS customer_id,
        CAST(amount AS DOUBLE)             AS amount,
        LOWER(TRIM(status))                AS status,
        CAST(transaction_ts AS TIMESTAMP)  AS transaction_ts
    FROM src

),

validated AS (

    SELECT
        transaction_id,
        customer_id,
        amount,
        status,
        transaction_ts,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    -- coherente con accepted_values del schema.yml
    WHERE status IN ('completed', 'pending', 'failed')

)

SELECT *
FROM validated;
    );
  
  
[0m20:45:08.044578 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:45:08.045395 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m20:45:08.048659 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m20:45:08.049185 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m20:45:08.050037 [debug] [Thread-1 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 54: FROM validated;
                         ^
[0m20:45:08.051442 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dccba73a-7927-44ec-83fc-7dfe86c94101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723ee5e3e9b0>]}
[0m20:45:08.052059 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model main.stg_transactions .................... [[31mERROR[0m in 0.06s]
[0m20:45:08.052691 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m20:45:08.053273 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 54: FROM validated;
                         ^.
[0m20:45:08.054634 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m20:45:08.055035 [info ] [Thread-3 (]: 2 of 2 SKIP relation main.fct_customer_transactions ............................ [[33mSKIP[0m]
[0m20:45:08.055404 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m20:45:08.056202 [debug] [MainThread]: Using duckdb connection "master"
[0m20:45:08.056484 [debug] [MainThread]: On master: BEGIN
[0m20:45:08.056749 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:45:08.057498 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:45:08.057850 [debug] [MainThread]: On master: COMMIT
[0m20:45:08.058329 [debug] [MainThread]: Using duckdb connection "master"
[0m20:45:08.058655 [debug] [MainThread]: On master: COMMIT
[0m20:45:08.059293 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:45:08.059583 [debug] [MainThread]: On master: Close
[0m20:45:08.059967 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:45:08.060301 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m20:45:08.060694 [info ] [MainThread]: 
[0m20:45:08.061016 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m20:45:08.061820 [debug] [MainThread]: Command end result
[0m20:45:08.083469 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m20:45:08.086636 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m20:45:08.092670 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m20:45:08.093088 [info ] [MainThread]: 
[0m20:45:08.093428 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:45:08.093744 [info ] [MainThread]: 
[0m20:45:08.094090 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m20:45:08.094407 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 54: FROM validated;
                         ^
[0m20:45:08.094676 [info ] [MainThread]: 
[0m20:45:08.095003 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m20:45:08.095594 [info ] [MainThread]: 
[0m20:45:08.096070 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m20:45:08.097898 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0568924, "process_in_blocks": "0", "process_kernel_time": 0.131, "process_mem_max_rss": "151028", "process_out_blocks": "2200", "process_user_time": 2.34301}
[0m20:45:08.098828 [debug] [MainThread]: Command `dbt run` failed at 20:45:08.098601 after 1.06 seconds
[0m20:45:08.099304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723ee4465450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723ee435f2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723ee435d780>]}
[0m20:45:08.100037 [debug] [MainThread]: Flushing usage events
[0m20:45:09.209742 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:47:50.027039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a00f3865420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a00f28102b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a00f2810250>]}


============================== 20:47:50.032168 | e124c3fe-dbe3-42d9-9b36-cd551046f4e7 ==============================
[0m20:47:50.032168 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:47:50.034696 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'cache_selected_only': 'False', 'quiet': 'False', 'invocation_command': 'dbt run --profiles-dir /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles --vars {"ds": "20251207", "clean_dir": "/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean"}', 'partial_parse': 'True', 'debug': 'False', 'printer_width': '80', 'use_colors': 'True', 'log_path': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles', 'log_format': 'default', 'write_json': 'True', 'no_print': 'None', 'version_check': 'True', 'log_cache_events': 'False', 'empty': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'static_parser': 'True'}
[0m20:47:50.295992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e124c3fe-dbe3-42d9-9b36-cd551046f4e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a00f375cf10>]}
[0m20:47:50.379326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e124c3fe-dbe3-42d9-9b36-cd551046f4e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a00f30c7be0>]}
[0m20:47:50.384163 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:47:50.494000 [debug] [MainThread]: checksum: 505cc0738468dbf8af23784e25e0465f2f41e62e9895701049268b92bd4ad565, vars: {'clean_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean',
 'ds': '20251207'}, profile: , target: , version: 1.10.15
[0m20:47:50.679911 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:47:50.681262 [debug] [MainThread]: Partial parsing: updated file: medallion_dbt://models/staging/stg_transactions.sql
[0m20:47:51.236767 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m20:47:51.238315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e124c3fe-dbe3-42d9-9b36-cd551046f4e7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a00e96b1d20>]}
[0m20:47:51.297328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e124c3fe-dbe3-42d9-9b36-cd551046f4e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a00e9548130>]}
[0m20:47:51.439670 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m20:47:51.442836 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m20:47:51.478439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e124c3fe-dbe3-42d9-9b36-cd551046f4e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a00e96f2b00>]}
[0m20:47:51.479372 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m20:47:51.480290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e124c3fe-dbe3-42d9-9b36-cd551046f4e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a00e96f22c0>]}
[0m20:47:51.488188 [info ] [MainThread]: 
[0m20:47:51.490272 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:47:51.490997 [info ] [MainThread]: 
[0m20:47:51.492536 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:47:51.505730 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m20:47:51.556138 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m20:47:51.556982 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m20:47:51.557723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:47:51.581426 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m20:47:51.583003 [debug] [ThreadPool]: On list_medallion: Close
[0m20:47:51.584603 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m20:47:51.585879 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m20:47:51.597681 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m20:47:51.598382 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m20:47:51.598759 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:47:51.604205 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m20:47:51.608248 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m20:47:51.609002 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m20:47:51.610658 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:47:51.611320 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m20:47:51.611720 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m20:47:51.612748 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:47:51.613954 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m20:47:51.614442 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m20:47:51.614832 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m20:47:51.616467 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:47:51.617144 [debug] [ThreadPool]: On create_medallion_main: Close
[0m20:47:51.619056 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion_main'
[0m20:47:51.626465 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m20:47:51.626960 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m20:47:51.627298 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:47:51.628092 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:47:51.628389 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m20:47:51.628699 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m20:47:51.643353 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m20:47:51.644765 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m20:47:51.645471 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m20:47:51.645783 [debug] [ThreadPool]: On list_medallion_main: Close
[0m20:47:51.646661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e124c3fe-dbe3-42d9-9b36-cd551046f4e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a00e957aaa0>]}
[0m20:47:51.647095 [debug] [MainThread]: Using duckdb connection "master"
[0m20:47:51.647381 [debug] [MainThread]: On master: BEGIN
[0m20:47:51.647634 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:47:51.648272 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:47:51.648575 [debug] [MainThread]: On master: COMMIT
[0m20:47:51.648928 [debug] [MainThread]: Using duckdb connection "master"
[0m20:47:51.649351 [debug] [MainThread]: On master: COMMIT
[0m20:47:51.654322 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m20:47:51.656127 [debug] [MainThread]: On master: Close
[0m20:47:51.659972 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m20:47:51.660846 [info ] [Thread-1 (]: 1 of 2 START sql table model main.stg_transactions ............................. [RUN]
[0m20:47:51.661436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m20:47:51.661781 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m20:47:51.673753 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m20:47:51.674507 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m20:47:51.720043 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m20:47:51.723222 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m20:47:51.724363 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m20:47:51.725355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:47:51.728467 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:47:51.730871 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m20:47:51.732586 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
    
    

    create  table
      "medallion"."main"."stg_transactions__dbt_tmp"
  
    as (
      




WITH src AS (

    -- Leemos el archivo limpio producido por la capa Bronze
    SELECT *
    FROM read_parquet(
        '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean/transactions_20251207_clean.parquet'
    )

),

typed AS (

    SELECT
        CAST(transaction_id AS VARCHAR)    AS transaction_id,
        CAST(customer_id AS VARCHAR)       AS customer_id,
        CAST(amount AS DOUBLE)             AS amount,
        LOWER(TRIM(status))                AS status,
        CAST(transaction_ts AS TIMESTAMP)  AS transaction_ts
    FROM src

),

validated AS (

    SELECT
        transaction_id,
        customer_id,
        amount,
        status,
        transaction_ts,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    -- coherente con accepted_values del schema.yml
    WHERE status IN ('completed', 'pending', 'failed')

)

SELECT *
FROM validated
    );
  
  
[0m20:47:51.740807 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m20:47:51.755272 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m20:47:51.756272 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_transactions'
  
[0m20:47:51.757683 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:47:51.759244 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m20:47:51.759709 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_transactions'
  
[0m20:47:51.760720 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:47:51.770207 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m20:47:51.770808 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */
alter table "medallion"."main"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m20:47:51.772746 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:47:51.775869 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m20:47:51.776329 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */
alter table "medallion"."main"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m20:47:51.777239 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:47:51.794197 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m20:47:51.795141 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m20:47:51.796316 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m20:47:51.799703 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:47:51.807551 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m20:47:51.808329 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

      drop table if exists "medallion"."main"."stg_transactions__dbt_backup" cascade
    
[0m20:47:51.809958 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:47:51.814962 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m20:47:51.817268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e124c3fe-dbe3-42d9-9b36-cd551046f4e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a00ee555db0>]}
[0m20:47:51.817966 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.stg_transactions ........................ [[32mOK[0m in 0.15s]
[0m20:47:51.818578 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m20:47:51.819798 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m20:47:51.820296 [info ] [Thread-3 (]: 2 of 2 START sql table model main.fct_customer_transactions .................... [RUN]
[0m20:47:51.820812 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.medallion_dbt.fct_customer_transactions'
[0m20:47:51.821185 [debug] [Thread-3 (]: Began compiling node model.medallion_dbt.fct_customer_transactions
[0m20:47:51.823999 [debug] [Thread-3 (]: Writing injected SQL for node "model.medallion_dbt.fct_customer_transactions"
[0m20:47:51.824576 [debug] [Thread-3 (]: Began executing node model.medallion_dbt.fct_customer_transactions
[0m20:47:51.830765 [debug] [Thread-3 (]: Writing runtime sql for node "model.medallion_dbt.fct_customer_transactions"
[0m20:47:51.833764 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m20:47:51.834951 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: BEGIN
[0m20:47:51.835498 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:47:51.837640 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m20:47:51.838163 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m20:47:51.838561 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      -- models/marts/fct_customer_transactions.sql



WITH src AS (

    -- Leemos directamente desde el staging model
    SELECT
        customer_id,
        amount,
        status
    FROM "medallion"."main"."stg_transactions"

),

aggregated AS (

    SELECT
        customer_id,

        -- Cantidad total de transacciones por cliente
        COUNT(*) AS transaction_count,

        -- Suma de montos solo para transacciones completadas
        COALESCE(
            SUM(CASE WHEN status = 'completed' THEN amount ELSE 0 END),
        0) AS total_amount_completed,

        -- Suma de montos sin filtrar por estado
        COALESCE(SUM(amount), 0) AS total_amount_all

    FROM src
    GROUP BY customer_id

)

SELECT *
FROM aggregated
    );
  
  
[0m20:47:51.845656 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m20:47:51.848345 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m20:47:51.849335 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'fct_customer_transactions'
  
[0m20:47:51.851217 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:47:51.853792 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m20:47:51.854560 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'fct_customer_transactions'
  
[0m20:47:51.856535 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:47:51.862752 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m20:47:51.863645 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */
alter table "medallion"."main"."fct_customer_transactions" rename to "fct_customer_transactions__dbt_backup"
[0m20:47:51.867239 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m20:47:51.875537 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m20:47:51.876426 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */
alter table "medallion"."main"."fct_customer_transactions__dbt_tmp" rename to "fct_customer_transactions"
[0m20:47:51.877854 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:47:51.880178 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: COMMIT
[0m20:47:51.881775 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m20:47:51.883423 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: COMMIT
[0m20:47:51.890486 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m20:47:51.894614 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m20:47:51.895176 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

      drop table if exists "medallion"."main"."fct_customer_transactions__dbt_backup" cascade
    
[0m20:47:51.896901 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:47:51.898393 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: Close
[0m20:47:51.899697 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e124c3fe-dbe3-42d9-9b36-cd551046f4e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a00e88dd6c0>]}
[0m20:47:51.901242 [info ] [Thread-3 (]: 2 of 2 OK created sql table model main.fct_customer_transactions ............... [[32mOK[0m in 0.08s]
[0m20:47:51.902510 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m20:47:51.904797 [debug] [MainThread]: Using duckdb connection "master"
[0m20:47:51.905238 [debug] [MainThread]: On master: BEGIN
[0m20:47:51.905556 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:47:51.906496 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:47:51.906825 [debug] [MainThread]: On master: COMMIT
[0m20:47:51.907134 [debug] [MainThread]: Using duckdb connection "master"
[0m20:47:51.907455 [debug] [MainThread]: On master: COMMIT
[0m20:47:51.910038 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:47:51.910646 [debug] [MainThread]: On master: Close
[0m20:47:51.911190 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:47:51.911486 [debug] [MainThread]: Connection 'create_medallion_main' was properly closed.
[0m20:47:51.911727 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m20:47:51.911955 [debug] [MainThread]: Connection 'model.medallion_dbt.fct_customer_transactions' was properly closed.
[0m20:47:51.912286 [info ] [MainThread]: 
[0m20:47:51.912593 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m20:47:51.913257 [debug] [MainThread]: Command end result
[0m20:47:51.945750 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m20:47:51.951334 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m20:47:51.959020 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m20:47:51.959450 [info ] [MainThread]: 
[0m20:47:51.959791 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:47:51.960053 [info ] [MainThread]: 
[0m20:47:51.960336 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m20:47:51.960863 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:47:51.961610 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9994053, "process_in_blocks": "768", "process_kernel_time": 0.202704, "process_mem_max_rss": "161652", "process_out_blocks": "3280", "process_user_time": 3.196567}
[0m20:47:51.961991 [debug] [MainThread]: Command `dbt run` succeeded at 20:47:51.961919 after 2.00 seconds
[0m20:47:51.962408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a00f3865420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a00f52119c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a00ea8c53c0>]}
[0m20:47:51.962925 [debug] [MainThread]: Flushing usage events
[0m20:47:52.676602 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:47:55.914790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748912069420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748911010250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7489110101f0>]}


============================== 20:47:55.917682 | 2c45d561-820e-49c8-829d-336fe7957196 ==============================
[0m20:47:55.917682 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:47:55.918409 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt test --profiles-dir /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles --vars {"ds": "20251207", "clean_dir": "/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean"}', 'log_path': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/logs', 'cache_selected_only': 'False', 'printer_width': '80', 'introspect': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'target_path': 'None', 'log_format': 'default', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'static_parser': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'profiles_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles'}
[0m20:47:56.213890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c45d561-820e-49c8-829d-336fe7957196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748913a119c0>]}
[0m20:47:56.350770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c45d561-820e-49c8-829d-336fe7957196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7489119f67a0>]}
[0m20:47:56.354712 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:47:56.545122 [debug] [MainThread]: checksum: 505cc0738468dbf8af23784e25e0465f2f41e62e9895701049268b92bd4ad565, vars: {'clean_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean',
 'ds': '20251207'}, profile: , target: , version: 1.10.15
[0m20:47:56.772962 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:47:56.774180 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:47:56.850107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c45d561-820e-49c8-829d-336fe7957196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748908040130>]}
[0m20:47:57.130432 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m20:47:57.134661 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m20:47:57.175188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c45d561-820e-49c8-829d-336fe7957196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748908043b20>]}
[0m20:47:57.176005 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m20:47:57.176494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c45d561-820e-49c8-829d-336fe7957196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748912d83eb0>]}
[0m20:47:57.179024 [info ] [MainThread]: 
[0m20:47:57.179519 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:47:57.179929 [info ] [MainThread]: 
[0m20:47:57.180748 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:47:57.191281 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion_main'
[0m20:47:57.233931 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m20:47:57.235476 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m20:47:57.236443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:47:57.253087 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m20:47:57.255042 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m20:47:57.255797 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m20:47:57.269125 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m20:47:57.273014 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m20:47:57.273674 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m20:47:57.274018 [debug] [ThreadPool]: On list_medallion_main: Close
[0m20:47:57.274957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c45d561-820e-49c8-829d-336fe7957196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748908043b20>]}
[0m20:47:57.275437 [debug] [MainThread]: Using duckdb connection "master"
[0m20:47:57.275714 [debug] [MainThread]: On master: BEGIN
[0m20:47:57.275977 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:47:57.276900 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:47:57.277334 [debug] [MainThread]: On master: COMMIT
[0m20:47:57.277623 [debug] [MainThread]: Using duckdb connection "master"
[0m20:47:57.277871 [debug] [MainThread]: On master: COMMIT
[0m20:47:57.278342 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:47:57.278631 [debug] [MainThread]: On master: Close
[0m20:47:57.280886 [debug] [Thread-1 (]: Began running node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m20:47:57.281804 [debug] [Thread-2 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m20:47:57.282677 [debug] [Thread-3 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m20:47:57.283246 [debug] [Thread-4 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m20:47:57.283958 [info ] [Thread-1 (]: 1 of 16 START test accepted_values_stg_transactions_status__completed__pending__failed  [RUN]
[0m20:47:57.284995 [info ] [Thread-2 (]: 2 of 16 START test non_negative_fct_customer_transactions_total_amount_all ..... [RUN]
[0m20:47:57.285983 [info ] [Thread-3 (]: 3 of 16 START test non_negative_fct_customer_transactions_total_amount_completed  [RUN]
[0m20:47:57.286850 [info ] [Thread-4 (]: 4 of 16 START test non_negative_fct_customer_transactions_transaction_count .... [RUN]
[0m20:47:57.288171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26)
[0m20:47:57.289251 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89'
[0m20:47:57.290032 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428'
[0m20:47:57.290942 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4'
[0m20:47:57.291681 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m20:47:57.292201 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m20:47:57.292728 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m20:47:57.293126 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m20:47:57.321145 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m20:47:57.322042 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m20:47:57.332399 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m20:47:57.345039 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m20:47:57.347995 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m20:47:57.348861 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m20:47:57.349836 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m20:47:57.351167 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m20:47:57.401399 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m20:47:57.405058 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m20:47:57.408401 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m20:47:57.414776 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m20:47:57.424608 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m20:47:57.426545 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: BEGIN
[0m20:47:57.428006 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m20:47:57.428584 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m20:47:57.429134 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m20:47:57.429673 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:47:57.430214 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: BEGIN
[0m20:47:57.430811 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: BEGIN
[0m20:47:57.431373 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: BEGIN
[0m20:47:57.432226 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:47:57.432633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:47:57.433044 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m20:47:57.433459 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:47:57.434384 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m20:47:57.434760 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m20:47:57.435249 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:47:57.435685 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- Test gen√©rico: los valores deben ser NO NEGATIVOS y NO NULOS.
-- El test pasa si esta consulta devuelve CERO filas.

select
    total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed is null
   or total_amount_completed < 0


  
  
      
    ) dbt_internal_test
[0m20:47:57.436556 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:47:57.437634 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m20:47:57.438746 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m20:47:57.443609 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "medallion"."main"."stg_transactions"
    group by status

)

select *
from all_values
where value_field not in (
    'completed','pending','failed'
)



  
  
      
    ) dbt_internal_test
[0m20:47:57.440007 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m20:47:57.445758 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- Test gen√©rico: los valores deben ser NO NEGATIVOS y NO NULOS.
-- El test pasa si esta consulta devuelve CERO filas.

select
    total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all is null
   or total_amount_all < 0


  
  
      
    ) dbt_internal_test
[0m20:47:57.449441 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m20:47:57.441906 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- Test gen√©rico: los valores deben ser NO NEGATIVOS y NO NULOS.
-- El test pasa si esta consulta devuelve CERO filas.

select
    transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count is null
   or transaction_count < 0


  
  
      
    ) dbt_internal_test
[0m20:47:57.466262 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: ROLLBACK
[0m20:47:57.467001 [debug] [Thread-2 (]: SQL status: OK in 0.020 seconds
[0m20:47:57.467588 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m20:47:57.468009 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428'
[0m20:47:57.468375 [debug] [Thread-4 (]: SQL status: OK in 0.016 seconds
[0m20:47:57.470137 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: ROLLBACK
[0m20:47:57.470664 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: Close
[0m20:47:57.471744 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: ROLLBACK
[0m20:47:57.472244 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89'
[0m20:47:57.474219 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: ROLLBACK
[0m20:47:57.476693 [info ] [Thread-3 (]: 3 of 16 PASS non_negative_fct_customer_transactions_total_amount_completed ..... [[32mPASS[0m in 0.19s]
[0m20:47:57.478827 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26'
[0m20:47:57.480255 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: Close
[0m20:47:57.481463 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4'
[0m20:47:57.482806 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m20:47:57.483481 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: Close
[0m20:47:57.484274 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: Close
[0m20:47:57.485935 [info ] [Thread-2 (]: 2 of 16 PASS non_negative_fct_customer_transactions_total_amount_all ........... [[32mPASS[0m in 0.20s]
[0m20:47:57.487273 [debug] [Thread-3 (]: Began running node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m20:47:57.488949 [info ] [Thread-1 (]: 1 of 16 PASS accepted_values_stg_transactions_status__completed__pending__failed  [[32mPASS[0m in 0.20s]
[0m20:47:57.490765 [info ] [Thread-4 (]: 4 of 16 PASS non_negative_fct_customer_transactions_transaction_count .......... [[32mPASS[0m in 0.20s]
[0m20:47:57.492216 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m20:47:57.493114 [info ] [Thread-3 (]: 5 of 16 START test non_negative_stg_transactions_amount ........................ [RUN]
[0m20:47:57.494109 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m20:47:57.495126 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m20:47:57.495808 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m20:47:57.496463 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428, now test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733)
[0m20:47:57.496878 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m20:47:57.497319 [debug] [Thread-4 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m20:47:57.497730 [info ] [Thread-2 (]: 6 of 16 START test not_null_fct_customer_transactions_customer_id .............. [RUN]
[0m20:47:57.498165 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m20:47:57.498589 [info ] [Thread-1 (]: 7 of 16 START test not_null_fct_customer_transactions_total_amount_all ......... [RUN]
[0m20:47:57.498989 [info ] [Thread-4 (]: 8 of 16 START test not_null_fct_customer_transactions_total_amount_completed ... [RUN]
[0m20:47:57.499444 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89, now test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c)
[0m20:47:57.506758 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m20:47:57.508535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26, now test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f)
[0m20:47:57.509174 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4, now test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418)
[0m20:47:57.509820 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m20:47:57.510335 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m20:47:57.510759 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m20:47:57.511106 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m20:47:57.527329 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m20:47:57.537858 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m20:47:57.542055 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m20:47:57.546954 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m20:47:57.550815 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m20:47:57.552002 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m20:47:57.553329 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m20:47:57.559663 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m20:47:57.562398 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m20:47:57.562931 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m20:47:57.563371 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: BEGIN
[0m20:47:57.564110 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m20:47:57.564487 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m20:47:57.566794 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m20:47:57.567299 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:47:57.567911 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: BEGIN
[0m20:47:57.568516 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: BEGIN
[0m20:47:57.570527 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m20:47:57.571308 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:47:57.571707 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m20:47:57.572098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:47:57.572507 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: BEGIN
[0m20:47:57.573171 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m20:47:57.573620 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:47:57.573977 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:47:57.575566 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:47:57.576264 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- Test gen√©rico: los valores deben ser NO NEGATIVOS y NO NULOS.
-- El test pasa si esta consulta devuelve CERO filas.

select
    amount
from "medallion"."main"."stg_transactions"
where amount is null
   or amount < 0


  
  
      
    ) dbt_internal_test
[0m20:47:57.577031 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m20:47:57.578045 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m20:47:57.578917 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m20:47:57.580519 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "medallion"."main"."fct_customer_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m20:47:57.581187 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all is null



  
  
      
    ) dbt_internal_test
[0m20:47:57.581885 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m20:47:57.583245 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed is null



  
  
      
    ) dbt_internal_test
[0m20:47:57.584409 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:47:57.585290 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:47:57.585975 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m20:47:57.586568 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m20:47:57.588414 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: ROLLBACK
[0m20:47:57.590728 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: ROLLBACK
[0m20:47:57.592705 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: ROLLBACK
[0m20:47:57.593932 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: ROLLBACK
[0m20:47:57.595011 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f'
[0m20:47:57.595535 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c'
[0m20:47:57.596926 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418'
[0m20:47:57.597806 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733'
[0m20:47:57.598423 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: Close
[0m20:47:57.598923 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: Close
[0m20:47:57.599328 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: Close
[0m20:47:57.599777 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: Close
[0m20:47:57.600807 [info ] [Thread-1 (]: 7 of 16 PASS not_null_fct_customer_transactions_total_amount_all ............... [[32mPASS[0m in 0.09s]
[0m20:47:57.602383 [info ] [Thread-2 (]: 6 of 16 PASS not_null_fct_customer_transactions_customer_id .................... [[32mPASS[0m in 0.10s]
[0m20:47:57.603498 [info ] [Thread-4 (]: 8 of 16 PASS not_null_fct_customer_transactions_total_amount_completed ......... [[32mPASS[0m in 0.09s]
[0m20:47:57.604838 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m20:47:57.604332 [error] [Thread-3 (]: 5 of 16 FAIL 1 non_negative_stg_transactions_amount ............................ [[31mFAIL 1[0m in 0.11s]
[0m20:47:57.605467 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m20:47:57.605966 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m20:47:57.606361 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m20:47:57.606957 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m20:47:57.607447 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m20:47:57.607881 [debug] [Thread-4 (]: Began running node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m20:47:57.608300 [info ] [Thread-1 (]: 9 of 16 START test not_null_fct_customer_transactions_transaction_count ........ [RUN]
[0m20:47:57.608736 [debug] [Thread-3 (]: Began running node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m20:47:57.609252 [info ] [Thread-2 (]: 10 of 16 START test not_null_stg_transactions_amount ........................... [RUN]
[0m20:47:57.609719 [info ] [Thread-4 (]: 11 of 16 START test not_null_stg_transactions_customer_id ...................... [RUN]
[0m20:47:57.610538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f, now test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e)
[0m20:47:57.611172 [info ] [Thread-3 (]: 12 of 16 START test not_null_stg_transactions_status ........................... [RUN]
[0m20:47:57.612304 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c, now test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e)
[0m20:47:57.613044 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418, now test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf)
[0m20:47:57.614296 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m20:47:57.615184 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733, now test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875)
[0m20:47:57.616212 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m20:47:57.616794 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m20:47:57.625962 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m20:47:57.626662 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m20:47:57.631806 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m20:47:57.644280 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m20:47:57.650164 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m20:47:57.650807 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m20:47:57.651305 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m20:47:57.651955 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m20:47:57.654972 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m20:47:57.656664 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m20:47:57.666150 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m20:47:57.681783 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m20:47:57.682206 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m20:47:57.682878 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m20:47:57.683544 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m20:47:57.683981 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m20:47:57.684350 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: BEGIN
[0m20:47:57.684718 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: BEGIN
[0m20:47:57.685109 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m20:47:57.685420 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: BEGIN
[0m20:47:57.685747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:47:57.686052 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:47:57.686490 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: BEGIN
[0m20:47:57.686844 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:47:57.687937 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:47:57.689664 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:47:57.690764 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:47:57.694679 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m20:47:57.693662 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m20:47:57.692378 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m20:47:57.695461 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m20:47:57.696063 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count is null



  
  
      
    ) dbt_internal_test
[0m20:47:57.697335 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select amount
from "medallion"."main"."stg_transactions"
where amount is null



  
  
      
    ) dbt_internal_test
[0m20:47:57.698434 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m20:47:57.699380 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m20:47:57.701319 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "medallion"."main"."stg_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m20:47:57.702306 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:47:57.702936 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select status
from "medallion"."main"."stg_transactions"
where status is null



  
  
      
    ) dbt_internal_test
[0m20:47:57.703507 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:47:57.708258 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: ROLLBACK
[0m20:47:57.711897 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m20:47:57.715960 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: ROLLBACK
[0m20:47:57.717293 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e'
[0m20:47:57.718381 [debug] [Thread-3 (]: SQL status: OK in 0.013 seconds
[0m20:47:57.719646 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e'
[0m20:47:57.720148 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: Close
[0m20:47:57.721704 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: ROLLBACK
[0m20:47:57.722200 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: Close
[0m20:47:57.724183 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: ROLLBACK
[0m20:47:57.726801 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf'
[0m20:47:57.728572 [error] [Thread-2 (]: 10 of 16 FAIL 1 not_null_stg_transactions_amount ............................... [[31mFAIL 1[0m in 0.12s]
[0m20:47:57.731978 [info ] [Thread-1 (]: 9 of 16 PASS not_null_fct_customer_transactions_transaction_count .............. [[32mPASS[0m in 0.12s]
[0m20:47:57.733441 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875'
[0m20:47:57.734362 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: Close
[0m20:47:57.735599 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m20:47:57.736726 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m20:47:57.737535 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: Close
[0m20:47:57.740625 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m20:47:57.738707 [info ] [Thread-4 (]: 11 of 16 PASS not_null_stg_transactions_customer_id ............................ [[32mPASS[0m in 0.13s]
[0m20:47:57.743174 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m20:47:57.749945 [info ] [Thread-1 (]: 14 of 16 START test not_null_stg_transactions_transaction_id ................... [RUN]
[0m20:47:57.745384 [info ] [Thread-3 (]: 12 of 16 PASS not_null_stg_transactions_status ................................. [[32mPASS[0m in 0.13s]
[0m20:47:57.751708 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m20:47:57.752317 [debug] [Thread-3 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m20:47:57.747874 [info ] [Thread-2 (]: 13 of 16 START test not_null_stg_transactions_transaction_date ................. [RUN]
[0m20:47:57.751018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e, now test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4)
[0m20:47:57.749200 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m20:47:57.752819 [info ] [Thread-3 (]: 15 of 16 START test not_null_stg_transactions_transaction_ts ................... [RUN]
[0m20:47:57.753295 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e, now test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c)
[0m20:47:57.755371 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m20:47:57.754118 [debug] [Thread-4 (]: Began running node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m20:47:57.754760 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875, now test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7)
[0m20:47:57.753643 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m20:47:57.763043 [info ] [Thread-4 (]: 16 of 16 START test unique_stg_transactions_transaction_id ..................... [RUN]
[0m20:47:57.774605 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m20:47:57.776427 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m20:47:57.784229 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m20:47:57.786580 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf, now test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396)
[0m20:47:57.797033 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m20:47:57.797738 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m20:47:57.798360 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m20:47:57.798881 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m20:47:57.802238 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m20:47:57.802748 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m20:47:57.824904 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m20:47:57.828421 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m20:47:57.832709 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m20:47:57.835163 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m20:47:57.837469 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m20:47:57.839229 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: BEGIN
[0m20:47:57.840652 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m20:47:57.848839 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m20:47:57.850172 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m20:47:57.851413 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:47:57.852772 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: BEGIN
[0m20:47:57.853681 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: BEGIN
[0m20:47:57.854613 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m20:47:57.855014 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:47:57.855394 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m20:47:57.855838 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:47:57.856221 [debug] [Thread-4 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: BEGIN
[0m20:47:57.856813 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m20:47:57.857271 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:47:57.857597 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:47:57.857978 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m20:47:57.858323 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_date
from "medallion"."main"."stg_transactions"
where transaction_date is null



  
  
      
    ) dbt_internal_test
[0m20:47:57.858676 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m20:47:57.859148 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m20:47:57.859497 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m20:47:57.860018 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from "medallion"."main"."stg_transactions"
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m20:47:57.860440 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_ts
from "medallion"."main"."stg_transactions"
where transaction_ts is null



  
  
      
    ) dbt_internal_test
[0m20:47:57.860858 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m20:47:57.861516 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:47:57.864394 [debug] [Thread-4 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "medallion"."main"."stg_transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:47:57.865731 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m20:47:57.867211 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:47:57.874486 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: ROLLBACK
[0m20:47:57.876104 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m20:47:57.880750 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: ROLLBACK
[0m20:47:57.882116 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: ROLLBACK
[0m20:47:57.882574 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c'
[0m20:47:57.883222 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7'
[0m20:47:57.884347 [debug] [Thread-4 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: ROLLBACK
[0m20:47:57.884763 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4'
[0m20:47:57.885114 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: Close
[0m20:47:57.885508 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: Close
[0m20:47:57.886069 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396'
[0m20:47:57.886381 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: Close
[0m20:47:57.886995 [info ] [Thread-2 (]: 13 of 16 PASS not_null_stg_transactions_transaction_date ....................... [[32mPASS[0m in 0.13s]
[0m20:47:57.888640 [debug] [Thread-4 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: Close
[0m20:47:57.888028 [info ] [Thread-3 (]: 15 of 16 PASS not_null_stg_transactions_transaction_ts ......................... [[32mPASS[0m in 0.13s]
[0m20:47:57.889707 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m20:47:57.890612 [info ] [Thread-1 (]: 14 of 16 PASS not_null_stg_transactions_transaction_id ......................... [[32mPASS[0m in 0.14s]
[0m20:47:57.893319 [info ] [Thread-4 (]: 16 of 16 PASS unique_stg_transactions_transaction_id ........................... [[32mPASS[0m in 0.11s]
[0m20:47:57.895009 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m20:47:57.896519 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m20:47:57.897382 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m20:47:57.900996 [debug] [MainThread]: Using duckdb connection "master"
[0m20:47:57.902216 [debug] [MainThread]: On master: BEGIN
[0m20:47:57.902707 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:47:57.904809 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:47:57.905714 [debug] [MainThread]: On master: COMMIT
[0m20:47:57.906160 [debug] [MainThread]: Using duckdb connection "master"
[0m20:47:57.906490 [debug] [MainThread]: On master: COMMIT
[0m20:47:57.907263 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:47:57.907750 [debug] [MainThread]: On master: Close
[0m20:47:57.908309 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:47:57.908757 [debug] [MainThread]: Connection 'test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4' was properly closed.
[0m20:47:57.909122 [debug] [MainThread]: Connection 'test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c' was properly closed.
[0m20:47:57.909468 [debug] [MainThread]: Connection 'test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7' was properly closed.
[0m20:47:57.909759 [debug] [MainThread]: Connection 'test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396' was properly closed.
[0m20:47:57.910070 [info ] [MainThread]: 
[0m20:47:57.910430 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m20:47:57.912554 [debug] [MainThread]: Command end result
[0m20:47:57.935094 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m20:47:57.936812 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m20:47:57.943395 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m20:47:57.943916 [info ] [MainThread]: 
[0m20:47:57.944407 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m20:47:57.944840 [info ] [MainThread]: 
[0m20:47:57.945277 [error] [MainThread]: [31mFailure in test non_negative_stg_transactions_amount (models/staging/schema.yml)[0m
[0m20:47:57.945895 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m20:47:57.946320 [info ] [MainThread]: 
[0m20:47:57.946815 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/non_negative_stg_transactions_amount.sql
[0m20:47:57.947282 [info ] [MainThread]: 
[0m20:47:57.947755 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_amount (models/staging/schema.yml)[0m
[0m20:47:57.948182 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m20:47:57.948560 [info ] [MainThread]: 
[0m20:47:57.949055 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/not_null_stg_transactions_amount.sql
[0m20:47:57.949464 [info ] [MainThread]: 
[0m20:47:57.949938 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=16
[0m20:47:57.951972 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.1230755, "process_in_blocks": "0", "process_kernel_time": 0.238351, "process_mem_max_rss": "154404", "process_out_blocks": "2544", "process_user_time": 3.494822}
[0m20:47:57.952734 [debug] [MainThread]: Command `dbt test` failed at 20:47:57.952586 after 2.12 seconds
[0m20:47:57.953573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748912069420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7489135ef7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748911f5ea70>]}
[0m20:47:57.954331 [debug] [MainThread]: Flushing usage events
[0m20:47:58.597651 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:49:01.398045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a9d0869390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a9cf80c2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a9cf80c250>]}


============================== 20:49:01.401031 | 2fcfee91-a448-4db4-806e-f91fceae568d ==============================
[0m20:49:01.401031 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:49:01.401479 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'use_colors': 'True', 'empty': 'None', 'use_experimental_parser': 'False', 'no_print': 'None', 'printer_width': '80', 'version_check': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/logs', 'fail_fast': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'introspect': 'True', 'quiet': 'False', 'debug': 'False', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles --vars {"ds": "20251207", "clean_dir": "/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean"}', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles', 'static_parser': 'True', 'indirect_selection': 'eager'}
[0m20:49:01.649776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2fcfee91-a448-4db4-806e-f91fceae568d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a9c7c9a320>]}
[0m20:49:01.730153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2fcfee91-a448-4db4-806e-f91fceae568d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a9cfa32e30>]}
[0m20:49:01.732036 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:49:01.829401 [debug] [MainThread]: checksum: 505cc0738468dbf8af23784e25e0465f2f41e62e9895701049268b92bd4ad565, vars: {'clean_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean',
 'ds': '20251207'}, profile: , target: , version: 1.10.15
[0m20:49:02.003618 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:49:02.004529 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:49:02.069204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2fcfee91-a448-4db4-806e-f91fceae568d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a9c7748100>]}
[0m20:49:02.257939 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m20:49:02.260810 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m20:49:02.286208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2fcfee91-a448-4db4-806e-f91fceae568d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a9c774b700>]}
[0m20:49:02.287121 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m20:49:02.288110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2fcfee91-a448-4db4-806e-f91fceae568d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a9d15808e0>]}
[0m20:49:02.291234 [info ] [MainThread]: 
[0m20:49:02.291773 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:49:02.292228 [info ] [MainThread]: 
[0m20:49:02.293498 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:49:02.301226 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion_main'
[0m20:49:02.336082 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m20:49:02.336657 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m20:49:02.337099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:02.352217 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m20:49:02.353663 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m20:49:02.354099 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m20:49:02.365787 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m20:49:02.367926 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m20:49:02.369089 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m20:49:02.369639 [debug] [ThreadPool]: On list_medallion_main: Close
[0m20:49:02.370947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2fcfee91-a448-4db4-806e-f91fceae568d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a9c774b700>]}
[0m20:49:02.371494 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:02.371795 [debug] [MainThread]: On master: BEGIN
[0m20:49:02.372136 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:49:02.373123 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:49:02.373615 [debug] [MainThread]: On master: COMMIT
[0m20:49:02.373976 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:02.374311 [debug] [MainThread]: On master: COMMIT
[0m20:49:02.374965 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:49:02.375378 [debug] [MainThread]: On master: Close
[0m20:49:02.379408 [debug] [Thread-1 (]: Began running node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m20:49:02.380355 [debug] [Thread-2 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m20:49:02.380949 [debug] [Thread-3 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m20:49:02.381813 [debug] [Thread-4 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m20:49:02.382968 [info ] [Thread-1 (]: 1 of 16 START test accepted_values_stg_transactions_status__completed__pending__failed  [RUN]
[0m20:49:02.384703 [info ] [Thread-2 (]: 2 of 16 START test non_negative_fct_customer_transactions_total_amount_all ..... [RUN]
[0m20:49:02.385585 [info ] [Thread-3 (]: 3 of 16 START test non_negative_fct_customer_transactions_total_amount_completed  [RUN]
[0m20:49:02.386530 [info ] [Thread-4 (]: 4 of 16 START test non_negative_fct_customer_transactions_transaction_count .... [RUN]
[0m20:49:02.387598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26)
[0m20:49:02.388399 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89'
[0m20:49:02.389043 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428'
[0m20:49:02.389601 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4'
[0m20:49:02.390191 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m20:49:02.391233 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m20:49:02.391763 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m20:49:02.392173 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m20:49:02.421188 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m20:49:02.426642 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m20:49:02.436746 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m20:49:02.442713 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m20:49:02.443888 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m20:49:02.444324 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m20:49:02.451002 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m20:49:02.452261 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m20:49:02.472032 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m20:49:02.475140 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m20:49:02.477524 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m20:49:02.481653 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m20:49:02.484125 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m20:49:02.484801 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m20:49:02.485471 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m20:49:02.485952 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: BEGIN
[0m20:49:02.486323 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: BEGIN
[0m20:49:02.486780 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m20:49:02.487260 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: BEGIN
[0m20:49:02.487808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:49:02.488356 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:49:02.488858 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: BEGIN
[0m20:49:02.489287 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:49:02.490273 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:49:02.490854 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:49:02.491452 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m20:49:02.491962 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:49:02.492333 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m20:49:02.492724 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m20:49:02.494612 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m20:49:02.493422 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m20:49:02.493959 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "medallion"."main"."stg_transactions"
    group by status

)

select *
from all_values
where value_field not in (
    'completed','pending','failed'
)



  
  
      
    ) dbt_internal_test
[0m20:49:02.495148 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- Test gen√©rico: los valores deben ser NO NEGATIVOS y NO NULOS.
-- El test pasa si esta consulta devuelve CERO filas.

select
    transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count is null
   or transaction_count < 0


  
  
      
    ) dbt_internal_test
[0m20:49:02.493050 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m20:49:02.495881 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- Test gen√©rico: los valores deben ser NO NEGATIVOS y NO NULOS.
-- El test pasa si esta consulta devuelve CERO filas.

select
    total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all is null
   or total_amount_all < 0


  
  
      
    ) dbt_internal_test
[0m20:49:02.496748 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- Test gen√©rico: los valores deben ser NO NEGATIVOS y NO NULOS.
-- El test pasa si esta consulta devuelve CERO filas.

select
    total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed is null
   or total_amount_completed < 0


  
  
      
    ) dbt_internal_test
[0m20:49:02.497919 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:49:02.498500 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:49:02.499002 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:49:02.499322 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:49:02.507719 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: ROLLBACK
[0m20:49:02.508629 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: ROLLBACK
[0m20:49:02.510447 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: ROLLBACK
[0m20:49:02.512258 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: ROLLBACK
[0m20:49:02.513538 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26'
[0m20:49:02.514514 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4'
[0m20:49:02.515424 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428'
[0m20:49:02.516280 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89'
[0m20:49:02.516850 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: Close
[0m20:49:02.517384 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: Close
[0m20:49:02.517844 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: Close
[0m20:49:02.518291 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: Close
[0m20:49:02.519110 [info ] [Thread-1 (]: 1 of 16 PASS accepted_values_stg_transactions_status__completed__pending__failed  [[32mPASS[0m in 0.13s]
[0m20:49:02.519646 [info ] [Thread-4 (]: 4 of 16 PASS non_negative_fct_customer_transactions_transaction_count .......... [[32mPASS[0m in 0.13s]
[0m20:49:02.520460 [info ] [Thread-3 (]: 3 of 16 PASS non_negative_fct_customer_transactions_total_amount_completed ..... [[32mPASS[0m in 0.13s]
[0m20:49:02.521195 [info ] [Thread-2 (]: 2 of 16 PASS non_negative_fct_customer_transactions_total_amount_all ........... [[32mPASS[0m in 0.13s]
[0m20:49:02.522024 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m20:49:02.522753 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m20:49:02.523378 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m20:49:02.523916 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m20:49:02.524426 [debug] [Thread-1 (]: Began running node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m20:49:02.524914 [debug] [Thread-4 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m20:49:02.525409 [debug] [Thread-3 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m20:49:02.525812 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m20:49:02.526287 [info ] [Thread-1 (]: 5 of 16 START test non_negative_stg_transactions_amount ........................ [RUN]
[0m20:49:02.526677 [info ] [Thread-4 (]: 6 of 16 START test not_null_fct_customer_transactions_customer_id .............. [RUN]
[0m20:49:02.528837 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4, now test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c)
[0m20:49:02.527527 [info ] [Thread-2 (]: 8 of 16 START test not_null_fct_customer_transactions_total_amount_completed ... [RUN]
[0m20:49:02.528097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26, now test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733)
[0m20:49:02.527139 [info ] [Thread-3 (]: 7 of 16 START test not_null_fct_customer_transactions_total_amount_all ......... [RUN]
[0m20:49:02.529484 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m20:49:02.530981 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89, now test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418)
[0m20:49:02.531986 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m20:49:02.532648 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428, now test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f)
[0m20:49:02.540568 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m20:49:02.541254 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m20:49:02.550882 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m20:49:02.552016 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m20:49:02.558273 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m20:49:02.563120 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m20:49:02.562403 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m20:49:02.559054 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m20:49:02.566854 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m20:49:02.573453 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m20:49:02.575132 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m20:49:02.575740 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m20:49:02.580780 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m20:49:02.588456 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m20:49:02.589245 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m20:49:02.589968 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m20:49:02.591716 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m20:49:02.592331 [debug] [Thread-1 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: BEGIN
[0m20:49:02.592895 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: BEGIN
[0m20:49:02.593275 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m20:49:02.593659 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: BEGIN
[0m20:49:02.594225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:49:02.594799 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:49:02.595780 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: BEGIN
[0m20:49:02.596583 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:49:02.598414 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:49:02.599413 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:49:02.599962 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m20:49:02.600611 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m20:49:02.601513 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m20:49:02.601917 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m20:49:02.602334 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m20:49:02.603056 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m20:49:02.603563 [debug] [Thread-1 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- Test gen√©rico: los valores deben ser NO NEGATIVOS y NO NULOS.
-- El test pasa si esta consulta devuelve CERO filas.

select
    amount
from "medallion"."main"."stg_transactions"
where amount is null
   or amount < 0


  
  
      
    ) dbt_internal_test
[0m20:49:02.603907 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed is null



  
  
      
    ) dbt_internal_test
[0m20:49:02.604310 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m20:49:02.605995 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all is null



  
  
      
    ) dbt_internal_test
[0m20:49:02.604867 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "medallion"."main"."fct_customer_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m20:49:02.606649 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:49:02.607513 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:49:02.608065 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:49:02.608460 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:49:02.610388 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: ROLLBACK
[0m20:49:02.616330 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: ROLLBACK
[0m20:49:02.618471 [debug] [Thread-1 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: ROLLBACK
[0m20:49:02.619938 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418'
[0m20:49:02.622435 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: ROLLBACK
[0m20:49:02.623297 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f'
[0m20:49:02.623934 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733'
[0m20:49:02.624334 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: Close
[0m20:49:02.624787 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c'
[0m20:49:02.626217 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: Close
[0m20:49:02.625726 [debug] [Thread-1 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: Close
[0m20:49:02.625232 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: Close
[0m20:49:02.628556 [info ] [Thread-2 (]: 8 of 16 PASS not_null_fct_customer_transactions_total_amount_completed ......... [[32mPASS[0m in 0.10s]
[0m20:49:02.630286 [info ] [Thread-4 (]: 6 of 16 PASS not_null_fct_customer_transactions_customer_id .................... [[32mPASS[0m in 0.10s]
[0m20:49:02.632263 [info ] [Thread-3 (]: 7 of 16 PASS not_null_fct_customer_transactions_total_amount_all ............... [[32mPASS[0m in 0.10s]
[0m20:49:02.634304 [error] [Thread-1 (]: 5 of 16 FAIL 1 non_negative_stg_transactions_amount ............................ [[31mFAIL 1[0m in 0.11s]
[0m20:49:02.635317 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m20:49:02.636173 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m20:49:02.636719 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m20:49:02.637812 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m20:49:02.638398 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m20:49:02.638953 [debug] [Thread-4 (]: Began running node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m20:49:02.639603 [debug] [Thread-3 (]: Began running node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m20:49:02.640530 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m20:49:02.641043 [info ] [Thread-2 (]: 9 of 16 START test not_null_fct_customer_transactions_transaction_count ........ [RUN]
[0m20:49:02.641572 [info ] [Thread-4 (]: 10 of 16 START test not_null_stg_transactions_amount ........................... [RUN]
[0m20:49:02.642144 [info ] [Thread-3 (]: 11 of 16 START test not_null_stg_transactions_customer_id ...................... [RUN]
[0m20:49:02.642620 [info ] [Thread-1 (]: 12 of 16 START test not_null_stg_transactions_status ........................... [RUN]
[0m20:49:02.643399 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418, now test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e)
[0m20:49:02.643899 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c, now test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e)
[0m20:49:02.644486 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f, now test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf)
[0m20:49:02.645010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733, now test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875)
[0m20:49:02.647777 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m20:49:02.646288 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m20:49:02.647143 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m20:49:02.645491 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m20:49:02.656966 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m20:49:02.665885 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m20:49:02.680846 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m20:49:02.677286 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m20:49:02.682946 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m20:49:02.686591 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m20:49:02.687712 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m20:49:02.688507 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m20:49:02.689043 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m20:49:02.691805 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m20:49:02.707240 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m20:49:02.712155 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m20:49:02.713386 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m20:49:02.714323 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m20:49:02.715344 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m20:49:02.715996 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: BEGIN
[0m20:49:02.717670 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: BEGIN
[0m20:49:02.718920 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m20:49:02.719804 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: BEGIN
[0m20:49:02.720446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:49:02.720986 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:49:02.721499 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: BEGIN
[0m20:49:02.722035 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:49:02.723637 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:49:02.724369 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:49:02.724872 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m20:49:02.725413 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m20:49:02.725841 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m20:49:02.726373 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:49:02.726852 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m20:49:02.727207 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m20:49:02.727608 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select status
from "medallion"."main"."stg_transactions"
where status is null



  
  
      
    ) dbt_internal_test
[0m20:49:02.728182 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m20:49:02.730573 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count is null



  
  
      
    ) dbt_internal_test
[0m20:49:02.729155 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "medallion"."main"."stg_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m20:49:02.728685 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select amount
from "medallion"."main"."stg_transactions"
where amount is null



  
  
      
    ) dbt_internal_test
[0m20:49:02.731681 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:49:02.732239 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:49:02.736223 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: ROLLBACK
[0m20:49:02.737917 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m20:49:02.738929 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m20:49:02.741518 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: ROLLBACK
[0m20:49:02.746175 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e'
[0m20:49:02.745147 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: ROLLBACK
[0m20:49:02.742461 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875'
[0m20:49:02.746899 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: Close
[0m20:49:02.749911 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: ROLLBACK
[0m20:49:02.751082 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e'
[0m20:49:02.752846 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: Close
[0m20:49:02.755998 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf'
[0m20:49:02.755087 [info ] [Thread-2 (]: 9 of 16 PASS not_null_fct_customer_transactions_transaction_count .............. [[32mPASS[0m in 0.11s]
[0m20:49:02.757159 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: Close
[0m20:49:02.758054 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: Close
[0m20:49:02.759885 [info ] [Thread-1 (]: 12 of 16 PASS not_null_stg_transactions_status ................................. [[32mPASS[0m in 0.11s]
[0m20:49:02.762749 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m20:49:02.764529 [error] [Thread-4 (]: 10 of 16 FAIL 1 not_null_stg_transactions_amount ............................... [[31mFAIL 1[0m in 0.12s]
[0m20:49:02.765361 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m20:49:02.766110 [info ] [Thread-3 (]: 11 of 16 PASS not_null_stg_transactions_customer_id ............................ [[32mPASS[0m in 0.12s]
[0m20:49:02.766702 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m20:49:02.767426 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m20:49:02.768008 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m20:49:02.768788 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m20:49:02.769462 [info ] [Thread-2 (]: 13 of 16 START test not_null_stg_transactions_transaction_date ................. [RUN]
[0m20:49:02.770067 [debug] [Thread-4 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m20:49:02.772601 [info ] [Thread-4 (]: 15 of 16 START test not_null_stg_transactions_transaction_ts ................... [RUN]
[0m20:49:02.771291 [debug] [Thread-3 (]: Began running node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m20:49:02.772003 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e, now test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c)
[0m20:49:02.773487 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e, now test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7)
[0m20:49:02.770775 [info ] [Thread-1 (]: 14 of 16 START test not_null_stg_transactions_transaction_id ................... [RUN]
[0m20:49:02.774023 [info ] [Thread-3 (]: 16 of 16 START test unique_stg_transactions_transaction_id ..................... [RUN]
[0m20:49:02.774407 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m20:49:02.774785 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m20:49:02.775330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875, now test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4)
[0m20:49:02.775751 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf, now test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396)
[0m20:49:02.781770 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m20:49:02.789861 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m20:49:02.790417 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m20:49:02.790965 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m20:49:02.794665 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m20:49:02.802141 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m20:49:02.807026 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m20:49:02.807734 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m20:49:02.810670 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m20:49:02.815115 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m20:49:02.816356 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m20:49:02.817835 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m20:49:02.818594 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m20:49:02.821609 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m20:49:02.822554 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m20:49:02.826302 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m20:49:02.826865 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: BEGIN
[0m20:49:02.827394 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: BEGIN
[0m20:49:02.827869 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:49:02.828534 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:49:02.829583 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m20:49:02.834618 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: BEGIN
[0m20:49:02.835348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:49:02.832074 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m20:49:02.833494 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m20:49:02.830390 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m20:49:02.836684 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m20:49:02.837831 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m20:49:02.838525 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:49:02.840592 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m20:49:02.839576 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_date
from "medallion"."main"."stg_transactions"
where transaction_date is null



  
  
      
    ) dbt_internal_test
[0m20:49:02.840006 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_ts
from "medallion"."main"."stg_transactions"
where transaction_ts is null



  
  
      
    ) dbt_internal_test
[0m20:49:02.841087 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from "medallion"."main"."stg_transactions"
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m20:49:02.839059 [debug] [Thread-3 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: BEGIN
[0m20:49:02.843406 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:49:02.844224 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m20:49:02.846511 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:49:02.849413 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: ROLLBACK
[0m20:49:02.855716 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c'
[0m20:49:02.854789 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: ROLLBACK
[0m20:49:02.852126 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:49:02.856261 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: Close
[0m20:49:02.856668 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m20:49:02.857176 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7'
[0m20:49:02.859344 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: ROLLBACK
[0m20:49:02.859753 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m20:49:02.862333 [debug] [Thread-3 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "medallion"."main"."stg_transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:49:02.860554 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: Close
[0m20:49:02.861147 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4'
[0m20:49:02.858066 [info ] [Thread-2 (]: 13 of 16 PASS not_null_stg_transactions_transaction_date ....................... [[32mPASS[0m in 0.09s]
[0m20:49:02.867256 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m20:49:02.865373 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: Close
[0m20:49:02.866282 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m20:49:02.864312 [info ] [Thread-4 (]: 15 of 16 PASS not_null_stg_transactions_transaction_ts ......................... [[32mPASS[0m in 0.09s]
[0m20:49:02.869983 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m20:49:02.868638 [info ] [Thread-1 (]: 14 of 16 PASS not_null_stg_transactions_transaction_id ......................... [[32mPASS[0m in 0.09s]
[0m20:49:02.872467 [debug] [Thread-3 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: ROLLBACK
[0m20:49:02.873691 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m20:49:02.875040 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396'
[0m20:49:02.875457 [debug] [Thread-3 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: Close
[0m20:49:02.876190 [info ] [Thread-3 (]: 16 of 16 PASS unique_stg_transactions_transaction_id ........................... [[32mPASS[0m in 0.10s]
[0m20:49:02.877036 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m20:49:02.878692 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:02.879337 [debug] [MainThread]: On master: BEGIN
[0m20:49:02.880366 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:49:02.883496 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m20:49:02.884801 [debug] [MainThread]: On master: COMMIT
[0m20:49:02.885560 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:02.886328 [debug] [MainThread]: On master: COMMIT
[0m20:49:02.887260 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:49:02.887749 [debug] [MainThread]: On master: Close
[0m20:49:02.888211 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:49:02.888478 [debug] [MainThread]: Connection 'test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4' was properly closed.
[0m20:49:02.888711 [debug] [MainThread]: Connection 'test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c' was properly closed.
[0m20:49:02.888983 [debug] [MainThread]: Connection 'test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396' was properly closed.
[0m20:49:02.889371 [debug] [MainThread]: Connection 'test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7' was properly closed.
[0m20:49:02.889865 [info ] [MainThread]: 
[0m20:49:02.890459 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m20:49:02.893267 [debug] [MainThread]: Command end result
[0m20:49:02.925786 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m20:49:02.927417 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m20:49:02.937759 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m20:49:02.938873 [info ] [MainThread]: 
[0m20:49:02.939428 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m20:49:02.939735 [info ] [MainThread]: 
[0m20:49:02.940051 [error] [MainThread]: [31mFailure in test non_negative_stg_transactions_amount (models/staging/schema.yml)[0m
[0m20:49:02.940453 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m20:49:02.940714 [info ] [MainThread]: 
[0m20:49:02.941055 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/non_negative_stg_transactions_amount.sql
[0m20:49:02.941370 [info ] [MainThread]: 
[0m20:49:02.941737 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_amount (models/staging/schema.yml)[0m
[0m20:49:02.942095 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m20:49:02.942435 [info ] [MainThread]: 
[0m20:49:02.942862 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/not_null_stg_transactions_amount.sql
[0m20:49:02.943307 [info ] [MainThread]: 
[0m20:49:02.943603 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=16
[0m20:49:02.944423 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.5934738, "process_in_blocks": "0", "process_kernel_time": 0.16682, "process_mem_max_rss": "154208", "process_out_blocks": "2544", "process_user_time": 2.54726}
[0m20:49:02.945115 [debug] [MainThread]: Command `dbt test` failed at 20:49:02.944968 after 1.59 seconds
[0m20:49:02.945697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a9d0869390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a9d07614b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a9c5b11120>]}
[0m20:49:02.946268 [debug] [MainThread]: Flushing usage events
[0m20:49:04.050635 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:30:17.950604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789a37f613f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789a36f00280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789a36f00220>]}


============================== 22:30:17.954153 | 4632b12a-9b01-40da-a1bd-8fe10dec1685 ==============================
[0m22:30:17.954153 [info ] [MainThread]: Running with dbt=1.10.15
[0m22:30:17.954730 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles', 'target_path': 'None', 'log_path': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/logs', 'fail_fast': 'False', 'static_parser': 'True', 'empty': 'False', 'introspect': 'True', 'version_check': 'True', 'invocation_command': 'dbt run --profiles-dir /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles --vars {"ds": "20251208", "clean_dir": "/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean"}', 'no_print': 'None', 'use_colors': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'log_format': 'default', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'write_json': 'True'}
[0m22:30:18.151504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4632b12a-9b01-40da-a1bd-8fe10dec1685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789a37fdf190>]}
[0m22:30:18.211266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4632b12a-9b01-40da-a1bd-8fe10dec1685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789a378f2740>]}
[0m22:30:18.213962 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:30:18.285950 [debug] [MainThread]: checksum: e2b139db6efac39b1de19f3555678fced284b8a021bbfc8d2226278adef0fc17, vars: {'clean_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean',
 'ds': '20251208'}, profile: , target: , version: 1.10.15
[0m22:30:18.378555 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m22:30:18.379263 [debug] [MainThread]: previous checksum: e2b139db6efac39b1de19f3555678fced284b8a021bbfc8d2226278adef0fc17, current checksum: 505cc0738468dbf8af23784e25e0465f2f41e62e9895701049268b92bd4ad565
[0m22:30:18.379610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4632b12a-9b01-40da-a1bd-8fe10dec1685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789a3774e590>]}
[0m22:30:21.016959 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m22:30:21.017636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4632b12a-9b01-40da-a1bd-8fe10dec1685', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789a2cdbb0d0>]}
[0m22:30:21.183032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4632b12a-9b01-40da-a1bd-8fe10dec1685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789a2cc51270>]}
[0m22:30:21.425726 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m22:30:21.427527 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m22:30:21.444742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4632b12a-9b01-40da-a1bd-8fe10dec1685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789a2cc28370>]}
[0m22:30:21.445993 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m22:30:21.446356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4632b12a-9b01-40da-a1bd-8fe10dec1685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789a2cc280d0>]}
[0m22:30:21.447814 [info ] [MainThread]: 
[0m22:30:21.448167 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:30:21.448467 [info ] [MainThread]: 
[0m22:30:21.448915 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:30:21.455579 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m22:30:21.490668 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m22:30:21.492838 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m22:30:21.493479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:30:21.507503 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m22:30:21.508762 [debug] [ThreadPool]: On list_medallion: Close
[0m22:30:21.509605 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m22:30:21.510138 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m22:30:21.516276 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m22:30:21.516755 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m22:30:21.517046 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:30:21.518289 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:30:21.519336 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m22:30:21.519626 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m22:30:21.520135 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:30:21.520416 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m22:30:21.520660 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m22:30:21.521094 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:30:21.521872 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m22:30:21.522195 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m22:30:21.522521 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m22:30:21.523149 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:30:21.523568 [debug] [ThreadPool]: On create_medallion_main: Close
[0m22:30:21.525204 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m22:30:21.531039 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m22:30:21.531449 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m22:30:21.531706 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:30:21.532462 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:30:21.532757 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m22:30:21.533004 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m22:30:21.544367 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m22:30:21.546309 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m22:30:21.547165 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m22:30:21.547595 [debug] [ThreadPool]: On list_medallion_main: Close
[0m22:30:21.548807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4632b12a-9b01-40da-a1bd-8fe10dec1685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789a2cc30d30>]}
[0m22:30:21.549430 [debug] [MainThread]: Using duckdb connection "master"
[0m22:30:21.549845 [debug] [MainThread]: On master: BEGIN
[0m22:30:21.550235 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:30:21.551017 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:30:21.551438 [debug] [MainThread]: On master: COMMIT
[0m22:30:21.551820 [debug] [MainThread]: Using duckdb connection "master"
[0m22:30:21.552202 [debug] [MainThread]: On master: COMMIT
[0m22:30:21.552841 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:30:21.553385 [debug] [MainThread]: On master: Close
[0m22:30:21.557734 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m22:30:21.559542 [info ] [Thread-1 (]: 1 of 2 START sql table model main.stg_transactions ............................. [RUN]
[0m22:30:21.560535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m22:30:21.561299 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m22:30:21.572569 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m22:30:21.575245 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m22:30:21.615455 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m22:30:21.616216 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m22:30:21.616593 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m22:30:21.616884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:30:21.617804 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:30:21.618169 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m22:30:21.618473 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
    
    

    create  table
      "medallion"."main"."stg_transactions__dbt_tmp"
  
    as (
      




WITH src AS (

    SELECT *
    FROM read_parquet(
        '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean/transactions_20251208_clean.parquet'
    )

),

typed AS (

    SELECT
        CAST(transaction_id AS VARCHAR)    AS transaction_id,
        CAST(customer_id AS VARCHAR)       AS customer_id,
        CAST(amount AS DOUBLE)             AS amount,
        LOWER(TRIM(status))                AS status,
        CAST(transaction_ts AS TIMESTAMP)  AS transaction_ts
    FROM src

),

validated AS (

    SELECT
        transaction_id,
        customer_id,
        amount,
        status,
        transaction_ts,
        DATE(transaction_ts) AS transaction_date
    FROM typed
    WHERE status IN ('completed', 'pending', 'failed')
        AND amount IS NOT NULL

)

SELECT *
FROM validated
    );
  
  
[0m22:30:21.620262 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:30:21.626288 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m22:30:21.627352 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_transactions'
  
[0m22:30:21.628902 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:30:21.630072 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m22:30:21.630426 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_transactions'
  
[0m22:30:21.631275 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:30:21.636527 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m22:30:21.636929 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */
alter table "medallion"."main"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m22:30:21.637814 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:30:21.641278 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m22:30:21.641792 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */
alter table "medallion"."main"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m22:30:21.643424 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:30:21.655665 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m22:30:21.656211 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m22:30:21.656628 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m22:30:21.660620 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:30:21.666606 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m22:30:21.667033 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

      drop table if exists "medallion"."main"."stg_transactions__dbt_backup" cascade
    
[0m22:30:21.668354 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:30:21.670491 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m22:30:21.672475 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4632b12a-9b01-40da-a1bd-8fe10dec1685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789a398e5300>]}
[0m22:30:21.674416 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.stg_transactions ........................ [[32mOK[0m in 0.11s]
[0m22:30:21.675432 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m22:30:21.677310 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m22:30:21.678309 [info ] [Thread-3 (]: 2 of 2 START sql table model main.fct_customer_transactions .................... [RUN]
[0m22:30:21.679144 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.medallion_dbt.fct_customer_transactions'
[0m22:30:21.679685 [debug] [Thread-3 (]: Began compiling node model.medallion_dbt.fct_customer_transactions
[0m22:30:21.685510 [debug] [Thread-3 (]: Writing injected SQL for node "model.medallion_dbt.fct_customer_transactions"
[0m22:30:21.686126 [debug] [Thread-3 (]: Began executing node model.medallion_dbt.fct_customer_transactions
[0m22:30:21.691679 [debug] [Thread-3 (]: Writing runtime sql for node "model.medallion_dbt.fct_customer_transactions"
[0m22:30:21.692308 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m22:30:21.692653 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: BEGIN
[0m22:30:21.692961 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:30:21.693800 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m22:30:21.694134 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m22:30:21.694437 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      -- models/marts/fct_customer_transactions.sql



WITH src AS (
    SELECT
        customer_id,
        amount,
        status
    FROM "medallion"."main"."stg_transactions"

),

aggregated AS (

    SELECT
        customer_id,
        COUNT(*) AS transaction_count,
        COALESCE(
            SUM(CASE WHEN status = 'completed' THEN amount ELSE 0 END),
        0) AS total_amount_completed,
        COALESCE(SUM(amount), 0) AS total_amount_all
    FROM src
    GROUP BY customer_id

)

SELECT *
FROM aggregated
    );
  
  
[0m22:30:21.696428 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m22:30:21.697362 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m22:30:21.697685 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'fct_customer_transactions'
  
[0m22:30:21.698343 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m22:30:21.699318 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m22:30:21.699847 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'fct_customer_transactions'
  
[0m22:30:21.701906 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m22:30:21.706475 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m22:30:21.707061 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */
alter table "medallion"."main"."fct_customer_transactions" rename to "fct_customer_transactions__dbt_backup"
[0m22:30:21.709344 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m22:30:21.713072 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m22:30:21.713446 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */
alter table "medallion"."main"."fct_customer_transactions__dbt_tmp" rename to "fct_customer_transactions"
[0m22:30:21.714236 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m22:30:21.715375 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: COMMIT
[0m22:30:21.715998 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m22:30:21.716406 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: COMMIT
[0m22:30:21.718752 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m22:30:21.724144 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m22:30:21.725840 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

      drop table if exists "medallion"."main"."fct_customer_transactions__dbt_backup" cascade
    
[0m22:30:21.730403 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m22:30:21.732796 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: Close
[0m22:30:21.733810 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4632b12a-9b01-40da-a1bd-8fe10dec1685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789a2f000760>]}
[0m22:30:21.734517 [info ] [Thread-3 (]: 2 of 2 OK created sql table model main.fct_customer_transactions ............... [[32mOK[0m in 0.05s]
[0m22:30:21.735021 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m22:30:21.736105 [debug] [MainThread]: Using duckdb connection "master"
[0m22:30:21.736452 [debug] [MainThread]: On master: BEGIN
[0m22:30:21.736741 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:30:21.737506 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:30:21.737931 [debug] [MainThread]: On master: COMMIT
[0m22:30:21.738647 [debug] [MainThread]: Using duckdb connection "master"
[0m22:30:21.739157 [debug] [MainThread]: On master: COMMIT
[0m22:30:21.740520 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:30:21.741555 [debug] [MainThread]: On master: Close
[0m22:30:21.742821 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:30:21.743350 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m22:30:21.743691 [debug] [MainThread]: Connection 'model.medallion_dbt.fct_customer_transactions' was properly closed.
[0m22:30:21.744396 [info ] [MainThread]: 
[0m22:30:21.744890 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m22:30:21.745616 [debug] [MainThread]: Command end result
[0m22:30:21.773573 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m22:30:21.775809 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m22:30:21.780830 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m22:30:21.781168 [info ] [MainThread]: 
[0m22:30:21.781509 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:30:21.781778 [info ] [MainThread]: 
[0m22:30:21.782063 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m22:30:21.782594 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m22:30:21.783513 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.8875608, "process_in_blocks": "0", "process_kernel_time": 0.15353, "process_mem_max_rss": "158232", "process_out_blocks": "3280", "process_user_time": 3.912045}
[0m22:30:21.784402 [debug] [MainThread]: Command `dbt run` succeeded at 22:30:21.784223 after 3.89 seconds
[0m22:30:21.785030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789a37f613f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789a2cc21990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789a37fdebf0>]}
[0m22:30:21.785933 [debug] [MainThread]: Flushing usage events
[0m22:30:22.974325 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:30:25.711889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cfa8f9d480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cfa7f68250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cfa7f681f0>]}


============================== 22:30:25.716494 | ca42334c-d96b-4566-ac9a-f234723d925f ==============================
[0m22:30:25.716494 [info ] [MainThread]: Running with dbt=1.10.15
[0m22:30:25.717246 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'static_parser': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'log_path': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/logs', 'quiet': 'False', 'fail_fast': 'False', 'empty': 'None', 'profiles_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/profiles --vars {"ds": "20251208", "clean_dir": "/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean"}', 'partial_parse': 'True', 'warn_error': 'None', 'introspect': 'True', 'version_check': 'True', 'target_path': 'None', 'log_cache_events': 'False'}
[0m22:30:25.922225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca42334c-d96b-4566-ac9a-f234723d925f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cfaa9e19c0>]}
[0m22:30:25.982677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca42334c-d96b-4566-ac9a-f234723d925f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cfa7f12cb0>]}
[0m22:30:25.984178 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:30:26.055644 [debug] [MainThread]: checksum: e2b139db6efac39b1de19f3555678fced284b8a021bbfc8d2226278adef0fc17, vars: {'clean_dir': '/home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/data/clean',
 'ds': '20251208'}, profile: , target: , version: 1.10.15
[0m22:30:26.157800 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:30:26.158906 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:30:26.195982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca42334c-d96b-4566-ac9a-f234723d925f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cf9fe0c130>]}
[0m22:30:26.348697 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m22:30:26.350293 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m22:30:26.375123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca42334c-d96b-4566-ac9a-f234723d925f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cf9ff878b0>]}
[0m22:30:26.375742 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m22:30:26.376132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca42334c-d96b-4566-ac9a-f234723d925f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cfa01f7880>]}
[0m22:30:26.378021 [info ] [MainThread]: 
[0m22:30:26.378596 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:30:26.378883 [info ] [MainThread]: 
[0m22:30:26.379325 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:30:26.384579 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion_main'
[0m22:30:26.414646 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m22:30:26.415205 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m22:30:26.415678 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:30:26.428844 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m22:30:26.429302 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m22:30:26.429607 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m22:30:26.439793 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m22:30:26.441676 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m22:30:26.442279 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m22:30:26.442598 [debug] [ThreadPool]: On list_medallion_main: Close
[0m22:30:26.443647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca42334c-d96b-4566-ac9a-f234723d925f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cf9ff878b0>]}
[0m22:30:26.444083 [debug] [MainThread]: Using duckdb connection "master"
[0m22:30:26.444371 [debug] [MainThread]: On master: BEGIN
[0m22:30:26.444625 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:30:26.445187 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:30:26.445453 [debug] [MainThread]: On master: COMMIT
[0m22:30:26.445709 [debug] [MainThread]: Using duckdb connection "master"
[0m22:30:26.445961 [debug] [MainThread]: On master: COMMIT
[0m22:30:26.446378 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:30:26.446643 [debug] [MainThread]: On master: Close
[0m22:30:26.449002 [debug] [Thread-1 (]: Began running node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m22:30:26.449475 [debug] [Thread-2 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m22:30:26.449997 [debug] [Thread-3 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m22:30:26.450546 [debug] [Thread-4 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m22:30:26.451232 [info ] [Thread-1 (]: 1 of 16 START test accepted_values_stg_transactions_status__completed__pending__failed  [RUN]
[0m22:30:26.452004 [info ] [Thread-2 (]: 2 of 16 START test non_negative_fct_customer_transactions_total_amount_all ..... [RUN]
[0m22:30:26.452643 [info ] [Thread-3 (]: 3 of 16 START test non_negative_fct_customer_transactions_total_amount_completed  [RUN]
[0m22:30:26.453191 [info ] [Thread-4 (]: 4 of 16 START test non_negative_fct_customer_transactions_transaction_count .... [RUN]
[0m22:30:26.453904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26)
[0m22:30:26.454392 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89'
[0m22:30:26.454859 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428'
[0m22:30:26.455339 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4'
[0m22:30:26.455741 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m22:30:26.456188 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m22:30:26.457095 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m22:30:26.457538 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m22:30:26.475909 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m22:30:26.479881 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m22:30:26.483457 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m22:30:26.489554 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m22:30:26.490850 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m22:30:26.491362 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m22:30:26.491753 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m22:30:26.497289 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m22:30:26.511446 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m22:30:26.514681 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m22:30:26.516696 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m22:30:26.519073 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m22:30:26.521401 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m22:30:26.522405 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m22:30:26.523103 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m22:30:26.523892 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m22:30:26.524625 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: BEGIN
[0m22:30:26.525433 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: BEGIN
[0m22:30:26.526217 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: BEGIN
[0m22:30:26.526980 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: BEGIN
[0m22:30:26.527512 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:30:26.528032 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:30:26.529045 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:30:26.529857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:30:26.532383 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m22:30:26.533202 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m22:30:26.533777 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m22:30:26.534659 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m22:30:26.535318 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m22:30:26.536094 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m22:30:26.536590 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- Test gen√©rico: los valores deben ser NO NEGATIVOS y NO NULOS.
-- El test pasa si esta consulta devuelve CERO filas.

select
    total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed is null
   or total_amount_completed < 0


  
  
      
    ) dbt_internal_test
[0m22:30:26.537392 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m22:30:26.537959 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m22:30:26.538488 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- Test gen√©rico: los valores deben ser NO NEGATIVOS y NO NULOS.
-- El test pasa si esta consulta devuelve CERO filas.

select
    total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all is null
   or total_amount_all < 0


  
  
      
    ) dbt_internal_test
[0m22:30:26.540648 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "medallion"."main"."stg_transactions"
    group by status

)

select *
from all_values
where value_field not in (
    'completed','pending','failed'
)



  
  
      
    ) dbt_internal_test
[0m22:30:26.541608 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- Test gen√©rico: los valores deben ser NO NEGATIVOS y NO NULOS.
-- El test pasa si esta consulta devuelve CERO filas.

select
    transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count is null
   or transaction_count < 0


  
  
      
    ) dbt_internal_test
[0m22:30:26.543512 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m22:30:26.544092 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m22:30:26.544663 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:30:26.545259 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m22:30:26.548774 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: ROLLBACK
[0m22:30:26.549953 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: ROLLBACK
[0m22:30:26.551958 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: ROLLBACK
[0m22:30:26.552915 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428'
[0m22:30:26.555231 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: ROLLBACK
[0m22:30:26.557416 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89'
[0m22:30:26.559048 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26'
[0m22:30:26.559846 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: Close
[0m22:30:26.560369 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4'
[0m22:30:26.560762 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: Close
[0m22:30:26.561134 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: Close
[0m22:30:26.561513 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: Close
[0m22:30:26.562086 [info ] [Thread-3 (]: 3 of 16 PASS non_negative_fct_customer_transactions_total_amount_completed ..... [[32mPASS[0m in 0.11s]
[0m22:30:26.562719 [info ] [Thread-2 (]: 2 of 16 PASS non_negative_fct_customer_transactions_total_amount_all ........... [[32mPASS[0m in 0.11s]
[0m22:30:26.563342 [info ] [Thread-1 (]: 1 of 16 PASS accepted_values_stg_transactions_status__completed__pending__failed  [[32mPASS[0m in 0.11s]
[0m22:30:26.563942 [info ] [Thread-4 (]: 4 of 16 PASS non_negative_fct_customer_transactions_transaction_count .......... [[32mPASS[0m in 0.11s]
[0m22:30:26.564484 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m22:30:26.564967 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m22:30:26.565705 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m22:30:26.566642 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m22:30:26.567213 [debug] [Thread-3 (]: Began running node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m22:30:26.568167 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m22:30:26.569041 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m22:30:26.569883 [debug] [Thread-4 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m22:30:26.570491 [info ] [Thread-3 (]: 5 of 16 START test non_negative_stg_transactions_amount ........................ [RUN]
[0m22:30:26.571202 [info ] [Thread-2 (]: 6 of 16 START test not_null_fct_customer_transactions_customer_id .............. [RUN]
[0m22:30:26.571760 [info ] [Thread-1 (]: 7 of 16 START test not_null_fct_customer_transactions_total_amount_all ......... [RUN]
[0m22:30:26.572209 [info ] [Thread-4 (]: 8 of 16 START test not_null_fct_customer_transactions_total_amount_completed ... [RUN]
[0m22:30:26.572734 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428, now test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733)
[0m22:30:26.573216 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89, now test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c)
[0m22:30:26.573665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26, now test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f)
[0m22:30:26.574320 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4, now test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418)
[0m22:30:26.574796 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m22:30:26.575278 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m22:30:26.575678 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m22:30:26.576150 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m22:30:26.580923 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m22:30:26.589187 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m22:30:26.594057 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m22:30:26.598375 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m22:30:26.599913 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m22:30:26.600749 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m22:30:26.607321 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m22:30:26.608933 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m22:30:26.611626 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m22:30:26.613787 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m22:30:26.614191 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m22:30:26.615423 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m22:30:26.616003 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m22:30:26.620529 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m22:30:26.621163 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m22:30:26.621561 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: BEGIN
[0m22:30:26.621990 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: BEGIN
[0m22:30:26.622549 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: BEGIN
[0m22:30:26.622953 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:30:26.623573 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m22:30:26.624222 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:30:26.624701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:30:26.625786 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: BEGIN
[0m22:30:26.626483 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m22:30:26.627360 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m22:30:26.627768 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:30:26.628155 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:30:26.628552 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m22:30:26.628923 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m22:30:26.629459 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m22:30:26.629833 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "medallion"."main"."fct_customer_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m22:30:26.630259 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m22:30:26.630760 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- Test gen√©rico: los valores deben ser NO NEGATIVOS y NO NULOS.
-- El test pasa si esta consulta devuelve CERO filas.

select
    amount
from "medallion"."main"."stg_transactions"
where amount is null
   or amount < 0


  
  
      
    ) dbt_internal_test
[0m22:30:26.631157 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all is null



  
  
      
    ) dbt_internal_test
[0m22:30:26.631668 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m22:30:26.632173 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m22:30:26.632775 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed is null



  
  
      
    ) dbt_internal_test
[0m22:30:26.633237 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m22:30:26.633569 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:30:26.634987 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: ROLLBACK
[0m22:30:26.636709 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: ROLLBACK
[0m22:30:26.639838 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: ROLLBACK
[0m22:30:26.642441 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m22:30:26.643469 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c'
[0m22:30:26.644031 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733'
[0m22:30:26.644725 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f'
[0m22:30:26.645358 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: Close
[0m22:30:26.646740 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: ROLLBACK
[0m22:30:26.647190 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: Close
[0m22:30:26.647581 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: Close
[0m22:30:26.648234 [info ] [Thread-2 (]: 6 of 16 PASS not_null_fct_customer_transactions_customer_id .................... [[32mPASS[0m in 0.08s]
[0m22:30:26.648711 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418'
[0m22:30:26.649344 [info ] [Thread-3 (]: 5 of 16 PASS non_negative_stg_transactions_amount .............................. [[32mPASS[0m in 0.08s]
[0m22:30:26.650498 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m22:30:26.649978 [info ] [Thread-1 (]: 7 of 16 PASS not_null_fct_customer_transactions_total_amount_all ............... [[32mPASS[0m in 0.08s]
[0m22:30:26.651337 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: Close
[0m22:30:26.652342 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m22:30:26.653168 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m22:30:26.653886 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m22:30:26.654671 [debug] [Thread-3 (]: Began running node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m22:30:26.656312 [info ] [Thread-4 (]: 8 of 16 PASS not_null_fct_customer_transactions_total_amount_completed ......... [[32mPASS[0m in 0.08s]
[0m22:30:26.657453 [info ] [Thread-2 (]: 9 of 16 START test not_null_fct_customer_transactions_transaction_count ........ [RUN]
[0m22:30:26.658361 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m22:30:26.659364 [info ] [Thread-3 (]: 10 of 16 START test not_null_stg_transactions_amount ........................... [RUN]
[0m22:30:26.660528 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m22:30:26.661686 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c, now test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e)
[0m22:30:26.662373 [info ] [Thread-1 (]: 11 of 16 START test not_null_stg_transactions_customer_id ...................... [RUN]
[0m22:30:26.663074 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733, now test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e)
[0m22:30:26.663513 [debug] [Thread-4 (]: Began running node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m22:30:26.664003 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m22:30:26.664539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f, now test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf)
[0m22:30:26.664938 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m22:30:26.665438 [info ] [Thread-4 (]: 12 of 16 START test not_null_stg_transactions_status ........................... [RUN]
[0m22:30:26.671399 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m22:30:26.673498 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m22:30:26.681132 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m22:30:26.681742 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418, now test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875)
[0m22:30:26.689224 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m22:30:26.689894 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m22:30:26.690342 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m22:30:26.690943 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m22:30:26.693037 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m22:30:26.697525 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m22:30:26.698142 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m22:30:26.700245 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m22:30:26.701045 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m22:30:26.703094 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m22:30:26.703693 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m22:30:26.704104 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: BEGIN
[0m22:30:26.704666 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m22:30:26.707458 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m22:30:26.708094 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m22:30:26.708526 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:30:26.708921 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: BEGIN
[0m22:30:26.709339 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: BEGIN
[0m22:30:26.709970 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:30:26.710379 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m22:30:26.710849 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m22:30:26.711211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:30:26.711968 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: BEGIN
[0m22:30:26.712303 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m22:30:26.712646 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m22:30:26.713050 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:30:26.713387 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count is null



  
  
      
    ) dbt_internal_test
[0m22:30:26.713722 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:30:26.714071 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m22:30:26.714655 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m22:30:26.715063 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select amount
from "medallion"."main"."stg_transactions"
where amount is null



  
  
      
    ) dbt_internal_test
[0m22:30:26.715375 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m22:30:26.715788 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m22:30:26.716269 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "medallion"."main"."stg_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m22:30:26.716772 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m22:30:26.717236 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m22:30:26.718630 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: ROLLBACK
[0m22:30:26.719234 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select status
from "medallion"."main"."stg_transactions"
where status is null



  
  
      
    ) dbt_internal_test
[0m22:30:26.719644 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:30:26.720818 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: ROLLBACK
[0m22:30:26.721237 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e'
[0m22:30:26.723737 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: ROLLBACK
[0m22:30:26.725449 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e'
[0m22:30:26.726388 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m22:30:26.727331 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: Close
[0m22:30:26.728133 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf'
[0m22:30:26.728596 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: Close
[0m22:30:26.730474 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: ROLLBACK
[0m22:30:26.730912 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: Close
[0m22:30:26.731509 [info ] [Thread-2 (]: 9 of 16 PASS not_null_fct_customer_transactions_transaction_count .............. [[32mPASS[0m in 0.07s]
[0m22:30:26.732117 [info ] [Thread-3 (]: 10 of 16 PASS not_null_stg_transactions_amount ................................. [[32mPASS[0m in 0.07s]
[0m22:30:26.732518 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875'
[0m22:30:26.733446 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m22:30:26.733045 [info ] [Thread-1 (]: 11 of 16 PASS not_null_stg_transactions_customer_id ............................ [[32mPASS[0m in 0.07s]
[0m22:30:26.733978 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m22:30:26.734378 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: Close
[0m22:30:26.734719 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m22:30:26.735348 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m22:30:26.735791 [debug] [Thread-3 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m22:30:26.736369 [info ] [Thread-4 (]: 12 of 16 PASS not_null_stg_transactions_status ................................. [[32mPASS[0m in 0.05s]
[0m22:30:26.736796 [info ] [Thread-2 (]: 13 of 16 START test not_null_stg_transactions_transaction_date ................. [RUN]
[0m22:30:26.737371 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m22:30:26.738394 [info ] [Thread-3 (]: 14 of 16 START test not_null_stg_transactions_transaction_id ................... [RUN]
[0m22:30:26.739361 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m22:30:26.739980 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e, now test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c)
[0m22:30:26.740847 [info ] [Thread-1 (]: 15 of 16 START test not_null_stg_transactions_transaction_ts ................... [RUN]
[0m22:30:26.742023 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e, now test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4)
[0m22:30:26.743361 [debug] [Thread-4 (]: Began running node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m22:30:26.744683 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m22:30:26.745921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf, now test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7)
[0m22:30:26.746471 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m22:30:26.747025 [info ] [Thread-4 (]: 16 of 16 START test unique_stg_transactions_transaction_id ..................... [RUN]
[0m22:30:26.756706 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m22:30:26.758225 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m22:30:26.764820 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m22:30:26.765414 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875, now test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396)
[0m22:30:26.768871 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m22:30:26.769351 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m22:30:26.769886 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m22:30:26.770347 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m22:30:26.775524 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m22:30:26.780723 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m22:30:26.781215 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m22:30:26.784696 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m22:30:26.788167 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m22:30:26.788853 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m22:30:26.789483 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m22:30:26.789898 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m22:30:26.790292 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: BEGIN
[0m22:30:26.791870 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m22:30:26.792264 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: BEGIN
[0m22:30:26.794315 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m22:30:26.794743 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:30:26.795199 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: BEGIN
[0m22:30:26.795691 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:30:26.796455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:30:26.796843 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m22:30:26.797353 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m22:30:26.797791 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m22:30:26.798167 [debug] [Thread-4 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: BEGIN
[0m22:30:26.798481 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:30:26.798855 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m22:30:26.799207 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m22:30:26.799513 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:30:26.799855 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m22:30:26.800222 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_date
from "medallion"."main"."stg_transactions"
where transaction_date is null



  
  
      
    ) dbt_internal_test
[0m22:30:26.800587 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from "medallion"."main"."stg_transactions"
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m22:30:26.801287 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_ts
from "medallion"."main"."stg_transactions"
where transaction_ts is null



  
  
      
    ) dbt_internal_test
[0m22:30:26.801753 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m22:30:26.802831 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m22:30:26.803402 [debug] [Thread-4 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "medallion"."main"."stg_transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:30:26.803778 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m22:30:26.804569 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m22:30:26.805229 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:30:26.805966 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m22:30:26.808752 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: ROLLBACK
[0m22:30:26.810221 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: ROLLBACK
[0m22:30:26.811362 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: ROLLBACK
[0m22:30:26.812465 [debug] [Thread-4 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: ROLLBACK
[0m22:30:26.812923 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4'
[0m22:30:26.813455 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c'
[0m22:30:26.813853 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7'
[0m22:30:26.814256 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396'
[0m22:30:26.814636 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: Close
[0m22:30:26.815071 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: Close
[0m22:30:26.815398 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: Close
[0m22:30:26.815801 [debug] [Thread-4 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: Close
[0m22:30:26.816500 [info ] [Thread-3 (]: 14 of 16 PASS not_null_stg_transactions_transaction_id ......................... [[32mPASS[0m in 0.07s]
[0m22:30:26.817548 [info ] [Thread-2 (]: 13 of 16 PASS not_null_stg_transactions_transaction_date ....................... [[32mPASS[0m in 0.08s]
[0m22:30:26.818359 [info ] [Thread-1 (]: 15 of 16 PASS not_null_stg_transactions_transaction_ts ......................... [[32mPASS[0m in 0.07s]
[0m22:30:26.819347 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m22:30:26.820254 [info ] [Thread-4 (]: 16 of 16 PASS unique_stg_transactions_transaction_id ........................... [[32mPASS[0m in 0.05s]
[0m22:30:26.821121 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m22:30:26.821757 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m22:30:26.822519 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m22:30:26.824770 [debug] [MainThread]: Using duckdb connection "master"
[0m22:30:26.825521 [debug] [MainThread]: On master: BEGIN
[0m22:30:26.825881 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:30:26.827170 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:30:26.827459 [debug] [MainThread]: On master: COMMIT
[0m22:30:26.827722 [debug] [MainThread]: Using duckdb connection "master"
[0m22:30:26.827962 [debug] [MainThread]: On master: COMMIT
[0m22:30:26.828405 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:30:26.828692 [debug] [MainThread]: On master: Close
[0m22:30:26.829050 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:30:26.829305 [debug] [MainThread]: Connection 'test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7' was properly closed.
[0m22:30:26.829530 [debug] [MainThread]: Connection 'test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c' was properly closed.
[0m22:30:26.829746 [debug] [MainThread]: Connection 'test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4' was properly closed.
[0m22:30:26.829989 [debug] [MainThread]: Connection 'test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396' was properly closed.
[0m22:30:26.830282 [info ] [MainThread]: 
[0m22:30:26.830576 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m22:30:26.832686 [debug] [MainThread]: Command end result
[0m22:30:26.861674 [debug] [MainThread]: Wrote artifact WritableManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m22:30:26.863248 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m22:30:26.873682 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/rantez/MIA/IngenieriaSoftware/Datos/00_examen/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m22:30:26.874840 [info ] [MainThread]: 
[0m22:30:26.875425 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:30:26.875816 [info ] [MainThread]: 
[0m22:30:26.876241 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=16
[0m22:30:26.877536 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.2177618, "process_in_blocks": "0", "process_kernel_time": 0.158149, "process_mem_max_rss": "153280", "process_out_blocks": "2536", "process_user_time": 2.326201}
[0m22:30:26.877938 [debug] [MainThread]: Command `dbt test` succeeded at 22:30:26.877840 after 1.22 seconds
[0m22:30:26.878346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cfa8f9d480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cfa8e970d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cf9e2702b0>]}
[0m22:30:26.878767 [debug] [MainThread]: Flushing usage events
[0m22:30:27.557219 [debug] [MainThread]: An error was encountered while trying to flush usage events
